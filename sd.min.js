/**
 * @license almond 0.3.1 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

// Copyright 2015 Bobby Powers. All rights reserved.
// Use of this source code is governed by the MIT
// license that can be found in the LICENSE file.

/*! Hammer.JS - v2.0.4 - 2014-09-28
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2014 Jorik Tangelder;
 * Licensed under the MIT license */

// Snap.svg 0.4.1
//
// Copyright (c) 2013 – 2015 Adobe Systems Incorporated. All rights reserved.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
//
// build: 2015-04-13

// Copyright (c) 2013 Adobe Systems Incorporated. All rights reserved.
// 
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
// 
// http://www.apache.org/licenses/LICENSE-2.0
// 
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
// ┌────────────────────────────────────────────────────────────┐ \\
// │ Eve 0.4.2 - JavaScript Events Library                      │ \\
// ├────────────────────────────────────────────────────────────┤ \\
// │ Author Dmitry Baranovskiy (http://dmitry.baranovskiy.com/) │ \\
// └────────────────────────────────────────────────────────────┘ \\

// Copyright (c) 2013 Adobe Systems Incorporated. All rights reserved.
// 
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
// 
// http://www.apache.org/licenses/LICENSE-2.0
// 
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// Copyright (c) 2013 - 2015 Adobe Systems Incorporated. All rights reserved.
// 
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
// 
// http://www.apache.org/licenses/LICENSE-2.0
// 
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// Copyright (c) 2013 Adobe Systems Incorporated. All rights reserved.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// Copyright (c) 2014 Adobe Systems Incorporated. All rights reserved.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// Copyright 2015 Bobby Powers. All rights reserved.
// Use of this source code is governed by the MIT
// license that can be found in the LICENSE file.
/// <reference path="../typings/tsd.d.ts" />

/*!
 *
 * Copyright 2009-2012 Kris Kowal under the terms of the MIT
 * license found at http://github.com/kriskowal/q/raw/master/LICENSE
 *
 * With parts by Tyler Close
 * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found
 * at http://www.opensource.org/licenses/mit-license.html
 * Forked at ref_send.js version: 2009-05-11
 *
 * With parts by Mark Miller
 * Copyright (C) 2011 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */

/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */

(function(e,t){typeof define=="function"&&define.amd?define(t):e.sd=t()})(typeof window!="undefined"?window:this,function(){var e,t,n;(function(r){function v(e,t){return h.call(e,t)}function m(e,t){var n,r,i,s,o,u,a,f,c,h,p,v=t&&t.split("/"),m=l.map,g=m&&m["*"]||{};if(e&&e.charAt(0)===".")if(t){e=e.split("/"),o=e.length-1,l.nodeIdCompat&&d.test(e[o])&&(e[o]=e[o].replace(d,"")),e=v.slice(0,v.length-1).concat(e);for(c=0;c<e.length;c+=1){p=e[c];if(p===".")e.splice(c,1),c-=1;else if(p===".."){if(c===1&&(e[2]===".."||e[0]===".."))break;c>0&&(e.splice(c-1,2),c-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((v||g)&&m){n=e.split("/");for(c=n.length;c>0;c-=1){r=n.slice(0,c).join("/");if(v)for(h=v.length;h>0;h-=1){i=m[v.slice(0,h).join("/")];if(i){i=i[r];if(i){s=i,u=c;break}}}if(s)break;!a&&g&&g[r]&&(a=g[r],f=c)}!s&&a&&(s=a,u=f),s&&(n.splice(0,u,s),e=n.join("/"))}return e}function g(e,t){return function(){var n=p.call(arguments,0);return typeof n[0]!="string"&&n.length===1&&n.push(null),s.apply(r,n.concat([e,t]))}}function y(e){return function(t){return m(t,e)}}function b(e){return function(t){a[e]=t}}function w(e){if(v(f,e)){var t=f[e];delete f[e],c[e]=!0,i.apply(r,t)}if(!v(a,e)&&!v(c,e))throw new Error("No "+e);return a[e]}function E(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function S(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=Object.prototype.hasOwnProperty,p=[].slice,d=/\.js$/;o=function(e,t){var n,r=E(e),i=r[0];return e=r[1],i&&(i=m(i,t),n=w(i)),i?n&&n.normalize?e=n.normalize(e,y(t)):e=m(e,t):(e=m(e,t),r=E(e),i=r[0],e=r[1],i&&(n=w(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return g(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:S(e)}}},i=function(e,t,n,i){var s,l,h,p,d,m=[],y=typeof n,E;i=i||e;if(y==="undefined"||y==="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(d=0;d<t.length;d+=1){p=o(t[d],i),l=p.f;if(l==="require")m[d]=u.require(e);else if(l==="exports")m[d]=u.exports(e),E=!0;else if(l==="module")s=m[d]=u.module(e);else if(v(a,l)||v(f,l)||v(c,l))m[d]=w(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,g(i,!0),b(l),{}),m[d]=a[l]}}h=n?n.apply(a[e],m):undefined;if(e)if(s&&s.exports!==r&&s.exports!==a[e])a[e]=s.exports;else if(h!==r||!E)a[e]=h}else e&&(a[e]=n)},e=t=s=function(e,t,n,a,f){if(typeof e=="string")return u[e]?u[e](t):w(o(e,t).f);if(!e.splice){l=e,l.deps&&s(l.deps,l.callback);if(!t)return;t.splice?(e=t,t=n,n=null):e=r}return t=t||function(){},typeof n=="function"&&(n=a,a=f),a?i(r,e,t,n):setTimeout(function(){i(r,e,t,n)},4),s},s.config=function(e){return s(e)},e._defined=a,n=function(e,t,n){if(typeof e!="string")throw new Error("See almond README: incorrect module build, no module name");t.splice||(n=t,t=[]),!v(a,e)&&!v(f,e)&&(f[e]=[e,t,n])},n.amd={jQuery:!0}})(),n("../bower_components/almond/almond",function(){}),n("common",["require","exports"],function(e,t){var n=function(){function e(){}return e.ERR_VERSION="bad xml or unknown smile version",e.ERR_BAD_TIME="bad time (control) data",e}();t.Errors=n,t.builtins={max:{},min:{},pulse:{usesTime:!0}},t.reserved={"if":!0,then:!0,"else":!0}}),n("xmile",["require","exports"],function(e,t){function n(e){"use strict";var t=0;while((t=e.indexOf("_"))>=0&&t<e.length-1)e=e.slice(0,t)+e.slice(t+1,t+2).toUpperCase()+e.slice(t+2);return e}function r(e){"use strict";return e.split(",").map(function(e){return e.trim()})}function i(e){"use strict";return e.map(function(e){return parseFloat(e)})}function s(e){"use strict";return e|0}function u(e,t){"use strict";for(var n=0;n<e.attributes.length;n++){var r=e.attributes.item(n);if(r.name.toLowerCase()===t)return r.value}return null}function a(e){"use strict";return e=e.trim(),/^\s*$/.test(e)?null:/^(?:true|false)$/i.test(e)?e.toLowerCase()==="true":isFinite(e)?parseFloat(e):e}function f(e){"use strict";var t="";if(e.hasChildNodes())for(var n=0;n<e.childNodes.length;n++){var r=e.childNodes.item(n);switch(r.nodeType){case 3:t+=r.nodeValue.trim();break;case 4:t+=r.nodeValue}}return t}function l(e){"use strict";if(typeof e=="undefined"||e===null)return[0,null];if(typeof e=="number")return[e,null];var t=parseFloat(e);return isFinite(t)?[t,null]:[NaN,new o("not number: "+e)]}function c(e){"use strict";if(typeof e=="undefined"||e===null)return[!1,null];if(typeof e=="boolean")return[e,null];if(typeof e=="string"){if(e==="true")return[!0,null];if(e==="false")return[!1,null]}return[!1,new o("not boolean: "+e)]}function B(e){"use strict";var t=!1;if(e.length>1){var n=e.slice(0,1),r=e.slice(e.length-1);t=n==='"'&&r==='"'}return e=e.toLowerCase(),e=e.replace(/\\n/g,"_"),e=e.replace(/\\\\/g,"\\"),e=e.replace(/\\"/g,"\\"),e=e.replace(/[_\r\n\t \xa0]+/g,"_"),t?e.slice(1,-1):e}t.camelCase=n,t.splitOnComma=r,t.numberize=i,t.i32=s;var o=function(){function e(e){this.error=e}return e}();t.Error=o;var h=function(){function e(){}return e.Build=function(t){var n=new e,r;for(var i=0;i<t.attributes.length;i++){var s=t.attributes.item(i);switch(s.name.toLowerCase()){case"x":u=l(s.value),n.x=u[0],r=u[1];if(r)return[null,new o("x not num: "+r.error)];break;case"y":a=l(s.value),n.y=a[0],r=a[1];if(r)return[null,new o("y not num: "+r.error)]}}return[n,r];var u,a},e.prototype.toXml=function(e,t){return!0},e}();t.Point=h;var p=function(){function e(e){}return e.prototype.toXml=function(e,t){return!0},e}();t.Size=p;var d=function(){function e(e){}return e.prototype.toXml=function(e,t){return!0},e}();t.Rect=d;var v=function(){function e(){this.namespace="https://docs.oasis-open.org/xmile/ns/XMILE/v1.0",this.dimensions=[],this.units=[],this.models=[]}return e.Build=function(t){var n=new e,r=null;for(var i=0;i<t.attributes.length;i++){var s=t.attributes.item(i);switch(s.name.toLowerCase()){case"version":n.version=s.value;break;case"xmlns":n.namespace=s.value}}for(var i=0;i<t.childNodes.length;i++){var u=void 0,a=t.childNodes.item(i);if(a.nodeType!==1)continue;switch(a.nodeName.toLowerCase()){case"header":f=b.Build(a),n.header=f[0],r=f[1];if(r)return[null,new o("Header: "+r.error)];break;case"sim_specs":l=m.Build(a),n.simSpec=l[0],r=l[1];if(r)return[null,new o("SimSpec: "+r.error)];break;case"model":c=N.Build(a),u=c[0],r=c[1];if(r)return[null,new o("SimSpec: "+r.error)];n.models.push(u)}}return[n,r];var f,l,c},e.prototype.toXml=function(e,t){return!0},e}();t.File=v;var m=function(){function e(){this.start=0,this.stop=1,this.dt=1,this.saveStep=0,this.method="euler",this.timeUnits=""}return e.Build=function(t){var r=new e,i;for(var s=0;s<t.childNodes.length;s++){var a=t.childNodes.item(s);if(a.nodeType!==1)continue;var c=n(a.nodeName.toLowerCase());c==="savestep"&&(c="saveStep");if(!r.hasOwnProperty(c))continue;if(c==="method"||c==="timeUnits")r[c]=f(a).toLowerCase();else{h=l(f(a)),r[c]=h[0],i=h[1];if(i)return[null,new o(a.nodeName+": "+i.error)];c==="dt"&&u(a,"reciprocal")==="true"&&(r.dtReciprocal=r.dt,r.dt=1/r.dt)}}r.saveStep||(r.saveStep=r.dt);switch(r.method){case"euler":break;case"rk4":case"rk2":case"rk45":case"gear":console.log("valid but unsupported integration method: "+r.method+". using euler"),r.method="euler";break;default:return[null,new o("unknown integration method "+r.method)]}return[r,null];var h},e.prototype.toXml=function(e,t){return!0},e}();t.SimSpec=m;var g=function(){function e(e){}return e.prototype.toXml=function(e,t){return!0},e}();t.Unit=g;var y=function(){function e(){this.name="unknown",this.lang="English",this.version=""}return e.Build=function(t){var n=new e;n.name=f(t);for(var r=0;r<t.attributes.length;r++){var i=t.attributes.item(r);switch(i.name.toLowerCase()){case"version":n.version=i.value;break;case"lang":n.lang=i.value}}return[n,null]},e.prototype.toXml=function(e,t){return!0},e}();t.Product=y;var b=function(){function e(){}return e.Build=function(t){var n=new e,r;for(var i=0;i<t.childNodes.length;i++){var s=t.childNodes.item(i);if(s.nodeType!==1)continue;switch(s.nodeName.toLowerCase()){case"vendor":n.vendor=f(s);break;case"product":u=y.Build(s),n.product=u[0],r=u[1];if(r)return[null,new o("Product: "+r.error)];break;case"options":a=E.Build(s),n.options=a[0],r=a[1];if(r)return[null,new o("Options: "+r.error)];break;case"name":n.name=f(s);break;case"version":n.version=f(s);break;case"caption":n.caption=f(s);break;case"author":n.author=f(s);break;case"affiliation":n.affiliation=f(s);break;case"client":n.client=f(s);break;case"copyright":n.copyright=f(s);break;case"created":n.created=f(s);break;case"modified":n.modified=f(s);break;case"uuid":n.uuid=f(s)}}return[n,r];var u,a},e.prototype.toXml=function(e,t){return!0},e}();t.Header=b;var w=function(){function e(){this.name="",this.size=""}return e.Build=function(t){var n=new e;return[n,null]},e.prototype.toXml=function(e,t){return!0},e}();t.Dimension=w;var E=function(){function e(){this.namespaces=[],this.usesArrays=!1,this.usesMacros=!1,this.usesConveyor=!1,this.usesQueue=!1,this.usesSubmodels=!1,this.usesEventPosters=!1,this.hasModelView=!1,this.usesOutputs=!1,this.usesInputs=!1,this.usesAnnotation=!1,this.maximumDimensions=1,this.invalidIndexValue=0,this.recursiveMacros=!1,this.optionFilters=!1,this.arrest=!1,this.leak=!1,this.overflow=!1,this.messages=!1,this.numericDisplay=!1,this.lamp=!1,this.gauge=!1,this.numericInput=!1,this.list=!1,this.graphicalInput=!1}return e.Build=function(t){var i=new e,o;for(var a=0;a<t.attributes.length;a++){var f=t.attributes.item(a);switch(f.name.toLowerCase()){case"namespace":i.namespaces=r(f.value)}}for(var a=0;a<t.childNodes.length;a++){var c=t.childNodes.item(a);if(c.nodeType!==1)continue;var h=c.nodeName.toLowerCase(),p=void 0;h.slice(0,5)==="uses_"?p=4:h.substring(0,4)!=="has_"&&(p=3);if(!p)continue;h=n(h);if(!i.hasOwnProperty(h))continue;i[h]=!0;if(h==="usesArrays"){var d=void 0;d=u(c,"maximum_dimensions");if(d){var v=void 0;m=l(d),v=m[0],o=m[1],o&&(console.log("bad max_dimensions( "+d+"): "+o.error),v=1),v!==s(v)&&console.log("non-int max_dimensions: "+d),i.maximumDimensions=s(v)}d=u(c,"invalid_index_value"),d==="NaN"&&(i.invalidIndexValue=NaN)}}return[i,o];var m},e.prototype.toXml=function(e,t){return!0},e}();t.Options=E;var S=function(){function e(){this.allNonNegative=!1,this.stockNonNegative=!1,this.flowNonNegative=!1}return e.Build=function(t){var n=new e;return[n,null]},e.prototype.toXml=function(e,t){return!0},e}();t.Behavior=S;var x=function(){function e(e){}return e.prototype.toXml=function(e,t){return!0},e}();t.Style=x;var T=function(){function e(e){}return e.prototype.toXml=function(e,t){return!0},e}();t.Data=T;var N=function(){function e(){this.name="",this.run=!1,this.variables=[],this.views=[]}return e.Build=function(t){var n=new e,r;for(var i=0;i<t.attributes.length;i++){var s=t.attributes.item(i);switch(s.name.toLowerCase()){case"name":n.name=s.value}}for(var i=0;i<t.childNodes.length;i++){var u=t.childNodes.item(i);if(u.nodeType!==1)continue;switch(u.nodeName.toLowerCase()){case"variables":for(var a=0;a<u.childNodes.length;a++){var f=u.childNodes.item(a);if(f.nodeType!==1)continue;var l=void 0;h=A.Build(f),l=h[0],r=h[1];if(r)return[null,new o(u.nodeName+" var: "+r.error)];n.variables.push(l)}break;case"views":for(var a=0;a<u.childNodes.length;a++){var f=u.childNodes.item(a);if(f.nodeType!==1)continue;if(f.nodeName.toLowerCase()!=="view")continue;var c=void 0;p=_.Build(f),c=p[0],r=p[1];if(r)return[null,new o("view: "+r.error)];n.views.push(c)}}}return[n,null];var h,p},Object.defineProperty(e.prototype,"ident",{get:function(){return B(this.name)},enumerable:!0,configurable:!0}),e.prototype.toXml=function(e,t){return!0},e}();t.Model=N;var C=function(){function e(){this.subscript=[]}return e.Build=function(t){var n=new e;return console.log("TODO: array element"),[n,null]},e.prototype.toXml=function(e,t){return!0},e}();t.ArrayElement=C;var k=function(){function e(){}return e.Build=function(t){var n=new e;return console.log("TODO: range element"),[n,null]},e.prototype.toXml=function(e,t){return!0},e}();t.Range=k;var L=function(){function e(){this.precision="",this.scaleBy="1",this.displayAs="number",this.delimit000s=!1}return e.Build=function(t){var n=new e;return console.log("TODO: format element"),[n,null]},e.prototype.toXml=function(e,t){return!0},e}();t.Format=L;var A=function(){function e(){this.type="",this.name="",this.eqn="",this.connections=[],this.inflows=[],this.outflows=[]}return e.Build=function(t){var n=new e,r;n.type=t.nodeName.toLowerCase();for(var i=0;i<t.attributes.length;i++){var s=t.attributes.item(i);switch(s.name.toLowerCase()){case"name":n.name=s.value;break;case"resource":n.resource=s.value}}for(var i=0;i<t.childNodes.length;i++){var u=t.childNodes.item(i);if(u.nodeType!==1)continue;switch(u.nodeName.toLowerCase()){case"eqn":n.eqn=f(u);break;case"inflow":n.inflows.push(B(f(u)));break;case"outflow":n.outflows.push(B(f(u)));break;case"gf":l=D.Build(u),n.gf=l[0],r=l[1];if(r)return[null,new o(n.name+" GF: "+r.error)];break;case"connect":var a=void 0;c=H.Build(u),a=c[0],r=c[1];if(r)return[null,new o(n.name+" conn: "+r.error)];n.connections.push(a)}}return[n,r];var l,c},Object.defineProperty(e.prototype,"ident",{get:function(){return B(this.name)},enumerable:!0,configurable:!0}),e.prototype.toXml=function(e,t){return!0},e}();t.Variable=A;var O=function(){function e(){}return e.Build=function(t){var n=new e,r;for(var i=0;i<t.attributes.length;i++){var s=t.attributes.item(i);switch(s.name.toLowerCase()){case"type":n.type=s.value.toLowerCase();if(!(n.type in e.Types))return[null,new o("bad type: "+n.type)];break;case"width":u=l(s.value),n.width=u[0],r=u[1];if(r)return[null,new o("bad width: "+r.error)];break;case"height":a=l(s.value),n.height=a[0],r=a[1];if(r)return[null,new o("bad height: "+r.error)];break;case"radius":f=l(s.value),n.radius=f[0],r=f[1];if(r)return[null,new o("bad radius: "+r.error)]}}return[n,r];var u,a,f},e.prototype.toXml=function(e,t){return!0},e.Types=["rectangle","circle","name_only"],e}();t.Shape=O;var M=function(){function e(){}return e.Build=function(t){var n=new e,r;n.type=t.nodeName.toLowerCase();for(var i=0;i<t.attributes.length;i++){var s=t.attributes.item(i);switch(s.name.toLowerCase()){case"name":n.name=s.value;break;case"x":d=l(s.value),n.x=d[0],r=d[1];if(r)return[null,new o("x: "+r.error)];break;case"y":v=l(s.value),n.y=v[0],r=v[1];if(r)return[null,new o("y: "+r.error)];break;case"width":m=l(s.value),n.width=m[0],r=m[1];if(r)return[null,new o("width: "+r.error)];break;case"height":g=l(s.value),n.height=g[0],r=g[1];if(r)return[null,new o("height: "+r.error)];break;case"label_side":n.labelSide=s.value.toLowerCase();break;case"label_angle":y=l(s.value),n.labelAngle=y[0],r=y[1];if(r)return[null,new o("label_angle: "+r.error)];break;case"color":n.color=s.value.toLowerCase();break;case"angle":b=l(s.value),n.angle=b[0],r=b[1];if(r)return[null,new o("angle: "+r.error)]}}for(var i=0;i<t.childNodes.length;i++){var u=t.childNodes.item(i);if(u.nodeType!==1)continue;switch(u.nodeName.toLowerCase()){case"to":n.to=B(f(u));break;case"from":n.from=B(f(u));break;case"of":n.of=B(f(u));break;case"pts":for(var a=0;a<u.childNodes.length;a++){var c=u.childNodes.item(a);if(c.nodeType!==1)continue;if(c.nodeName.toLowerCase()!=="pt")continue;var p=void 0;w=h.Build(c),p=w[0],r=w[1];if(r)return[null,new o("pt: "+r.error)];typeof n.pts=="undefined"&&(n.pts=[]),n.pts.push(p)}break;case"shape":E=O.Build(u),n.shape=E[0],r=E[1];if(r)return[null,new o("shape: "+r.error)]}}return[n,r];var d,v,m,g,y,b,w,E},Object.defineProperty(e.prototype,"ident",{get:function(){return B(this.name)},enumerable:!0,configurable:!0}),e.prototype.toXml=function(e,t){return!0},e}();t.ViewElement=M;var _=function(){function e(){this.type="stock_flow",this.zoom=100,this.scrollX=0,this.scrollY=0,this.homePage=0,this.homeView=!1,this.elements=[]}return e.Build=function(t){var n=new e,r;for(var i=0;i<t.attributes.length;i++){var s=t.attributes.item(i);switch(s.name.toLowerCase()){case"type":n.type=s.value.toLowerCase();break;case"order":f=l(s.value),n.order=f[0],r=f[1];if(r)return[null,new o("order: "+r.error)];break;case"width":h=l(s.value),n.width=h[0],r=h[1];if(r)return[null,new o("width: "+r.error)];break;case"height":p=l(s.value),n.height=p[0],r=p[1];if(r)return[null,new o("height: "+r.error)];break;case"zoom":d=l(s.value),n.zoom=d[0],r=d[1];if(r)return[null,new o("zoom: "+r.error)];break;case"scroll_x":v=l(s.value),n.scrollX=v[0],r=v[1];if(r)return[null,new o("scroll_x: "+r.error)];break;case"scroll_y":m=l(s.value),n.scrollY=m[0],r=m[1];if(r)return[null,new o("scroll_y: "+r.error)];break;case"background":n.background=s.value.toLowerCase();break;case"page_width":g=l(s.value),n.pageWidth=g[0],r=g[1];if(r)return[null,new o("page_width: "+r.error)];break;case"page_height":y=l(s.value),n.pageHeight=y[0],r=y[1];if(r)return[null,new o("page_height: "+r.error)];break;case"page_sequence":n.pageSequence=s.value.toLowerCase();break;case"page_orientation":n.pageOrientation=s.value.toLowerCase();break;case"show_pages":b=c(s.value),n.showPages=b[0],r=b[1];if(r)return[null,new o("show_pages: "+r.error)];break;case"home_page":w=l(s.value),n.homePage=w[0],r=w[1];if(r)return[null,new o("home_page: "+r.error)];break;case"home_view":E=c(s.value),n.homeView=E[0],r=E[1];if(r)return[null,new o("home_view: "+r.error)]}}for(var i=0;i<t.childNodes.length;i++){var u=t.childNodes.item(i);if(u.nodeType!==1)continue;var a=void 0;S=M.Build(u),a=S[0],r=S[1];if(r)return[null,new o("viewEl: "+r.error)];n.elements.push(a)}return[n,r];var f,h,p,d,v,m,g,y,b,w,E,S},e.prototype.toXml=function(e,t){return!0},e}();t.View=_;var D=function(){function e(){this.type="continuous"}return e.Build=function(t){var n=new e,s;for(var u=0;u<t.attributes.length;u++){var a=t.attributes.item(u);switch(a.name.toLowerCase()){case"type":n.type=a.value.toLowerCase();if(!(n.type in e.Types))return[null,new o("bad type: "+n.type)]}}for(var u=0;u<t.childNodes.length;u++){var l=t.childNodes.item(u);if(l.nodeType!==1)continue;switch(l.nodeName.toLowerCase()){case"xscale":c=P.Build(l),n.xScale=c[0],s=c[1];if(s)return[null,new o("xscale: "+s.error)];break;case"yscale":h=P.Build(l),n.yScale=h[0],s=h[1];if(s)return[null,new o("yscale: "+s.error)];break;case"xpts":n.xPoints=i(r(f(l)));break;case"ypts":n.yPoints=i(r(f(l)))}}if(!n.yPoints)return[null,new o("table missing ypts")];n.type!=="continuous"&&console.log("WARN: unimplemented table type: "+n.type);return[n,s];var c,h},e.prototype.toXml=function(e,t){return!0},e.Types=["continuous","extrapolate","discrete"],e}();t.GF=D;var P=function(){function e(){}return e.Build=function(t){var n=new e,r;for(var i=0;i<t.attributes.length;i++){var s=t.attributes.item(i);switch(s.name.toLowerCase()){case"min":u=l(s.value),n.min=u[0],r=u[1];if(r)return[null,new o("bad min: "+s.value)];break;case"max":a=l(s.value),n.max=a[0],r=a[1];if(r)return[null,new o("bad max: "+s.value)]}}if(!n.hasOwnProperty("min")||!n.hasOwnProperty("max"))return[null,new o("scale requires both min and max")];return[n,null];var u,a},e.prototype.toXml=function(e,t){return!0},e}();t.Scale=P;var H=function(){function e(){}return e.Build=function(t){var n=new e,r;for(var i=0;i<t.attributes.length;i++){var s=t.attributes.item(i);switch(s.name.toLowerCase()){case"to":n.to=B(s.value);break;case"from":n.from=B(s.value)}}return!n.hasOwnProperty("to")||!n.hasOwnProperty("from")?[null,new o("connect requires both to and from")]:[n,null]},e.prototype.toXml=function(e,t){return!0},e}();t.Connection=H,t.canonicalize=B}),n("util",["require","exports"],function(e,t){function n(e){"use strict";return e.replace(/(?:^|\s)\w/g,function(e){return e.toUpperCase()})}function r(e){"use strict";return e.replace(/\\n/g,"\n").replace(/_/g," ")}function i(){"use strict";var e=[];for(var t=0;t<arguments.length;t++)e[t-0]=arguments[t];var n={};for(var r=0;r<e.length;++r)n[e[r]]=!0;return n}function s(e,t,n){"use strict";var r=e[t];e[t]=e[n],e[n]=r}function o(e,t,n,r){"use strict";var i=e[r];s(e,r,n);var o=t;for(var u=t;u<n;++u)e[u].lessThan(i)&&(s(e,u,o),o+=1);return s(e,o,n),o}function u(e,t,n,r){"use strict";t===void 0&&(t=0),n===void 0&&(n=e.length-1),r===void 0&&(r=o);if(t>=n)return;var i=Math.floor(t+(n-t)/2),s=r(e,t,n,i);u(e,t,s-1,r),u(e,s+1,n,r)}function a(e,t){"use strict";var n=e.x.length;if(n===0)return NaN;var r=e.x,i=e.y;if(t<=r[0])return i[0];if(t>=r[n-1])return i[n-1];var s=0,o=n,u;while(s<o)u=Math.floor(s+(o-s)/2),r[u]<t?s=u+1:o=u;var a=s;if(r[a]===t)return i[a];var f=(i[a]-i[a-1])/(r[a]-r[a-1]);return(t-r[a-1])*f+i[a-1]}function f(e,t){"use strict";return e<t?e:t}function l(e){"use strict";var t=[];for(var n=0;n<e.length;n++)t.push(parseFloat(e[n]));return t}function c(e,t){"use strict";return parseFloat(e.getAttribute(t))}function h(e,t){"use strict";if(e.querySelector)return e.querySelector(t);var n=t.split(">"),r=e,i;e:for(var s=0;r&&s<n.length;s++){for(var o=0;o<r.childNodes.length;o++){i=r.childNodes[o];if(!i.tagName)continue;if(i.tagName.toLowerCase()===n[s].toLowerCase()){r=i;continue e}}r=null}return r}function p(e,t){"use strict";var n=t[0],r=t.slice(1),i=[],s;for(var o in e.childNodes){if(!e.hasOwnProperty(o))continue;s=e.childNodes[o],s.tagName&&s.tagName.toLowerCase()===n&&(r.length?i=i.concat(p(s,r)):i.push(s))}return i}function d(e,t){"use strict";if(e.querySelectorAll)return e.querySelectorAll(t);var n=t.split(">").map(function(e){return e.toLowerCase()});return p(e,n)}function v(e){"use strict";return e!==e}t.titleCase=n,t.dName=r,t.set=i,t.partition=o,t.sort=u,t.lookup=a,t.min=f,t.numArr=l,t.floatAttr=c,t.qs=h,t.querySelectorInner=p,t.qsa=d,t.isNaN=v}),n("lex",["require","exports","./common","./util"],function(e,t,n,r){function s(e){"use strict";return/\s/.test(e)}function o(e){"use strict";return/[\d\.]/.test(e)}function u(e){"use strict";return/[=><\[\]\(\)\^\+\-\*\/,]/.test(e)}function a(e){"use strict";return!o(e)&&!s(e)&&(/[_\"]/.test(e)||!u(e))}function h(e){"use strict";var t=new c(e),r={},i=0,s;while(s=t.nextTok())s.type===1&&!(s.tok in n.builtins)&&(r[s.tok]=!0);return r}var i={not:"!",and:"&",or:"|",mod:"%"};t.RESERVED=r.set("if","then","else");var f=function(){function e(e,t){this.line=e,this.pos=t}return e.prototype.off=function(t){return new e(this.line,this.pos+t)},e}();t.SourceLoc=f;var l=function(){function e(e,t,n,r){this.tok=e,this.type=t,this.startLoc=n,this.endLoc=r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.type!==3?undefined:parseFloat(this.tok)},enumerable:!0,configurable:!0}),e}();t.Token=l;var c=function(){function e(e){this.text=e.toLowerCase(),this.orig=e,this.len=e.length,this.pos=0,this.line=0,this.lstart=0,this.rpeek=this.text[0],this.tpeek=null}return e.prototype.peek=function(){return this.tpeek||(this.tpeek=this.nextTok()),this.tpeek},e.prototype.nextTok=function(){if(this.tpeek){var e=this.tpeek;return this.tpeek=null,e}this.skipWhitespace();var t=this.rpeek;if(t===null||t===undefined)return null;var n=this.pos-this.lstart,r=new f(this.line,n);if(o(t))return this.lexNumber(r);if(a(t))return this.lexIdentifier(r);var i=this.pos,s=1;switch(t){case"=":this.nextRune(),this.rpeek==="="&&(this.nextRune(),s++);break;case"<":this.nextRune();if(this.rpeek==="="||this.rpeek===">")this.nextRune(),s++;break;case">":this.nextRune(),this.rpeek==="="&&(this.nextRune(),s++);break;default:this.nextRune()}var u=this.text.substring(i,i+s);switch(u){case">=":u="≥";break;case"<=":u="≤";break;case"<>":u="≠";break;default:}return new l(u,0,r,r.off(s))},e.prototype.nextRune=function(){return this.pos<this.len-1?this.rpeek=this.text[this.pos+1]:this.rpeek=null,this.pos++,this.rpeek},e.prototype.skipWhitespace=function(){var e=!1;do{this.rpeek==="\n"&&(this.line++,this.lstart=this.pos+1);if(e){this.rpeek==="}"&&(e=!1);continue}if(this.rpeek==="{"){e=!0;continue}if(!s(this.rpeek))break}while(this.nextRune()!==null)},e.prototype.fastForward=function(e){this.pos+=e,this.pos<this.len?this.rpeek=this.text[this.pos]:this.rpeek=null},e.prototype.lexIdentifier=function(e){var n=this.rpeek==='"',r=this.line,o=this.pos;n&&this.nextRune();var u;while(u=this.nextRune()){if(a(u)&&u!=='"'||/\d/.test(u))continue;if(n){if(u==='"'){this.nextRune();break}if(s(u))continue}break}var f=this.pos-o,c=this.text.substring(o,o+f),h=1;return c in t.RESERVED?h=2:c in i&&(h=0,c=i[c]),new l(c,h,e,e.off(f))},e.prototype.lexNumber=function(e){var t=/\d*(\.\d*)?(e(\d?(\.\d*)?)?)?/.exec(this.text.substring(this.pos))[0],n=t.length;return this.fastForward(n),new l(t,3,e,new f(e.line,e.pos+n))},e}();t.Lexer=c,t.identifierSet=h}),n("ast",["require","exports","./xmile"],function(e,t,n){var r=function(){function e(e,t){this.ident=n.canonicalize(t),this.pos=e,this.len=t.length}return Object.defineProperty(e.prototype,"end",{get:function(){return this.pos.off(this.len)},enumerable:!0,configurable:!0}),e.prototype.walk=function(e){return e.ident(this)},e}();t.Ident=r;var i=function(){function e(e,t){this.value=parseFloat(t),this._pos=e,this._len=t.length}return Object.defineProperty(e.prototype,"pos",{get:function(){return this._pos},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._pos.off(this._len)},enumerable:!0,configurable:!0}),e.prototype.walk=function(e){return e.constant(this)},e}();t.Constant=i;var s=function(){function e(e,t,n){this.x=t,this._lPos=e,this._rPos=n}return Object.defineProperty(e.prototype,"pos",{get:function(){return this._lPos},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._rPos.off(1)},enumerable:!0,configurable:!0}),e.prototype.walk=function(e){return e.paren(this)},e}();t.ParenExpr=s;var o=function(){function e(e,t,n,r){this.fun=e,this.args=n,this._lParenPos=t,this._rParenPos=r}return Object.defineProperty(e.prototype,"pos",{get:function(){return this.fun.pos},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._rParenPos.off(1)},enumerable:!0,configurable:!0}),e.prototype.walk=function(e){return e.call(this)},e}();t.CallExpr=o;var u=function(){function e(e,t,n){this.op=t,this.x=n,this._opPos=e}return Object.defineProperty(e.prototype,"pos",{get:function(){return this._opPos},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this.x.end},enumerable:!0,configurable:!0}),e.prototype.walk=function(e){return e.unary(this)},e}();t.UnaryExpr=u;var a=function(){function e(e,t,n,r){this.l=e,this.op=n,this.r=r,this._opPos=t}return Object.defineProperty(e.prototype,"pos",{get:function(){return this.l.pos},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this.r.end},enumerable:!0,configurable:!0}),e.prototype.walk=function(e){return e.binary(this)},e}();t.BinaryExpr=a;var f=function(){function e(e,t,n,r,i,s){this.cond=t,this.t=r,this.f=s,this._ifPos=e,this._thenPos=n,this._elsePos=i}return Object.defineProperty(e.prototype,"pos",{get:function(){return this._ifPos},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this.f.end},enumerable:!0,configurable:!0}),e.prototype.walk=function(e){return e.if(this)},e}();t.IfExpr=f}),n("parse",["require","exports","./ast","./lex"],function(e,t,n,r){function a(e){"use strict";var t=new l(e),n=t.expr();return t.errs&&t.errs.length?[null,t.errs]:[n,null]}function f(e,t,r){"use strict";return function(){var i=t.lexer.peek();if(!i)return null;var s=t.levels[e+1],o=s();if(!o)return null;for(var u=t.consumeAnyOf(r);u;u=t.consumeAnyOf(r)){var a=s();if(!a)return t.errs.push('expected rhs of expr after "'+u.tok+'"'),null;o=new n.BinaryExpr(o,u.startLoc,u.tok,a)}return o}}var i=["if","then","else"],s={not:"!",and:"&",or:"|",mod:"%"},o="+-!",u=["^","!","*/%","+-","><≥≤","=≠","&","|"];t.eqn=a;var l=function(){function e(e){this.errs=[],this.levels=[],this.lexer=new r.Lexer(e);for(var t=0;t<u.length;t++)this.levels.push(f(t,this,u[t]));this.levels.push(this.factor.bind(this))}return Object.defineProperty(e.prototype,"errors",{get:function(){return this.errs},enumerable:!0,configurable:!0}),e.prototype.expr=function(){return this.levels[0]()},e.prototype.factor=function(){var e,t;if(t=this.consumeTok("(")){e=this.expr();if(!e)return this.errs.push("expected an expression after an opening paren"),null;var r;return(r=this.consumeTok(")"))?new n.ParenExpr(t,e,r):(this.errs.push('expected ")", not end-of-equation'),null)}var i;if(i=this.consumeAnyOf(o))return e=this.expr(),e?new n.UnaryExpr(i.startLoc,i.tok,e):(this.errs.push('unary operator "'+i.tok+'" without operand.'),null);if(e=this.num())return e;var s;if(s=this.consumeReserved("if")){var u=this.expr();if(!u)return this.errs.push('expected an expr to follow "IF"'),null;var a;if(!(a=this.consumeReserved("then")))return this.errs.push('expected "THEN"'),null;var f=this.expr();if(!f)return this.errs.push('expected an expr to follow "THEN"'),null;var l;if(!(l=this.consumeReserved("else")))return this.errs.push('expected "ELSE"'),null;var c=this.expr();return c?new n.IfExpr(s,u,a,f,l,c):(this.errs.push('expected an expr to follow "ELSE"'),null)}if(e=this.ident()){var h;return(h=this.consumeTok("("))?this.call(e,h):e}return null},e.prototype.consumeAnyOf=function(e){var t=this.lexer.peek();if(!t||t.type!==0)return null;for(var n=0;n<e.length;n++)if(t.tok===e[n])return this.lexer.nextTok();return null},e.prototype.consumeTok=function(e){var t=this.lexer.peek();return!t||t.type!==0||t.tok!==e?null:(this.lexer.nextTok(),t.startLoc)},e.prototype.consumeReserved=function(e){var t=this.lexer.peek();return!t||t.type!==2||t.tok!==e?null:(this.lexer.nextTok(),t.startLoc)},e.prototype.num=function(){var e=this.lexer.peek();return!e||e.type!==3?null:(this.lexer.nextTok(),new n.Constant(e.startLoc,e.tok))},e.prototype.ident=function(){var e=this.lexer.peek();return!e||e.type!==1?null:(this.lexer.nextTok(),new n.Ident(e.startLoc,e.tok))},e.prototype.call=function(e,t){var r=[],i;if(i=this.consumeTok(")"))return new n.CallExpr(e,t,r,i);for(;;){var s=this.expr();if(!s)return this.errs.push("expected expression as arg in function call"),null;r.push(s);if(this.consumeTok(","))continue;if(i=this.consumeTok(")"))break;return this.errs.push('call: expected "," or ")"'),null}return new n.CallExpr(e,t,r,i)},e}()});var r=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};return n("vars",["require","exports","./common","./lex","./parse"],function(e,t,n,i,s){var o={"&":"&&","|":"||","≥":">=","≤":"<=","≠":"!==","=":"==="},u=function(){function e(e,t){this.code="",this.offsets=e,this.isMain=t,this.scope=t?"curr":"globalCurr"}return e.prototype.ident=function(e){return e.ident==="time"?this.refTime():e.ident in this.offsets?this.refDirect(e.ident):this.refIndirect(e.ident),!0},e.prototype.constant=function(e){return this.code+=""+e.value,!0},e.prototype.call=function(e){if(!e.fun.hasOwnProperty("ident"))return console.log("// for now, only idents can be used as fns."),console.log(e),!1;var t=e.fun.ident;if(t in n.builtins){this.code+=t,this.code+="(",n.builtins[t].usesTime&&(this.code+="dt, ",this.refTime(),e.args.length&&(this.code+=", "));for(var r=0;r<e.args.length;r++)e.args[r].walk(this),r!==e.args.length-1&&(this.code+=", ");return this.code+=")",!0}return console.log("// unknown builtin: "+t),!1},e.prototype.if=function(e){return this.code+="(",e.cond.walk(this),this.code+=" ? ",e.t.walk(this),this.code+=" : ",e.f.walk(this),this.code+=")",!0},e.prototype.paren=function(e){return this.code+="(",e.x.walk(this),this.code+=")",!0},e.prototype.unary=function(e){var t=e.op==="!"?"+!":e.op;return this.code+=t,e.x.walk(this),!0},e.prototype.binary=function(e){if(e.op==="^")return this.code+="Math.pow(",e.l.walk(this),this.code+=",",e.r.walk(this),this.code+=")",!0;var t=e.op;return e.op in o&&(t=o[e.op]),this.code+="(",e.l.walk(this),this.code+=t,e.r.walk(this),this.code+=")",!0},e.prototype.refTime=function(){this.code+=this.scope,this.code+="[0]"},e.prototype.refDirect=function(e){this.code+="curr[",this.code+=this.offsets[e],this.code+="]"},e.prototype.refIndirect=function(e){this.code+="globalCurr[this.ref['",this.code+=e,this.code+="']]"},e}();t.CodegenVisitor=u;var a=function(){function e(e,t){if(!arguments.length)return;this.model=e,this.xmile=t,this.ident=t.ident,this.eqn=t.eqn;var n;r=s.eqn(this.eqn),this.ast=r[0],n=r[1],n?(console.log("// parse failed for "+this.ident+": "+n[0]),this.valid=!1):this.valid=!0,this._deps=i.identifierSet(this.eqn);var r}return e.prototype.initialEquation=function(){return this.eqn},e.prototype.code=function(e){if(this.isConst())return"this.initials['"+this.ident+"']";var t=new u(e,this.model.ident==="main"),n=this.ast.walk(t);return n?t.code:(console.log("// codegen failed for "+this.ident),"")},e.prototype.getDeps=function(){if(this._allDeps)return this._allDeps;var e={};for(var t in this._deps){if(t in e)continue;e[t]=!0;var n=this.model.vars[t];if(!n)continue;var r=n.getDeps();for(var i in r)r.hasOwnProperty(i)&&(e[i]=!0)}return this._allDeps=e,e},e.prototype.lessThan=function(e){return this.ident in e.getDeps()},e.prototype.isConst=function(){return isFinite(this.eqn)},e}();t.Variable=a;var f=function(e){function t(t,n){e.call(this,t,n),this.initial=n.eqn,this.inflows=n.inflows,this.outflows=n.outflows}return r(t,e),t.prototype.initialEquation=function(){return this.initial},t.prototype.code=function(e){var t="curr["+e[this.ident]+"] + (";return this.inflows.length>0&&(t+=this.inflows.map(function(t){return"curr["+e[t]+"]"}).join("+")),this.outflows.length>0&&(t+="- ("+this.outflows.map(function(t){return"curr["+e[t]+"]"}).join("+")+")"),this.inflows.length===0&&this.outflows.length===0&&(t+="0"),t+=")*dt",t},t}(a);t.Stock=f;var l=function(e){function t(t,n){e.call(this,t,n),this.x=[],this.y=[],this.ok=!0;var r=n.gf.yPoints,i=n.gf.xPoints,s=n.gf.xScale,o=s?s.min:0,u=s?s.max:0;for(var a=0;a<r.length;a++){var f=void 0;i?f=i[a]:f=a/(r.length-1)*(u-o)+o,this.x.push(f),this.y.push(r[a])}}return r(t,e),t.prototype.code=function(t){if(!this.eqn)return null;var n=e.prototype.code.call(this,t);return"lookup(this.tables['"+this.ident+"'], "+n+")"},t}(a);t.Table=l;var c=function(e){function t(t,n,r){e.call(this),this.project=t,this.parent=n,this.xmile=r,this.ident=r.ident,this.modelName=this.ident,this.refs={},this._deps={};for(var i=0;i<r.connections.length;i++){var s=new h(r.connections[i]);this.refs[s.ident]=s,this._deps[s.ptr]=!0}}return r(t,e),t.prototype.getDeps=function(){if(this._allDeps)return this._allDeps;var e={};for(var t in this._deps){if(!this._deps.hasOwnProperty(t))continue;if(t in e)continue;var n=void 0;t[0]==="."?(n=this.project.model(this.project.main.modelName),t=t.substr(1)):n=this.parent;var r=t.split("."),i=n.lookup(t);if(!i){console.log("couldnt find "+t);continue}i instanceof f||(e[r[0]]=!0);var s=i.getDeps();for(var o in s)s.hasOwnProperty(o)&&(e[o]=!0)}return this._allDeps=e,e},t.prototype.referencedModels=function(e){e||(e={});var t=this.project.model(this.modelName),n=t.name;e[n]?e[n].modules.push(this):e[n]={model:t,modules:[this]};for(var r in t.modules)t.modules.hasOwnProperty(r)&&t.modules[r].referencedModels(e);return e},t}(a);t.Module=c;var h=function(e){function t(t){e.call(this),this.xmile=null,this.xmileConn=t,this.ident=t.to,this.ptr=t.from}return r(t,e),t.prototype.code=function(e){return'curr["'+this.ptr+'"]'},t.prototype.lessThan=function(e){return this.ptr in e.getDeps()},t.prototype.isConst=function(){return!1},t}(a);t.Reference=h}),function(e,t,r,i){"use strict";function c(e,t,n){return setTimeout(g(e,n),t)}function h(e,t,n){return Array.isArray(e)?(p(e,n[t],n),!0):!1}function p(e,t,n){var r;if(!e)return;if(e.forEach)e.forEach(t,n);else if(e.length!==i){r=0;while(r<e.length)t.call(n,e[r],r,e),r++}else for(r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e)}function d(e,t,n){var r=Object.keys(t),s=0;while(s<r.length){if(!n||n&&e[r[s]]===i)e[r[s]]=t[r[s]];s++}return e}function v(e,t){return d(e,t,!0)}function m(e,t,n){var r=t.prototype,i;i=e.prototype=Object.create(r),i.constructor=e,i._super=r,n&&d(i,n)}function g(e,t){return function(){return e.apply(t,arguments)}}function y(e,t){return typeof e==u?e.apply(t?t[0]||i:i,t):e}function b(e,t){return e===i?t:e}function w(e,t,n){p(T(t),function(t){e.addEventListener(t,n,!1)})}function E(e,t,n){p(T(t),function(t){e.removeEventListener(t,n,!1)})}function S(e,t){while(e){if(e==t)return!0;e=e.parentNode}return!1}function x(e,t){return e.indexOf(t)>-1}function T(e){return e.trim().split(/\s+/g)}function N(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);var r=0;while(r<e.length){if(n&&e[r][n]==t||!n&&e[r]===t)return r;r++}return-1}function C(e){return Array.prototype.slice.call(e,0)}function k(e,t,n){var r=[],i=[],s=0;while(s<e.length){var o=t?e[s][t]:e[s];N(i,o)<0&&r.push(e[s]),i[s]=o,s++}return n&&(t?r=r.sort(function(n,r){return n[t]>r[t]}):r=r.sort()),r}function L(e,t){var n,r,o=t[0].toUpperCase()+t.slice(1),u=0;while(u<s.length){n=s[u],r=n?n+o:t;if(r in e)return r;u++}return i}function O(){return A++}function M(e){var t=e.ownerDocument;return t.defaultView||t.parentWindow}function tt(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){e.options.enable&&n.handler(t)},this.init()}function nt(e){var t,n=e.options.inputClass;return n?t=n:P?t=xt:H?t=Mt:D?t=Dt:t=yt,new t(e,rt)}function rt(e,t,n){var r=n.pointers.length,i=n.changedPointers.length,s=t&R&&r-i===0,o=t&(z|W)&&r-i===0;n.isFirst=!!s,n.isFinal=!!o,s&&(e.session={}),n.eventType=t,it(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function it(e,t){var n=e.session,r=t.pointers,i=r.length;n.firstInput||(n.firstInput=ut(t)),i>1&&!n.firstMultiple?n.firstMultiple=ut(t):i===1&&(n.firstMultiple=!1);var s=n.firstInput,o=n.firstMultiple,u=o?o.center:s.center,a=t.center=at(r);t.timeStamp=l(),t.deltaTime=t.timeStamp-s.timeStamp,t.angle=ht(u,a),t.distance=ct(u,a),st(n,t),t.offsetDirection=lt(t.deltaX,t.deltaY),t.scale=o?dt(o.pointers,r):1,t.rotation=o?pt(o.pointers,r):0,ot(n,t);var f=e.element;S(t.srcEvent.target,f)&&(f=t.srcEvent.target),t.target=f}function st(e,t){var n=t.center,r=e.offsetDelta||{},i=e.prevDelta||{},s=e.prevInput||{};if(t.eventType===R||s.eventType===z)i=e.prevDelta={x:s.deltaX||0,y:s.deltaY||0},r=e.offsetDelta={x:n.x,y:n.y};t.deltaX=i.x+(n.x-r.x),t.deltaY=i.y+(n.y-r.y)}function ot(e,t){var n=e.lastInterval||t,r=t.timeStamp-n.timeStamp,s,o,u,a;if(t.eventType!=W&&(r>q||n.velocity===i)){var l=n.deltaX-t.deltaX,c=n.deltaY-t.deltaY,h=ft(r,l,c);o=h.x,u=h.y,s=f(h.x)>f(h.y)?h.x:h.y,a=lt(l,c),e.lastInterval=t}else s=n.velocity,o=n.velocityX,u=n.velocityY,a=n.direction;t.velocity=s,t.velocityX=o,t.velocityY=u,t.direction=a}function ut(e){var t=[],n=0;while(n<e.pointers.length)t[n]={clientX:a(e.pointers[n].clientX),clientY:a(e.pointers[n].clientY)},n++;return{timeStamp:l(),pointers:t,center:at(t),deltaX:e.deltaX,deltaY:e.deltaY}}function at(e){var t=e.length;if(t===1)return{x:a(e[0].clientX),y:a(e[0].clientY)};var n=0,r=0,i=0;while(i<t)n+=e[i].clientX,r+=e[i].clientY,i++;return{x:a(n/t),y:a(r/t)}}function ft(e,t,n){return{x:t/e||0,y:n/e||0}}function lt(e,t){return e===t?X:f(e)>=f(t)?e>0?V:$:t>0?J:K}function ct(e,t,n){n||(n=Z);var r=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return Math.sqrt(r*r+i*i)}function ht(e,t,n){n||(n=Z);var r=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return Math.atan2(i,r)*180/Math.PI}function pt(e,t){return ht(t[1],t[0],et)-ht(e[1],e[0],et)}function dt(e,t){return ct(t[0],t[1],et)/ct(e[0],e[1],et)}function yt(){this.evEl=mt,this.evWin=gt,this.allow=!0,this.pressed=!1,tt.apply(this,arguments)}function xt(){this.evEl=Et,this.evWin=St,tt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function kt(){this.evTarget=Nt,this.evWin=Ct,this.started=!1,tt.apply(this,arguments)}function Lt(e,t){var n=C(e.touches),r=C(e.changedTouches);return t&(z|W)&&(n=k(n.concat(r),"identifier",!0)),[n,r]}function Mt(){this.evTarget=Ot,this.targetIds={},tt.apply(this,arguments)}function _t(e,t){var n=C(e.touches),r=this.targetIds;if(t&(R|U)&&n.length===1)return r[n[0].identifier]=!0,[n,n];var i,s,o=C(e.changedTouches),u=[],a=this.target;s=n.filter(function(e){return S(e.target,a)});if(t===R){i=0;while(i<s.length)r[s[i].identifier]=!0,i++}i=0;while(i<o.length)r[o[i].identifier]&&u.push(o[i]),t&(z|W)&&delete r[o[i].identifier],i++;if(!u.length)return;return[k(s.concat(u),"identifier",!0),u]}function Dt(){tt.apply(this,arguments);var e=g(this.handler,this);this.touch=new Mt(this.manager,e),this.mouse=new yt(this.manager,e)}function Ut(e,t){this.manager=e,this.set(t)}function zt(e){if(x(e,It))return It;var t=x(e,qt),n=x(e,Rt);return t&&n?qt+" "+Rt:t||n?t?qt:Rt:x(e,Ft)?Ft:jt}function Gt(e){this.id=O(),this.manager=null,this.options=v(e||{},this.defaults),this.options.enable=b(this.options.enable,!0),this.state=Wt,this.simultaneous={},this.requireFail=[]}function Yt(e){return e&Kt?"cancel":e&$t?"end":e&Vt?"move":e&Xt?"start":""}function Zt(e){return e==K?"down":e==J?"up":e==V?"left":e==$?"right":""}function en(e,t){var n=t.manager;return n?n.get(e):e}function tn(){Gt.apply(this,arguments)}function nn(){tn.apply(this,arguments),this.pX=null,this.pY=null}function rn(){tn.apply(this,arguments)}function sn(){Gt.apply(this,arguments),this._timer=null,this._input=null}function on(){tn.apply(this,arguments)}function un(){tn.apply(this,arguments)}function an(){Gt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function fn(e,t){return t=t||{},t.recognizers=b(t.recognizers,fn.defaults.preset),new hn(e,t)}function hn(e,t){t=t||{},this.options=v(t,fn.defaults),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.element=e,this.input=nt(this),this.touchAction=new Ut(this,this.options.touchAction),pn(this,!0),p(t.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function pn(e,t){var n=e.element;p(e.options.cssProps,function(e,r){n.style[L(n.style,r)]=t?e:""})}function dn(e,n){var r=t.createEvent("Event");r.initEvent(e,!0,!0),r.gesture=n,n.target.dispatchEvent(r)}var s=["","webkit","moz","MS","ms","o"],o=t.createElement("div"),u="function",a=Math.round,f=Math.abs,l=Date.now,A=1,_=/mobile|tablet|ip(ad|hone|od)|android/i,D="ontouchstart"in e,P=L(e,"PointerEvent")!==i,H=D&&_.test(navigator.userAgent),B="touch",j="pen",F="mouse",I="kinect",q=25,R=1,U=2,z=4,W=8,X=1,V=2,$=4,J=8,K=16,Q=V|$,G=J|K,Y=Q|G,Z=["x","y"],et=["clientX","clientY"];tt.prototype={handler:function(){},init:function(){this.evEl&&w(this.element,this.evEl,this.domHandler),this.evTarget&&w(this.target,this.evTarget,this.domHandler),this.evWin&&w(M(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&E(this.element,this.evEl,this.domHandler),this.evTarget&&E(this.target,this.evTarget,this.domHandler),this.evWin&&E(M(this.element),this.evWin,this.domHandler)}};var vt={mousedown:R,mousemove:U,mouseup:z},mt="mousedown",gt="mousemove mouseup";m(yt,tt,{handler:function(t){var n=vt[t.type];n&R&&t.button===0&&(this.pressed=!0),n&U&&t.which!==1&&(n=z);if(!this.pressed||!this.allow)return;n&z&&(this.pressed=!1),this.callback(this.manager,n,{pointers:[t],changedPointers:[t],pointerType:F,srcEvent:t})}});var bt={pointerdown:R,pointermove:U,pointerup:z,pointercancel:W,pointerout:W},wt={2:B,3:j,4:F,5:I},Et="pointerdown",St="pointermove pointerup pointercancel";e.MSPointerEvent&&(Et="MSPointerDown",St="MSPointerMove MSPointerUp MSPointerCancel"),m(xt,tt,{handler:function(t){var n=this.store,r=!1,i=t.type.toLowerCase().replace("ms",""),s=bt[i],o=wt[t.pointerType]||t.pointerType,u=o==B,a=N(n,t.pointerId,"pointerId");s&R&&(t.button===0||u)?a<0&&(n.push(t),a=n.length-1):s&(z|W)&&(r=!0);if(a<0)return;n[a]=t,this.callback(this.manager,s,{pointers:n,changedPointers:[t],pointerType:o,srcEvent:t}),r&&n.splice(a,1)}});var Tt={touchstart:R,touchmove:U,touchend:z,touchcancel:W},Nt="touchstart",Ct="touchstart touchmove touchend touchcancel";m(kt,tt,{handler:function(t){var n=Tt[t.type];n===R&&(this.started=!0);if(!this.started)return;var r=Lt.call(this,t,n);n&(z|W)&&r[0].length-r[1].length===0&&(this.started=!1),this.callback(this.manager,n,{pointers:r[0],changedPointers:r[1],pointerType:B,srcEvent:t})}});var At={touchstart:R,touchmove:U,touchend:z,touchcancel:W},Ot="touchstart touchmove touchend touchcancel";m(Mt,tt,{handler:function(t){var n=At[t.type],r=_t.call(this,t,n);if(!r)return;this.callback(this.manager,n,{pointers:r[0],changedPointers:r[1],pointerType:B,srcEvent:t})}}),m(Dt,tt,{handler:function(t,n,r){var i=r.pointerType==B,s=r.pointerType==F;if(i)this.mouse.allow=!1;else if(s&&!this.mouse.allow)return;n&(z|W)&&(this.mouse.allow=!0),this.callback(t,n,r)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Pt=L(o.style,"touchAction"),Ht=Pt!==i,Bt="compute",jt="auto",Ft="manipulation",It="none",qt="pan-x",Rt="pan-y";Ut.prototype={set:function(e){e==Bt&&(e=this.compute()),Ht&&(this.manager.element.style[Pt]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return p(this.manager.recognizers,function(t){y(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),zt(e.join(" "))},preventDefaults:function(e){if(Ht)return;var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented){t.preventDefault();return}var r=this.actions,i=x(r,It),s=x(r,Rt),o=x(r,qt);if(i||s&&n&Q||o&&n&G)return this.preventSrc(t)},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Wt=1,Xt=2,Vt=4,$t=8,Jt=$t,Kt=16,Qt=32;Gt.prototype={defaults:{},set:function(e){return d(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(h(e,"recognizeWith",this))return this;var t=this.simultaneous;return e=en(e,this),t[e.id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return h(e,"dropRecognizeWith",this)?this:(e=en(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(h(e,"requireFailure",this))return this;var t=this.requireFail;return e=en(e,this),N(t,e)===-1&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(h(e,"dropRequireFailure",this))return this;e=en(e,this);var t=N(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){function r(r){t.manager.emit(t.options.event+(r?Yt(n):""),e)}var t=this,n=this.state;n<$t&&r(!0),r(),n>=$t&&r(!0)},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=Qt},canEmit:function(){var e=0;while(e<this.requireFail.length){if(!(this.requireFail[e].state&(Qt|Wt)))return!1;e++}return!0},recognize:function(e){var t=d({},e);if(!y(this.options.enable,[this,t])){this.reset(),this.state=Qt;return}this.state&(Jt|Kt|Qt)&&(this.state=Wt),this.state=this.process(t),this.state&(Xt|Vt|$t|Kt)&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},m(tn,Gt,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return t===0||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,r=t&(Xt|Vt),i=this.attrTest(e);if(r&&(n&W||!i))return t|Kt;if(r||i)return n&z?t|$t:t&Xt?t|Vt:Xt;return Qt}}),m(nn,tn,{defaults:{event:"pan",threshold:10,pointers:1,direction:Y},getTouchAction:function(){var e=this.options.direction,t=[];return e&Q&&t.push(Rt),e&G&&t.push(qt),t},directionTest:function(e){var t=this.options,n=!0,r=e.distance,i=e.direction,s=e.deltaX,o=e.deltaY;return i&t.direction||(t.direction&Q?(i=s===0?X:s<0?V:$,n=s!=this.pX,r=Math.abs(e.deltaX)):(i=o===0?X:o<0?J:K,n=o!=this.pY,r=Math.abs(e.deltaY))),e.direction=i,n&&r>t.threshold&&i&t.direction},attrTest:function(e){return tn.prototype.attrTest.call(this,e)&&(this.state&Xt||!(this.state&Xt)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=Zt(e.direction);t&&this.manager.emit(this.options.event+t,e),this._super.emit.call(this,e)}}),m(rn,tn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[It]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&Xt)},emit:function(e){this._super.emit.call(this,e);if(e.scale!==1){var t=e.scale<1?"in":"out";this.manager.emit(this.options.event+t,e)}}}),m(sn,Gt,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[jt]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime>t.time;this._input=e;if(!r||!n||e.eventType&(z|W)&&!i)this.reset();else if(e.eventType&R)this.reset(),this._timer=c(function(){this.state=Jt,this.tryEmit()},t.time,this);else if(e.eventType&z)return Jt;return Qt},reset:function(){clearTimeout(this._timer)},emit:function(e){if(this.state!==Jt)return;e&&e.eventType&z?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=l(),this.manager.emit(this.options.event,this._input))}}),m(on,tn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[It]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&Xt)}}),m(un,tn,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:Q|G,pointers:1},getTouchAction:function(){return nn.prototype.getTouchAction.call(this)},attrTest:function(e){var t=this.options.direction,n;return t&(Q|G)?n=e.velocity:t&Q?n=e.velocityX:t&G&&(n=e.velocityY),this._super.attrTest.call(this,e)&&t&e.direction&&e.distance>this.options.threshold&&f(n)>this.options.velocity&&e.eventType&z},emit:function(e){var t=Zt(e.direction);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),m(an,Gt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[Ft]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime<t.time;this.reset();if(e.eventType&R&&this.count===0)return this.failTimeout();if(r&&i&&n){if(e.eventType!=z)return this.failTimeout();var s=this.pTime?e.timeStamp-this.pTime<t.interval:!0,o=!this.pCenter||ct(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,!o||!s?this.count=1:this.count+=1,this._input=e;var u=this.count%t.taps;if(u===0)return this.hasRequireFailures()?(this._timer=c(function(){this.state=Jt,this.tryEmit()},t.interval,this),Xt):Jt}return Qt},failTimeout:function(){return this._timer=c(function(){this.state=Qt},this.options.interval,this),Qt},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Jt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),fn.VERSION="2.0.4",fn.defaults={domEvents:!1,touchAction:Bt,enable:!0,inputTarget:null,inputClass:null,preset:[[on,{enable:!1}],[rn,{enable:!1},["rotate"]],[un,{direction:Q}],[nn,{direction:Q},["swipe"]],[an],[an,{event:"doubletap",taps:2},["tap"]],[sn]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var ln=1,cn=2;hn.prototype={set:function(e){return d(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?cn:ln},recognize:function(e){var t=this.session;if(t.stopped)return;this.touchAction.preventDefaults(e);var n,r=this.recognizers,i=t.curRecognizer;if(!i||i&&i.state&Jt)i=t.curRecognizer=null;var s=0;while(s<r.length)n=r[s],t.stopped!==cn&&(!i||n==i||n.canRecognizeWith(i))?n.recognize(e):n.reset(),!i&&n.state&(Xt|Vt|$t)&&(i=t.curRecognizer=n),s++},get:function(e){if(e instanceof Gt)return e;var t=this.recognizers;for(var n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(h(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(h(e,"remove",this))return this;var t=this.recognizers;return e=this.get(e),t.splice(N(t,e),1),this.touchAction.update(),this},on:function(e,t){var n=this.handlers;return p(T(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this},off:function(e,t){var n=this.handlers;return p(T(e),function(e){t?n[e].splice(N(n[e],t),1):delete n[e]}),this},emit:function(e,t){this.options.domEvents&&dn(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(!n||!n.length)return;t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};var r=0;while(r<n.length)n[r](t),r++},destroy:function(){this.element&&pn(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},d(fn,{INPUT_START:R,INPUT_MOVE:U,INPUT_END:z,INPUT_CANCEL:W,STATE_POSSIBLE:Wt,STATE_BEGAN:Xt,STATE_CHANGED:Vt,STATE_ENDED:$t,STATE_RECOGNIZED:Jt,STATE_CANCELLED:Kt,STATE_FAILED:Qt,DIRECTION_NONE:X,DIRECTION_LEFT:V,DIRECTION_RIGHT:$,DIRECTION_UP:J,DIRECTION_DOWN:K,DIRECTION_HORIZONTAL:Q,DIRECTION_VERTICAL:G,DIRECTION_ALL:Y,Manager:hn,Input:tt,TouchAction:Ut,TouchInput:Mt,MouseInput:yt,PointerEventInput:xt,TouchMouseInput:Dt,SingleTouchInput:kt,Recognizer:Gt,AttrRecognizer:tn,Tap:an,Pan:nn,Swipe:un,Pinch:rn,Rotate:on,Press:sn,on:w,off:E,each:p,merge:v,extend:d,inherit:m,bindFn:g,prefixed:L}),typeof n==u&&n.amd?n("Hammer",[],function(){return fn}):typeof module!="undefined"&&module.exports?module.exports=fn:e[r]=fn}(window,document,"Hammer"),n("runtime",["require","exports"],function(e,t){t.preamble="'use strict';\nfunction i32(n) {\n    'use strict';\n    return n | 0;\n}\nvar Simulation = (function () {\n    function Simulation() {\n    }\n    Simulation.prototype.lookupOffset = function (id) {\n        if (id === 'time')\n            return 0;\n        if (id[0] === '.')\n            id = id.substr(1);\n        if (id in this.offsets)\n            return this._shift + this.offsets[id];\n        var parts = id.split('.');\n        if (parts.length === 1 && id === \"\" && this.name in this.offsets)\n            return this._shift + this.offsets[this.name];\n        var nextSim = this.modules[parts[0]];\n        if (!nextSim)\n            return -1;\n        return nextSim.lookupOffset(parts.slice(1).join('.'));\n    };\n    Simulation.prototype.root = function () {\n        if (!this.parent)\n            return this;\n        return this.parent.root();\n    };\n    Simulation.prototype.resolveAllSymbolicRefs = function () {\n        for (var n in this.symRefs) {\n            if (!this.symRefs.hasOwnProperty(n))\n                continue;\n            var ctx = void 0;\n            if (this.symRefs[n][0] === '.') {\n                ctx = this.root();\n            }\n            else {\n                ctx = this.parent;\n            }\n            this.ref[n] = ctx.lookupOffset(this.symRefs[n]);\n        }\n        for (var n in this.modules) {\n            if (!this.modules.hasOwnProperty(n))\n                continue;\n            this.modules[n].resolveAllSymbolicRefs();\n        }\n    };\n    Simulation.prototype.varNames = function () {\n        var result = Object.keys(this.offsets).slice();\n        for (var v in this.modules) {\n            if (!this.modules.hasOwnProperty(v))\n                continue;\n            var ids = [];\n            var modVarNames = this.modules[v].varNames();\n            for (var n in modVarNames) {\n                if (modVarNames.hasOwnProperty(n))\n                    ids.push(v + '.' + modVarNames[n]);\n            }\n            result = result.concat(ids);\n        }\n        if (this.name === 'main')\n            result.push('time');\n        return result;\n    };\n    Simulation.prototype.getNVars = function () {\n        var nVars = Object.keys(this.offsets).length;\n        for (var n in this.modules) {\n            if (this.modules.hasOwnProperty(n))\n                nVars += this.modules[n].getNVars();\n        }\n        if (this.name === 'main')\n            nVars++;\n        return nVars;\n    };\n    Simulation.prototype.reset = function () {\n        var spec = this.simSpec;\n        var nSaveSteps = i32((spec.stop - spec.start) / spec.saveStep + 1);\n        this.stepNum = 0;\n        this.slab = new Float64Array(this.nVars * (nSaveSteps + 1));\n        var curr = this.curr();\n        curr[0] = spec.start;\n        this.saveEvery = Math.max(1, i32(spec.saveStep / spec.dt + 0.5));\n        this.calcInitial(this.simSpec.dt, curr);\n    };\n    Simulation.prototype.runTo = function (endTime) {\n        var dt = this.simSpec.dt;\n        var curr = this.curr();\n        var next = this.slab.subarray((this.stepNum + 1) * this.nVars, (this.stepNum + 2) * this.nVars);\n        while (curr[0] <= endTime) {\n            this.calcFlows(dt, curr);\n            this.calcStocks(dt, curr, next);\n            next[0] = curr[0] + dt;\n            if (this.stepNum++ % this.saveEvery !== 0) {\n                curr.set(next);\n            }\n            else {\n                curr = next;\n                next = this.slab.subarray((i32(this.stepNum / this.saveEvery) + 1) * this.nVars, (i32(this.stepNum / this.saveEvery) + 2) * this.nVars);\n            }\n        }\n    };\n    Simulation.prototype.runToEnd = function () {\n        return this.runTo(this.simSpec.stop + 0.5 * this.simSpec.dt);\n    };\n    Simulation.prototype.curr = function () {\n        return this.slab.subarray((this.stepNum) * this.nVars, (this.stepNum + 1) * this.nVars);\n    };\n    Simulation.prototype.setValue = function (name, value) {\n        var off = this.lookupOffset(name);\n        if (off === -1)\n            return;\n        this.curr()[off] = value;\n    };\n    Simulation.prototype.value = function (name) {\n        var off = this.lookupOffset(name);\n        if (off === -1)\n            return;\n        var saveNum = i32(this.stepNum / this.saveEvery);\n        var slabOff = this.nVars * saveNum;\n        return this.slab.subarray(slabOff, slabOff + this.nVars)[off];\n    };\n    Simulation.prototype.series = function (name) {\n        var saveNum = i32(this.stepNum / this.saveEvery);\n        var time = new Float64Array(saveNum);\n        var values = new Float64Array(saveNum);\n        var off = this.lookupOffset(name);\n        if (off === -1)\n            return;\n        for (var i = 0; i < time.length; i++) {\n            var curr = this.slab.subarray(i * this.nVars, (i + 1) * this.nVars);\n            time[i] = curr[0];\n            values[i] = curr[off];\n        }\n        return {\n            'name': name,\n            'time': time,\n            'values': values,\n        };\n    };\n    return Simulation;\n})();\nvar cmds;\nfunction handleMessage(e) {\n    'use strict';\n    var id = e.data[0];\n    var cmd = e.data[1];\n    var args = e.data.slice(2);\n    var result;\n    if (cmds.hasOwnProperty(cmd)) {\n        result = cmds[cmd].apply(null, args);\n    }\n    else {\n        result = [null, 'unknown command \"' + cmd + '\"'];\n    }\n    if (!Array.isArray(result))\n        result = [null, 'no result for [' + e.data.join(', ') + ']'];\n    var msg = [id, result];\n    this.postMessage(msg);\n}\nvar desiredSeries = null;\nfunction initCmds(main) {\n    'use strict';\n    return {\n        'reset': function () {\n            main.reset();\n            return ['ok', null];\n        },\n        'set_val': function (name, val) {\n            main.setValue(name, val);\n            return ['ok', null];\n        },\n        'get_val': function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i - 0] = arguments[_i];\n            }\n            var result = {};\n            for (var i = 0; i < args.length; i++)\n                result[args[i]] = main.value(args[i]);\n            return [result, null];\n        },\n        'get_series': function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i - 0] = arguments[_i];\n            }\n            var result = {};\n            for (var i = 0; i < args.length; i++)\n                result[args[i]] = main.series(args[i]);\n            return [result, null];\n        },\n        'run_to': function (time) {\n            main.runTo(time);\n            return [main.value('time'), null];\n        },\n        'run_to_end': function () {\n            var result = {};\n            main.runToEnd();\n            if (desiredSeries) {\n                for (var i = 0; i < desiredSeries.length; i++)\n                    result[desiredSeries[i]] = main.series(desiredSeries[i]);\n                return [result, null];\n            }\n            else {\n                return [main.value('time'), null];\n            }\n        },\n        'var_names': function () {\n            return [main.varNames(), null];\n        },\n        'set_desired_series': function (names) {\n            desiredSeries = names;\n            return ['ok', null];\n        },\n    };\n}\nfunction lookup(table, index) {\n    'use strict';\n    var size = table.x.length;\n    if (size === 0)\n        return NaN;\n    var x = table.x;\n    var y = table.y;\n    if (index <= x[0]) {\n        return y[0];\n    }\n    else if (index >= x[size - 1]) {\n        return y[size - 1];\n    }\n    var low = 0;\n    var high = size;\n    var mid;\n    while (low < high) {\n        mid = Math.floor(low + (high - low) / 2);\n        if (x[mid] < index) {\n            low = mid + 1;\n        }\n        else {\n            high = mid;\n        }\n    }\n    var i = low;\n    if (x[i] === index) {\n        return y[i];\n    }\n    else {\n        var slope = (y[i] - y[i - 1]) / (x[i] - x[i - 1]);\n        return (index - x[i - 1]) * slope + y[i - 1];\n    }\n}\nfunction max(a, b) {\n    'use strict';\n    a = +a;\n    b = +b;\n    return a > b ? a : b;\n}\nfunction min(a, b) {\n    'use strict';\n    a = +a;\n    b = +b;\n    return a < b ? a : b;\n}\nfunction pulse(dt, time, volume, firstPulse, interval) {\n    'use strict';\n    if (time < firstPulse)\n        return 0;\n    var nextPulse = firstPulse;\n    while (time >= nextPulse) {\n        if (time < nextPulse + dt) {\n            return volume / dt;\n        }\n        else if (interval <= 0.0) {\n            break;\n        }\n        else {\n            nextPulse += interval;\n        }\n    }\n    return 0;\n}",t.epilogue="/// <reference path=\"./generated.d.ts\" />\nvar pr;\nif (typeof console === 'undefined') {\n    pr = print;\n}\nelse {\n    pr = console.log;\n}\nmain.runToEnd();\nvar series = {};\nvar header = 'time\\t';\nvar vars = main.varNames();\nfor (var i = 0; i < vars.length; i++) {\n    var v = vars[i];\n    if (v === 'time')\n        continue;\n    header += v + '\\t';\n    series[v] = main.series(v);\n}\npr(header.substr(0, header.length - 1));\nvar nSteps = main.series('time').time.length;\nfor (var i = 0; i < nSteps; i++) {\n    var msg = '';\n    for (var v in series) {\n        if (!series.hasOwnProperty(v))\n            continue;\n        if (msg === '')\n            msg += series[v].time[i] + '\\t';\n        msg += series[v].values[i] + '\\t';\n    }\n    pr(msg.substr(0, msg.length - 1));\n}",t.drawCSS='<defs><style>\n/* <![CDATA[ */\n.spark-axis {\n    stroke-width: 0.125;\n    stroke-linecap: round;\n    stroke: #999;\n    fill: none;\n}\n\n.spark-line {\n    stroke-width: 0.5;\n    stroke-linecap: round;\n    stroke: #2299dd;\n    fill: none;\n}\n\ntext {\n    font-size: 12px;\n    font-family: "Roboto", "Open Sans", Arial, sans-serif;\n    font-weight: 300;\n    text-anchor: middle;\n    white-space: nowrap;\n    vertical-align: middle;\n}\n\n.left-aligned {\n    text-anchor: start;\n}\n\n.right-aligned {\n    text-anchor: end;\n}\n/* ]]> */\n</style></defs>\n'}),function(e,t,r,i){"use strict";function c(e,t,n){return setTimeout(g(e,n),t)}function h(e,t,n){return Array.isArray(e)?(p(e,n[t],n),!0):!1}function p(e,t,n){var r;if(!e)return;if(e.forEach)e.forEach(t,n);else if(e.length!==i){r=0;while(r<e.length)t.call(n,e[r],r,e),r++}else for(r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e)}function d(e,t,n){var r=Object.keys(t),s=0;while(s<r.length){if(!n||n&&e[r[s]]===i)e[r[s]]=t[r[s]];s++}return e}function v(e,t){return d(e,t,!0)}function m(e,t,n){var r=t.prototype,i;i=e.prototype=Object.create(r),i.constructor=e,i._super=r,n&&d(i,n)}function g(e,t){return function(){return e.apply(t,arguments)}}function y(e,t){return typeof e==u?e.apply(t?t[0]||i:i,t):e}function b(e,t){return e===i?t:e}function w(e,t,n){p(T(t),function(t){e.addEventListener(t,n,!1)})}function E(e,t,n){p(T(t),function(t){e.removeEventListener(t,n,!1)})}function S(e,t){while(e){if(e==t)return!0;e=e.parentNode}return!1}function x(e,t){return e.indexOf(t)>-1}function T(e){return e.trim().split(/\s+/g)}function N(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);var r=0;while(r<e.length){if(n&&e[r][n]==t||!n&&e[r]===t)return r;r++}return-1}function C(e){return Array.prototype.slice.call(e,0)}function k(e,t,n){var r=[],i=[],s=0;while(s<e.length){var o=t?e[s][t]:e[s];N(i,o)<0&&r.push(e[s]),i[s]=o,s++}return n&&(t?r=r.sort(function(n,r){return n[t]>r[t]}):r=r.sort()),r}function L(e,t){var n,r,o=t[0].toUpperCase()+t.slice(1),u=0;while(u<s.length){n=s[u],r=n?n+o:t;if(r in e)return r;u++}return i}function O(){return A++}function M(e){var t=e.ownerDocument;return t.defaultView||t.parentWindow}function tt(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){e.options.enable&&n.handler(t)},this.init()}function nt(e){var t,n=e.options.inputClass;return n?t=n:P?t=xt:H?t=Mt:D?t=Dt:t=yt,new t(e,rt)}function rt(e,t,n){var r=n.pointers.length,i=n.changedPointers.length,s=t&R&&r-i===0,o=t&(z|W)&&r-i===0;n.isFirst=!!s,n.isFinal=!!o,s&&(e.session={}),n.eventType=t,it(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function it(e,t){var n=e.session,r=t.pointers,i=r.length;n.firstInput||(n.firstInput=ut(t)),i>1&&!n.firstMultiple?n.firstMultiple=ut(t):i===1&&(n.firstMultiple=!1);var s=n.firstInput,o=n.firstMultiple,u=o?o.center:s.center,a=t.center=at(r);t.timeStamp=l(),t.deltaTime=t.timeStamp-s.timeStamp,t.angle=ht(u,a),t.distance=ct(u,a),st(n,t),t.offsetDirection=lt(t.deltaX,t.deltaY),t.scale=o?dt(o.pointers,r):1,t.rotation=o?pt(o.pointers,r):0,ot(n,t);var f=e.element;S(t.srcEvent.target,f)&&(f=t.srcEvent.target),t.target=f}function st(e,t){var n=t.center,r=e.offsetDelta||{},i=e.prevDelta||{},s=e.prevInput||{};if(t.eventType===R||s.eventType===z)i=e.prevDelta={x:s.deltaX||0,y:s.deltaY||0},r=e.offsetDelta={x:n.x,y:n.y};t.deltaX=i.x+(n.x-r.x),t.deltaY=i.y+(n.y-r.y)}function ot(e,t){var n=e.lastInterval||t,r=t.timeStamp-n.timeStamp,s,o,u,a;if(t.eventType!=W&&(r>q||n.velocity===i)){var l=n.deltaX-t.deltaX,c=n.deltaY-t.deltaY,h=ft(r,l,c);o=h.x,u=h.y,s=f(h.x)>f(h.y)?h.x:h.y,a=lt(l,c),e.lastInterval=t}else s=n.velocity,o=n.velocityX,u=n.velocityY,a=n.direction;t.velocity=s,t.velocityX=o,t.velocityY=u,t.direction=a}function ut(e){var t=[],n=0;while(n<e.pointers.length)t[n]={clientX:a(e.pointers[n].clientX),clientY:a(e.pointers[n].clientY)},n++;return{timeStamp:l(),pointers:t,center:at(t),deltaX:e.deltaX,deltaY:e.deltaY}}function at(e){var t=e.length;if(t===1)return{x:a(e[0].clientX),y:a(e[0].clientY)};var n=0,r=0,i=0;while(i<t)n+=e[i].clientX,r+=e[i].clientY,i++;return{x:a(n/t),y:a(r/t)}}function ft(e,t,n){return{x:t/e||0,y:n/e||0}}function lt(e,t){return e===t?X:f(e)>=f(t)?e>0?V:$:t>0?J:K}function ct(e,t,n){n||(n=Z);var r=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return Math.sqrt(r*r+i*i)}function ht(e,t,n){n||(n=Z);var r=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return Math.atan2(i,r)*180/Math.PI}function pt(e,t){return ht(t[1],t[0],et)-ht(e[1],e[0],et)}function dt(e,t){return ct(t[0],t[1],et)/ct(e[0],e[1],et)}function yt(){this.evEl=mt,this.evWin=gt,this.allow=!0,this.pressed=!1,tt.apply(this,arguments)}function xt(){this.evEl=Et,this.evWin=St,tt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function kt(){this.evTarget=Nt,this.evWin=Ct,this.started=!1,tt.apply(this,arguments)}function Lt(e,t){var n=C(e.touches),r=C(e.changedTouches);return t&(z|W)&&(n=k(n.concat(r),"identifier",!0)),[n,r]}function Mt(){this.evTarget=Ot,this.targetIds={},tt.apply(this,arguments)}function _t(e,t){var n=C(e.touches),r=this.targetIds;if(t&(R|U)&&n.length===1)return r[n[0].identifier]=!0,[n,n];var i,s,o=C(e.changedTouches),u=[],a=this.target;s=n.filter(function(e){return S(e.target,a)});if(t===R){i=0;while(i<s.length)r[s[i].identifier]=!0,i++}i=0;while(i<o.length)r[o[i].identifier]&&u.push(o[i]),t&(z|W)&&delete r[o[i].identifier],i++;if(!u.length)return;return[k(s.concat(u),"identifier",!0),u]}function Dt(){tt.apply(this,arguments);var e=g(this.handler,this);this.touch=new Mt(this.manager,e),this.mouse=new yt(this.manager,e)}function Ut(e,t){this.manager=e,this.set(t)}function zt(e){if(x(e,It))return It;var t=x(e,qt),n=x(e,Rt);return t&&n?qt+" "+Rt:t||n?t?qt:Rt:x(e,Ft)?Ft:jt}function Gt(e){this.id=O(),this.manager=null,this.options=v(e||{},this.defaults),this.options.enable=b(this.options.enable,!0),this.state=Wt,this.simultaneous={},this.requireFail=[]}function Yt(e){return e&Kt?"cancel":e&$t?"end":e&Vt?"move":e&Xt?"start":""}function Zt(e){return e==K?"down":e==J?"up":e==V?"left":e==$?"right":""}function en(e,t){var n=t.manager;return n?n.get(e):e}function tn(){Gt.apply(this,arguments)}function nn(){tn.apply(this,arguments),this.pX=null,this.pY=null}function rn(){tn.apply(this,arguments)}function sn(){Gt.apply(this,arguments),this._timer=null,this._input=null}function on(){tn.apply(this,arguments)}function un(){tn.apply(this,arguments)}function an(){Gt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function fn(e,t){return t=t||{},t.recognizers=b(t.recognizers,fn.defaults.preset),new hn(e,t)}function hn(e,t){t=t||{},this.options=v(t,fn.defaults),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.element=e,this.input=nt(this),this.touchAction=new Ut(this,this.options.touchAction),pn(this,!0),p(t.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function pn(e,t){var n=e.element;p(e.options.cssProps,function(e,r){n.style[L(n.style,r)]=t?e:""})}function dn(e,n){var r=t.createEvent("Event");r.initEvent(e,!0,!0),r.gesture=n,n.target.dispatchEvent(r)}var s=["","webkit","moz","MS","ms","o"],o=t.createElement("div"),u="function",a=Math.round,f=Math.abs,l=Date.now,A=1,_=/mobile|tablet|ip(ad|hone|od)|android/i,D="ontouchstart"in e,P=L(e,"PointerEvent")!==i,H=D&&_.test(navigator.userAgent),B="touch",j="pen",F="mouse",I="kinect",q=25,R=1,U=2,z=4,W=8,X=1,V=2,$=4,J=8,K=16,Q=V|$,G=J|K,Y=Q|G,Z=["x","y"],et=["clientX","clientY"];tt.prototype={handler:function(){},init:function(){this.evEl&&w(this.element,this.evEl,this.domHandler),this.evTarget&&w(this.target,this.evTarget,this.domHandler),this.evWin&&w(M(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&E(this.element,this.evEl,this.domHandler),this.evTarget&&E(this.target,this.evTarget,this.domHandler),this.evWin&&E(M(this.element),this.evWin,this.domHandler)}};var vt={mousedown:R,mousemove:U,mouseup:z},mt="mousedown",gt="mousemove mouseup";m(yt,tt,{handler:function(t){var n=vt[t.type];n&R&&t.button===0&&(this.pressed=!0),n&U&&t.which!==1&&(n=z);if(!this.pressed||!this.allow)return;n&z&&(this.pressed=!1),this.callback(this.manager,n,{pointers:[t],changedPointers:[t],pointerType:F,srcEvent:t})}});var bt={pointerdown:R,pointermove:U,pointerup:z,pointercancel:W,pointerout:W},wt={2:B,3:j,4:F,5:I},Et="pointerdown",St="pointermove pointerup pointercancel";e.MSPointerEvent&&(Et="MSPointerDown",St="MSPointerMove MSPointerUp MSPointerCancel"),m(xt,tt,{handler:function(t){var n=this.store,r=!1,i=t.type.toLowerCase().replace("ms",""),s=bt[i],o=wt[t.pointerType]||t.pointerType,u=o==B,a=N(n,t.pointerId,"pointerId");s&R&&(t.button===0||u)?a<0&&(n.push(t),a=n.length-1):s&(z|W)&&(r=!0);if(a<0)return;n[a]=t,this.callback(this.manager,s,{pointers:n,changedPointers:[t],pointerType:o,srcEvent:t}),r&&n.splice(a,1)}});var Tt={touchstart:R,touchmove:U,touchend:z,touchcancel:W},Nt="touchstart",Ct="touchstart touchmove touchend touchcancel";m(kt,tt,{handler:function(t){var n=Tt[t.type];n===R&&(this.started=!0);if(!this.started)return;var r=Lt.call(this,t,n);n&(z|W)&&r[0].length-r[1].length===0&&(this.started=!1),this.callback(this.manager,n,{pointers:r[0],changedPointers:r[1],pointerType:B,srcEvent:t})}});var At={touchstart:R,touchmove:U,touchend:z,touchcancel:W},Ot="touchstart touchmove touchend touchcancel";m(Mt,tt,{handler:function(t){var n=At[t.type],r=_t.call(this,t,n);if(!r)return;this.callback(this.manager,n,{pointers:r[0],changedPointers:r[1],pointerType:B,srcEvent:t})}}),m(Dt,tt,{handler:function(t,n,r){var i=r.pointerType==B,s=r.pointerType==F;if(i)this.mouse.allow=!1;else if(s&&!this.mouse.allow)return;n&(z|W)&&(this.mouse.allow=!0),this.callback(t,n,r)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Pt=L(o.style,"touchAction"),Ht=Pt!==i,Bt="compute",jt="auto",Ft="manipulation",It="none",qt="pan-x",Rt="pan-y";Ut.prototype={set:function(e){e==Bt&&(e=this.compute()),Ht&&(this.manager.element.style[Pt]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return p(this.manager.recognizers,function(t){y(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),zt(e.join(" "))},preventDefaults:function(e){if(Ht)return;var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented){t.preventDefault();return}var r=this.actions,i=x(r,It),s=x(r,Rt),o=x(r,qt);if(i||s&&n&Q||o&&n&G)return this.preventSrc(t)},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Wt=1,Xt=2,Vt=4,$t=8,Jt=$t,Kt=16,Qt=32;Gt.prototype={defaults:{},set:function(e){return d(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(h(e,"recognizeWith",this))return this;var t=this.simultaneous;return e=en(e,this),t[e.id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return h(e,"dropRecognizeWith",this)?this:(e=en(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(h(e,"requireFailure",this))return this;var t=this.requireFail;return e=en(e,this),N(t,e)===-1&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(h(e,"dropRequireFailure",this))return this;e=en(e,this);var t=N(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){function r(r){t.manager.emit(t.options.event+(r?Yt(n):""),e)}var t=this,n=this.state;n<$t&&r(!0),r(),n>=$t&&r(!0)},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=Qt},canEmit:function(){var e=0;while(e<this.requireFail.length){if(!(this.requireFail[e].state&(Qt|Wt)))return!1;e++}return!0},recognize:function(e){var t=d({},e);if(!y(this.options.enable,[this,t])){this.reset(),this.state=Qt;return}this.state&(Jt|Kt|Qt)&&(this.state=Wt),this.state=this.process(t),this.state&(Xt|Vt|$t|Kt)&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},m(tn,Gt,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return t===0||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,r=t&(Xt|Vt),i=this.attrTest(e);if(r&&(n&W||!i))return t|Kt;if(r||i)return n&z?t|$t:t&Xt?t|Vt:Xt;return Qt}}),m(nn,tn,{defaults:{event:"pan",threshold:10,pointers:1,direction:Y},getTouchAction:function(){var e=this.options.direction,t=[];return e&Q&&t.push(Rt),e&G&&t.push(qt),t},directionTest:function(e){var t=this.options,n=!0,r=e.distance,i=e.direction,s=e.deltaX,o=e.deltaY;return i&t.direction||(t.direction&Q?(i=s===0?X:s<0?V:$,n=s!=this.pX,r=Math.abs(e.deltaX)):(i=o===0?X:o<0?J:K,n=o!=this.pY,r=Math.abs(e.deltaY))),e.direction=i,n&&r>t.threshold&&i&t.direction},attrTest:function(e){return tn.prototype.attrTest.call(this,e)&&(this.state&Xt||!(this.state&Xt)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=Zt(e.direction);t&&this.manager.emit(this.options.event+t,e),this._super.emit.call(this,e)}}),m(rn,tn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[It]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&Xt)},emit:function(e){this._super.emit.call(this,e);if(e.scale!==1){var t=e.scale<1?"in":"out";this.manager.emit(this.options.event+t,e)}}}),m(sn,Gt,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[jt]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime>t.time;this._input=e;if(!r||!n||e.eventType&(z|W)&&!i)this.reset();else if(e.eventType&R)this.reset(),this._timer=c(function(){this.state=Jt,this.tryEmit()},t.time,this);else if(e.eventType&z)return Jt;return Qt},reset:function(){clearTimeout(this._timer)},emit:function(e){if(this.state!==Jt)return;e&&e.eventType&z?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=l(),this.manager.emit(this.options.event,this._input))}}),m(on,tn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[It]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&Xt)}}),m(un,tn,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:Q|G,pointers:1},getTouchAction:function(){return nn.prototype.getTouchAction.call(this)},attrTest:function(e){var t=this.options.direction,n;return t&(Q|G)?n=e.velocity:t&Q?n=e.velocityX:t&G&&(n=e.velocityY),this._super.attrTest.call(this,e)&&t&e.direction&&e.distance>this.options.threshold&&f(n)>this.options.velocity&&e.eventType&z},emit:function(e){var t=Zt(e.direction);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),m(an,Gt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[Ft]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime<t.time;this.reset();if(e.eventType&R&&this.count===0)return this.failTimeout();if(r&&i&&n){if(e.eventType!=z)return this.failTimeout();var s=this.pTime?e.timeStamp-this.pTime<t.interval:!0,o=!this.pCenter||ct(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,!o||!s?this.count=1:this.count+=1,this._input=e;var u=this.count%t.taps;if(u===0)return this.hasRequireFailures()?(this._timer=c(function(){this.state=Jt,this.tryEmit()},t.interval,this),Xt):Jt}return Qt},failTimeout:function(){return this._timer=c(function(){this.state=Qt},this.options.interval,this),Qt},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Jt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),fn.VERSION="2.0.4",fn.defaults={domEvents:!1,touchAction:Bt,enable:!0,inputTarget:null,inputClass:null,preset:[[on,{enable:!1}],[rn,{enable:!1},["rotate"]],[un,{direction:Q}],[nn,{direction:Q},["swipe"]],[an],[an,{event:"doubletap",taps:2},["tap"]],[sn]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var ln=1,cn=2;hn.prototype={set:function(e){return d(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?cn:ln},recognize:function(e){var t=this.session;if(t.stopped)return;this.touchAction.preventDefaults(e);var n,r=this.recognizers,i=t.curRecognizer;if(!i||i&&i.state&Jt)i=t.curRecognizer=null;var s=0;while(s<r.length)n=r[s],t.stopped!==cn&&(!i||n==i||n.canRecognizeWith(i))?n.recognize(e):n.reset(),!i&&n.state&(Xt|Vt|$t)&&(i=t.curRecognizer=n),s++},get:function(e){if(e instanceof Gt)return e;var t=this.recognizers;for(var n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(h(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(h(e,"remove",this))return this;var t=this.recognizers;return e=this.get(e),t.splice(N(t,e),1),this.touchAction.update(),this},on:function(e,t){var n=this.handlers;return p(T(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this},off:function(e,t){var n=this.handlers;return p(T(e),function(e){t?n[e].splice(N(n[e],t),1):delete n[e]}),this},emit:function(e,t){this.options.domEvents&&dn(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(!n||!n.length)return;t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};var r=0;while(r<n.length)n[r](t),r++},destroy:function(){this.element&&pn(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},d(fn,{INPUT_START:R,INPUT_MOVE:U,INPUT_END:z,INPUT_CANCEL:W,STATE_POSSIBLE:Wt,STATE_BEGAN:Xt,STATE_CHANGED:Vt,STATE_ENDED:$t,STATE_RECOGNIZED:Jt,STATE_CANCELLED:Kt,STATE_FAILED:Qt,DIRECTION_NONE:X,DIRECTION_LEFT:V,DIRECTION_RIGHT:$,DIRECTION_UP:J,DIRECTION_DOWN:K,DIRECTION_HORIZONTAL:Q,DIRECTION_VERTICAL:G,DIRECTION_ALL:Y,Manager:hn,Input:tt,TouchAction:Ut,TouchInput:Mt,MouseInput:yt,PointerEventInput:xt,TouchMouseInput:Dt,SingleTouchInput:kt,Recognizer:Gt,AttrRecognizer:tn,Tap:an,Pan:nn,Swipe:un,Pinch:rn,Rotate:on,Press:sn,on:w,off:E,each:p,merge:v,extend:d,inherit:m,bindFn:g,prefixed:L}),typeof n==u&&n.amd?n("../bower_components/hammerjs/hammer",[],function(){return fn}):typeof module!="undefined"&&module.exports?module.exports=fn:e[r]=fn}(window,document,"Hammer"),function(e){var t="0.4.2",r="hasOwnProperty",i=/[\.\/]/,s=/\s*,\s*/,o="*",u=function(){},a=function(e,t){return e-t},f,l,c={n:{}},h=function(){for(var e=0,t=this.length;e<t;e++)if(typeof this[e]!="undefined")return this[e]},p=function(){var e=this.length;while(--e)if(typeof this[e]!="undefined")return this[e]},d=function(e,t){e=String(e);var n=c,r=l,i=Array.prototype.slice.call(arguments,2),s=d.listeners(e),o=0,u=!1,v,m=[],g={},y=[],b=f,w=[];y.firstDefined=h,y.lastDefined=p,f=e,l=0;for(var E=0,S=s.length;E<S;E++)"zIndex"in s[E]&&(m.push(s[E].zIndex),s[E].zIndex<0&&(g[s[E].zIndex]=s[E]));m.sort(a);while(m[o]<0){v=g[m[o++]],y.push(v.apply(t,i));if(l)return l=r,y}for(E=0;E<S;E++){v=s[E];if("zIndex"in v)if(v.zIndex==m[o]){y.push(v.apply(t,i));if(l)break;do{o++,v=g[m[o]],v&&y.push(v.apply(t,i));if(l)break}while(v)}else g[v.zIndex]=v;else{y.push(v.apply(t,i));if(l)break}}return l=r,f=b,y};d._events=c,d.listeners=function(e){var t=e.split(i),n=c,r,s,u,a,f,l,h,p,d=[n],v=[];for(a=0,f=t.length;a<f;a++){p=[];for(l=0,h=d.length;l<h;l++){n=d[l].n,s=[n[t[a]],n[o]],u=2;while(u--)r=s[u],r&&(p.push(r),v=v.concat(r.f||[]))}d=p}return v},d.on=function(e,t){e=String(e);if(typeof t!="function")return function(){};var n=e.split(s);for(var r=0,o=n.length;r<o;r++)(function(e){var n=e.split(i),r=c,s;for(var o=0,u=n.length;o<u;o++)r=r.n,r=r.hasOwnProperty(n[o])&&r[n[o]]||(r[n[o]]={n:{}});r.f=r.f||[];for(o=0,u=r.f.length;o<u;o++)if(r.f[o]==t){s=!0;break}!s&&r.f.push(t)})(n[r]);return function(e){+e==+e&&(t.zIndex=+e)}},d.f=function(e){var t=[].slice.call(arguments,1);return function(){d.apply(null,[e,null].concat(t).concat([].slice.call(arguments,0)))}},d.stop=function(){l=1},d.nt=function(e){return e?(new RegExp("(?:\\.|\\/|^)"+e+"(?:\\.|\\/|$)")).test(f):f},d.nts=function(){return f.split(i)},d.off=d.unbind=function(e,t){if(!e){d._events=c={n:{}};return}var n=e.split(s);if(n.length>1){for(var u=0,a=n.length;u<a;u++)d.off(n[u],t);return}n=e.split(i);var f,l,h,u,a,p,v,m=[c];for(u=0,a=n.length;u<a;u++)for(p=0;p<m.length;p+=h.length-2){h=[p,1],f=m[p].n;if(n[u]!=o)f[n[u]]&&h.push(f[n[u]]);else for(l in f)f[r](l)&&h.push(f[l]);m.splice.apply(m,h)}for(u=0,a=m.length;u<a;u++){f=m[u];while(f.n){if(t){if(f.f){for(p=0,v=f.f.length;p<v;p++)if(f.f[p]==t){f.f.splice(p,1);break}!f.f.length&&delete f.f}for(l in f.n)if(f.n[r](l)&&f.n[l].f){var g=f.n[l].f;for(p=0,v=g.length;p<v;p++)if(g[p]==t){g.splice(p,1);break}!g.length&&delete f.n[l].f}}else{delete f.f;for(l in f.n)f.n[r](l)&&f.n[l].f&&delete f.n[l].f}f=f.n}}},d.once=function(e,t){var n=function(){return d.unbind(e,n),t.apply(this,arguments)};return d.on(e,n)},d.version=t,d.toString=function(){return"You are running Eve "+t},typeof module!="undefined"&&module.exports?module.exports=d:typeof n=="function"&&n.amd?n("eve",[],function(){return d}):e.eve=d}(this),function(e,r){if(typeof n=="function"&&n.amd)n("../bower_components/Snap.svg/dist/snap.svg",["eve"],function(t){return r(e,t)});else if(typeof exports!="undefined"){var i=t("eve");module.exports=r(e,i)}else r(e,e.eve)}(window||this,function(e,t){var n=function(t){var n={},r=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e){setTimeout(e,16)},i=Array.isArray||function(e){return e instanceof Array||Object.prototype.toString.call(e)=="[object Array]"},s=0,o="M"+(+(new Date)).toString(36),u=function(){return o+(s++).toString(36)},a=function(e,t,n,r){if(i(e)){res=[];for(var s=0,o=e.length;s<o;s++)res[s]=a(e[s],t,n[s],r);return res}var u=(n-e)/(r-t);return function(n){return e+u*(n-t)}},f=Date.now||function(){return+(new Date)},l=function(e){var t=this;if(e==null)return t.s;var n=t.s-e;t.b+=t.dur*n,t.B+=t.dur*n,t.s=e},c=function(e){var t=this;if(e==null)return t.spd;t.spd=e},h=function(e){var t=this;if(e==null)return t.dur;t.s=t.s*e/t.dur,t.dur=e},p=function(){var e=this;delete n[e.id],e.update(),t("mina.stop."+e.id,e)},d=function(){var e=this;if(e.pdif)return;delete n[e.id],e.update(),e.pdif=e.get()-e.b},v=function(){var e=this;if(!e.pdif)return;e.b=e.get()-e.pdif,delete e.pdif,n[e.id]=e},m=function(){var e=this,t;if(i(e.start)){t=[];for(var n=0,r=e.start.length;n<r;n++)t[n]=+e.start[n]+(e.end[n]-e.start[n])*e.easing(e.s)}else t=+e.start+(e.end-e.start)*e.easing(e.s);e.set(t)},g=function(){var e=0;for(var i in n)if(n.hasOwnProperty(i)){var s=n[i],o=s.get(),u;e++,s.s=(o-s.b)/(s.dur/s.spd),s.s>=1&&(delete n[i],s.s=1,e--,function(e){setTimeout(function(){t("mina.finish."+e.id,e)})}(s)),s.update()}e&&r(g)},y=function(e,t,i,s,o,a,f){var b={id:u(),start:e,end:t,b:i,s:0,dur:s-i,spd:1,get:o,set:a,easing:f||y.linear,status:l,speed:c,duration:h,stop:p,pause:d,resume:v,update:m};n[b.id]=b;var w=0,E;for(E in n)if(n.hasOwnProperty(E)){w++;if(w==2)break}return w==1&&r(g),b};return y.time=f,y.getById=function(e){return n[e]||null},y.linear=function(e){return e},y.easeout=function(e){return Math.pow(e,1.7)},y.easein=function(e){return Math.pow(e,.48)},y.easeinout=function(e){if(e==1)return 1;if(e==0)return 0;var t=.48-e/1.04,n=Math.sqrt(.1734+t*t),r=n-t,i=Math.pow(Math.abs(r),1/3)*(r<0?-1:1),s=-n-t,o=Math.pow(Math.abs(s),1/3)*(s<0?-1:1),u=i+o+.5;return(1-u)*3*u*u+u*u*u},y.backin=function(e){if(e==1)return 1;var t=1.70158;return e*e*((t+1)*e-t)},y.backout=function(e){if(e==0)return 0;e-=1;var t=1.70158;return e*e*((t+1)*e+t)+1},y.elastic=function(e){return e==!!e?e:Math.pow(2,-10*e)*Math.sin((e-.075)*2*Math.PI/.3)+1},y.bounce=function(e){var t=7.5625,n=2.75,r;return e<1/n?r=t*e*e:e<2/n?(e-=1.5/n,r=t*e*e+.75):e<2.5/n?(e-=2.25/n,r=t*e*e+.9375):(e-=2.625/n,r=t*e*e+.984375),r},e.mina=y,y}(typeof t=="undefined"?function(){}:t),r=function(e){function n(e,t){if(e){if(e.nodeType)return ht(e);if(I(e,"array")&&n.set)return n.set.apply(n,e);if(e instanceof at)return e;if(t==null)return e=r.doc.querySelector(String(e)),ht(e)}return e=e==null?"100%":e,t=t==null?"100%":t,new ct(e,t)}function j(e,t){if(t){e=="#text"&&(e=r.doc.createTextNode(t.text||t["#text"]||"")),e=="#comment"&&(e=r.doc.createComment(t.text||t["#text"]||"")),typeof e=="string"&&(e=j(e));if(typeof t=="string")return e.nodeType==1?t.substring(0,6)=="xlink:"?e.getAttributeNS(D,t.substring(6)):t.substring(0,4)=="xml:"?e.getAttributeNS(P,t.substring(4)):e.getAttribute(t):t=="text"?e.nodeValue:null;if(e.nodeType==1){for(var n in t)if(t[i](n)){var o=s(t[n]);o?n.substring(0,6)=="xlink:"?e.setAttributeNS(D,n.substring(6),o):n.substring(0,4)=="xml:"?e.setAttributeNS(P,n.substring(4),o):e.setAttribute(n,o):e.removeAttribute(n)}}else"text"in t&&(e.nodeValue=t.text)}else e=r.doc.createElementNS(P,e);return e}function F(e){var t=e.attributes,n,r={};for(var i=0;i<t.length;i++)t[i].namespaceURI==D?n="xlink:":n="",n+=t[i].name,r[n]=t[i].textContent;return r}function I(e,t){return t=s.prototype.toLowerCase.call(t),t=="finite"?isFinite(e):t=="array"&&(e instanceof Array||Array.isArray&&Array.isArray(e))?!0:t=="null"&&e===null||t==typeof e&&e!==null||t=="object"&&e===Object(e)||y.call(e).slice(8,-1).toLowerCase()==t}function q(e){if(typeof e=="function"||Object(e)!==e)return e;var t=new e.constructor;for(var n in e)e[i](n)&&(t[n]=q(e[n]));return t}function R(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return e.push(e.splice(n,1)[0])}function U(e,t,n){function r(){var s=Array.prototype.slice.call(arguments,0),o=s.join("␀"),u=r.cache=r.cache||{},a=r.count=r.count||[];return u[i](o)?(R(a,o),n?n(u[o]):u[o]):(a.length>=1e3&&delete u[a.shift()],a.push(o),u[o]=e.apply(t,s),n?n(u[o]):u[o])}return r}function z(e,t,n,r,i,s){if(i==null){var o=e-n,u=t-r;return!o&&!u?0:(180+a.atan2(-u,-o)*180/p+360)%360}return z(e,t,i,s)-z(n,r,i,s)}function W(e){return e%360*p/180}function X(e){return e*180/p%360}function V(){return this.x+m+this.y}function $(){return this.x+m+this.y+m+this.width+" × "+this.height}function tt(e){var t=[];return e=e.replace(/(?:^|\s)(\w+)\(([^)]+)\)/g,function(e,n,r){return r=r.split(/\s*,\s*|\s+/),n=="rotate"&&r.length==1&&r.push(0,0),n=="scale"&&(r.length>2?r=r.slice(0,2):r.length==2&&r.push(0,0),r.length==1&&r.push(r[0],0,0)),n=="skewX"?t.push(["m",1,0,a.tan(W(r[0])),1,0,0]):n=="skewY"?t.push(["m",1,a.tan(W(r[0])),0,1,0,0]):t.push([n.charAt(0)].concat(r)),e}),t}function nt(e,t){var r=et(e),i=new n.Matrix;if(r)for(var o=0,u=r.length;o<u;o++){var a=r[o],f=a.length,l=s(a[0]).toLowerCase(),c=a[0]!=l,h=c?i.invert():0,p,d,v,m,g;l=="t"&&f==2?i.translate(a[1],0):l=="t"&&f==3?c?(p=h.x(0,0),d=h.y(0,0),v=h.x(a[1],a[2]),m=h.y(a[1],a[2]),i.translate(v-p,m-d)):i.translate(a[1],a[2]):l=="r"?f==2?(g=g||t,i.rotate(a[1],g.x+g.width/2,g.y+g.height/2)):f==4&&(c?(v=h.x(a[2],a[3]),m=h.y(a[2],a[3]),i.rotate(a[1],v,m)):i.rotate(a[1],a[2],a[3])):l=="s"?f==2||f==3?(g=g||t,i.scale(a[1],a[f-1],g.x+g.width/2,g.y+g.height/2)):f==4?c?(v=h.x(a[2],a[3]),m=h.y(a[2],a[3]),i.scale(a[1],a[1],v,m)):i.scale(a[1],a[1],a[2],a[3]):f==5&&(c?(v=h.x(a[3],a[4]),m=h.y(a[3],a[4]),i.scale(a[1],a[2],v,m)):i.scale(a[1],a[2],a[3],a[4])):l=="m"&&f==7&&i.add(a[1],a[2],a[3],a[4],a[5],a[6])}return i}function it(e){var t=e.node.ownerSVGElement&&ht(e.node.ownerSVGElement)||e.node.parentNode&&ht(e.node.parentNode)||n.select("svg")||n(0,0),r=t.select("defs"),i=r==null?!1:r.node;return i||(i=lt("defs",t.node).node),i}function st(e){return e.node.ownerSVGElement&&ht(e.node.ownerSVGElement)||n.select("svg")}function ot(e,t,n){function o(e){if(e==null)return v;if(e==+e)return e;j(s,{width:e});try{return s.getBBox().width}catch(t){return 0}}function u(e){if(e==null)return v;if(e==+e)return e;j(s,{height:e});try{return s.getBBox().height}catch(t){return 0}}function a(r,s){t==null?i[r]=s(e.attr(r)||0):r==t&&(i=s(n==null?e.attr(r)||0:n))}var r=st(e).node,i={},s=r.querySelector(".svg---mgr");s||(s=j("rect"),j(s,{x:-9e9,y:-9e9,width:10,height:10,"class":"svg---mgr",fill:"none"}),r.appendChild(s));switch(e.type){case"rect":a("rx",o),a("ry",u);case"image":a("width",o),a("height",u);case"text":a("x",o),a("y",u);break;case"circle":a("cx",o),a("cy",u),a("r",o);break;case"ellipse":a("cx",o),a("cy",u),a("rx",o),a("ry",u);break;case"line":a("x1",o),a("x2",o),a("y1",u),a("y2",u);break;case"marker":a("refX",o),a("markerWidth",o),a("refY",u),a("markerHeight",u);break;case"radialGradient":a("fx",o),a("fy",u);break;case"tspan":a("dx",o),a("dy",u);break;default:a(t,o)}return r.removeChild(s),i}function ut(e){I(e,"array")||(e=Array.prototype.slice.call(arguments,0));var t=0,n=0,r=this.node;while(this[t])delete this[t++];for(t=0;t<e.length;t++)e[t].type=="set"?e[t].forEach(function(e){r.appendChild(e.node)}):r.appendChild(e[t].node);var i=r.childNodes;for(t=0;t<i.length;t++)this[n++]=ht(i[t]);return this}function at(e){if(e.snap in H)return H[e.snap];var t;try{t=e.ownerSVGElement}catch(n){}this.node=e,t&&(this.paper=new ct(t)),this.type=e.tagName||e.nodeName;var r=this.id=_(this);this.anims={},this._={transform:[]},e.snap=r,H[r]=this,this.type=="g"&&(this.add=ut);if(this.type in{g:1,mask:1,pattern:1,symbol:1})for(var s in ct.prototype)ct.prototype[i](s)&&(this[s]=ct.prototype[s])}function ft(e){this.node=e}function lt(e,t){var n=j(e);t.appendChild(n);var r=ht(n);return r}function ct(e,t){var n,s,o,u=ct.prototype;if(e&&e.tagName=="svg"){if(e.snap in H)return H[e.snap];var a=e.ownerDocument;n=new at(e),s=e.getElementsByTagName("desc")[0],o=e.getElementsByTagName("defs")[0],s||(s=j("desc"),s.appendChild(a.createTextNode("Created with Snap")),n.node.appendChild(s)),o||(o=j("defs"),n.node.appendChild(o)),n.defs=o;for(var f in u)u[i](f)&&(n[f]=u[f]);n.paper=n.root=n}else n=lt("svg",r.doc.body),j(n.node,{height:t,version:1.1,width:e,xmlns:P});return n}function ht(e){return e?e instanceof at||e instanceof ft?e:e.tagName&&e.tagName.toLowerCase()=="svg"?new ct(e):e.tagName&&e.tagName.toLowerCase()=="object"&&e.type=="image/svg+xml"?new ct(e.contentDocument.getElementsByTagName("svg")[0]):new at(e):e}function pt(e,t){for(var n=0,r=e.length;n<r;n++){var i={type:e[n].type,attr:e[n].attr()},s=e[n].children();t.push(i),s.length&&pt(s,i.childNodes=[])}}n.version="0.4.0",n.toString=function(){return"Snap v"+this.version},n._={};var r={win:e.window,doc:e.window.document};n._.glob=r;var i="hasOwnProperty",s=String,o=parseFloat,u=parseInt,a=Math,f=a.max,l=a.min,c=a.abs,h=a.pow,p=a.PI,d=a.round,v="",m=" ",y=Object.prototype.toString,b=/^url\(['"]?([^\)]+?)['"]?\)$/i,w=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?%?)\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?%?)\s*\))\s*$/i,E=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,S=/^url\(#?([^)]+)\)$/,x=n._.separator=/[,\s]+/,T=/[\s]/g,N=/[\s]*,[\s]*/,C={hs:1,rg:1},k=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\s]*,?[\s]*)+)/ig,L=/([rstm])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\s]*,?[\s]*)+)/ig,A=/(-?\d*\.?\d*(?:e[\-+]?\\d+)?)[\s]*,?[\s]*/ig,O=0,M="S"+(+(new Date)).toString(36),_=function(e){return(e&&e.type?e.type:v)+M+(O++).toString(36)},D="http://www.w3.org/1999/xlink",P="http://www.w3.org/2000/svg",H={},B=n.url=function(e){return"url('#"+e+"')"};n._.$=j,n._.id=_,n.format=function(){var e=/\{([^\}]+)\}/g,t=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,n=function(e,n,r){var i=r;return n.replace(t,function(e,t,n,r,s){t=t||r,i&&(t in i&&(i=i[t]),typeof i=="function"&&s&&(i=i()))}),i=(i==null||i==r?e:i)+"",i};return function(t,r){return s(t).replace(e,function(e,t){return n(e,t,r)})}}(),n._.clone=q,n._.cacher=U,n.rad=W,n.deg=X,n.sin=function(e){return a.sin(n.rad(e))},n.tan=function(e){return a.tan(n.rad(e))},n.cos=function(e){return a.cos(n.rad(e))},n.asin=function(e){return n.deg(a.asin(e))},n.acos=function(e){return n.deg(a.acos(e))},n.atan=function(e){return n.deg(a.atan(e))},n.atan2=function(e){return n.deg(a.atan2(e))},n.angle=z,n.len=function(e,t,r,i){return Math.sqrt(n.len2(e,t,r,i))},n.len2=function(e,t,n,r){return(e-n)*(e-n)+(t-r)*(t-r)},n.closestPoint=function(e,t,n){function r(e){var r=e.x-t,i=e.y-n;return r*r+i*i}var i=e.node,s=i.getTotalLength(),o=s/i.pathSegList.numberOfItems*.125,u,a,f=Infinity;for(var l,c=0,h;c<=s;c+=o)(h=r(l=i.getPointAtLength(c)))<f&&(u=l,a=c,f=h);o*=.5;while(o>.5){var p,d,v,m,g,y;(v=a-o)>=0&&(g=r(p=i.getPointAtLength(v)))<f?(u=p,a=v,f=g):(m=a+o)<=s&&(y=r(d=i.getPointAtLength(m)))<f?(u=d,a=m,f=y):o*=.5}return u={x:u.x,y:u.y,length:a,distance:Math.sqrt(f)},u},n.is=I,n.snapTo=function(e,t,n){n=I(n,"finite")?n:10;if(I(e,"array")){var r=e.length;while(r--)if(c(e[r]-t)<=n)return e[r]}else{e=+e;var i=t%e;if(i<n)return t-i;if(i>e-n)return t-i+e}return t},n.getRGB=U(function(e){if(!e||!!((e=s(e)).indexOf("-")+1))return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:G};if(e=="none")return{r:-1,g:-1,b:-1,hex:"none",toString:G};!C[i](e.toLowerCase().substring(0,2))&&e.charAt()!="#"&&(e=J(e));if(!e)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:G};var t,r,c,h,p,d,v,m=e.match(w);return m?(m[2]&&(h=u(m[2].substring(5),16),c=u(m[2].substring(3,5),16),r=u(m[2].substring(1,3),16)),m[3]&&(h=u((d=m[3].charAt(3))+d,16),c=u((d=m[3].charAt(2))+d,16),r=u((d=m[3].charAt(1))+d,16)),m[4]&&(v=m[4].split(N),r=o(v[0]),v[0].slice(-1)=="%"&&(r*=2.55),c=o(v[1]),v[1].slice(-1)=="%"&&(c*=2.55),h=o(v[2]),v[2].slice(-1)=="%"&&(h*=2.55),m[1].toLowerCase().slice(0,4)=="rgba"&&(p=o(v[3])),v[3]&&v[3].slice(-1)=="%"&&(p/=100)),m[5]?(v=m[5].split(N),r=o(v[0]),v[0].slice(-1)=="%"&&(r/=100),c=o(v[1]),v[1].slice(-1)=="%"&&(c/=100),h=o(v[2]),v[2].slice(-1)=="%"&&(h/=100),(v[0].slice(-3)=="deg"||v[0].slice(-1)=="°")&&(r/=360),m[1].toLowerCase().slice(0,4)=="hsba"&&(p=o(v[3])),v[3]&&v[3].slice(-1)=="%"&&(p/=100),n.hsb2rgb(r,c,h,p)):m[6]?(v=m[6].split(N),r=o(v[0]),v[0].slice(-1)=="%"&&(r/=100),c=o(v[1]),v[1].slice(-1)=="%"&&(c/=100),h=o(v[2]),v[2].slice(-1)=="%"&&(h/=100),(v[0].slice(-3)=="deg"||v[0].slice(-1)=="°")&&(r/=360),m[1].toLowerCase().slice(0,4)=="hsla"&&(p=o(v[3])),v[3]&&v[3].slice(-1)=="%"&&(p/=100),n.hsl2rgb(r,c,h,p)):(r=l(a.round(r),255),c=l(a.round(c),255),h=l(a.round(h),255),p=l(f(p,0),1),m={r:r,g:c,b:h,toString:G},m.hex="#"+(16777216|h|c<<8|r<<16).toString(16).slice(1),m.opacity=I(p,"finite")?p:1,m)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:G}},n),n.hsb=U(function(e,t,r){return n.hsb2rgb(e,t,r).hex}),n.hsl=U(function(e,t,r){return n.hsl2rgb(e,t,r).hex}),n.rgb=U(function(e,t,n,r){if(I(r,"finite")){var i=a.round;return"rgba("+[i(e),i(t),i(n),+r.toFixed(2)]+")"}return"#"+(16777216|n|t<<8|e<<16).toString(16).slice(1)});var J=function(e){var t=r.doc.getElementsByTagName("head")[0]||r.doc.getElementsByTagName("svg")[0],n="rgb(255, 0, 0)";return J=U(function(e){if(e.toLowerCase()=="red")return n;t.style.color=n,t.style.color=e;var i=r.doc.defaultView.getComputedStyle(t,v).getPropertyValue("color");return i==n?null:i}),J(e)},K=function(){return"hsb("+[this.h,this.s,this.b]+")"},Q=function(){return"hsl("+[this.h,this.s,this.l]+")"},G=function(){return this.opacity==1||this.opacity==null?this.hex:"rgba("+[this.r,this.g,this.b,this.opacity]+")"},Y=function(e,t,r){t==null&&I(e,"object")&&"r"in e&&"g"in e&&"b"in e&&(r=e.b,t=e.g,e=e.r);if(t==null&&I(e,string)){var i=n.getRGB(e);e=i.r,t=i.g,r=i.b}if(e>1||t>1||r>1)e/=255,t/=255,r/=255;return[e,t,r]},Z=function(e,t,r,i){e=a.round(e*255),t=a.round(t*255),r=a.round(r*255);var s={r:e,g:t,b:r,opacity:I(i,"finite")?i:1,hex:n.rgb(e,t,r),toString:G};return I(i,"finite")&&(s.opacity=i),s};n.color=function(e){var t;return I(e,"object")&&"h"in e&&"s"in e&&"b"in e?(t=n.hsb2rgb(e),e.r=t.r,e.g=t.g,e.b=t.b,e.opacity=1,e.hex=t.hex):I(e,"object")&&"h"in e&&"s"in e&&"l"in e?(t=n.hsl2rgb(e),e.r=t.r,e.g=t.g,e.b=t.b,e.opacity=1,e.hex=t.hex):(I(e,"string")&&(e=n.getRGB(e)),I(e,"object")&&"r"in e&&"g"in e&&"b"in e&&!("error"in e)?(t=n.rgb2hsl(e),e.h=t.h,e.s=t.s,e.l=t.l,t=n.rgb2hsb(e),e.v=t.b):(e={hex:"none"},e.r=e.g=e.b=e.h=e.s=e.v=e.l=-1,e.error=1)),e.toString=G,e},n.hsb2rgb=function(e,t,n,r){I(e,"object")&&"h"in e&&"s"in e&&"b"in e&&(n=e.b,t=e.s,r=e.o,e=e.h),e*=360;var i,s,o,u,a;return e=e%360/60,a=n*t,u=a*(1-c(e%2-1)),i=s=o=n-a,e=~~e,i+=[a,u,0,0,u,a][e],s+=[u,a,a,u,0,0][e],o+=[0,0,u,a,a,u][e],Z(i,s,o,r)},n.hsl2rgb=function(e,t,n,r){I(e,"object")&&"h"in e&&"s"in e&&"l"in e&&(n=e.l,t=e.s,e=e.h);if(e>1||t>1||n>1)e/=360,t/=100,n/=100;e*=360;var i,s,o,u,a;return e=e%360/60,a=2*t*(n<.5?n:1-n),u=a*(1-c(e%2-1)),i=s=o=n-a/2,e=~~e,i+=[a,u,0,0,u,a][e],s+=[u,a,a,u,0,0][e],o+=[0,0,u,a,a,u][e],Z(i,s,o,r)},n.rgb2hsb=function(e,t,n){n=Y(e,t,n),e=n[0],t=n[1],n=n[2];var r,i,s,o;return s=f(e,t,n),o=s-l(e,t,n),r=o==0?null:s==e?(t-n)/o:s==t?(n-e)/o+2:(e-t)/o+4,r=(r+360)%6*60/360,i=o==0?0:o/s,{h:r,s:i,b:s,toString:K}},n.rgb2hsl=function(e,t,n){n=Y(e,t,n),e=n[0],t=n[1],n=n[2];var r,i,s,o,u,a;return o=f(e,t,n),u=l(e,t,n),a=o-u,r=a==0?null:o==e?(t-n)/a:o==t?(n-e)/a+2:(e-t)/a+4,r=(r+360)%6*60/360,s=(o+u)/2,i=a==0?0:s<.5?a/(2*s):a/(2-2*s),{h:r,s:i,l:s,toString:Q}},n.parsePathString=function(e){if(!e)return null;var t=n.path(e);if(t.arr)return n.path.clone(t.arr);var r={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},i=[];return I(e,"array")&&I(e[0],"array")&&(i=n.path.clone(e)),i.length||s(e).replace(k,function(e,t,n){var s=[],o=t.toLowerCase();n.replace(A,function(e,t){t&&s.push(+t)}),o=="m"&&s.length>2&&(i.push([t].concat(s.splice(0,2))),o="l",t=t=="m"?"l":"L"),o=="o"&&s.length==1&&i.push([t,s[0]]);if(o=="r")i.push([t].concat(s));else while(s.length>=r[o]){i.push([t].concat(s.splice(0,r[o])));if(!r[o])break}}),i.toString=n.path.toString,t.arr=n.path.clone(i),i};var et=n.parseTransformString=function(e){if(!e)return null;var t={r:3,s:4,t:2,m:6},r=[];return I(e,"array")&&I(e[0],"array")&&(r=n.path.clone(e)),r.length||s(e).replace(L,function(e,t,n){var i=[],s=t.toLowerCase();n.replace(A,function(e,t){t&&i.push(+t)}),r.push([t].concat(i))}),r.toString=n.path.toString,r};n._.svgTransform2string=tt,n._.rgTransform=/^[a-z][\s]*-?\.?\d/i,n._.transform2matrix=nt,n._unit2px=ot;var rt=r.doc.contains||r.doc.compareDocumentPosition?function(e,t){var n=e.nodeType==9?e.documentElement:e,r=t&&t.parentNode;return e==r||!!r&&r.nodeType==1&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&e.compareDocumentPosition(r)&16)}:function(e,t){if(t)while(t){t=t.parentNode;if(t==e)return!0}return!1};n._.getSomeDefs=it,n._.getSomeSVG=st,n.select=function(e){return e=s(e).replace(/([^\\]):/g,"$1\\:"),ht(r.doc.querySelector(e))},n.selectAll=function(e){var t=r.doc.querySelectorAll(e),i=(n.set||Array)();for(var s=0;s<t.length;s++)i.push(ht(t[s]));return i},setInterval(function(){for(var e in H)if(H[i](e)){var t=H[e],n=t.node;(t.type!="svg"&&!n.ownerSVGElement||t.type=="svg"&&(!n.parentNode||"ownerSVGElement"in n.parentNode&&!n.ownerSVGElement))&&delete H[e]}},1e4),at.prototype.attr=function(e,n){var r=this,s=r.node;if(!e){if(s.nodeType!=1)return{text:s.nodeValue};var o=s.attributes,u={};for(var a=0,f=o.length;a<f;a++)u[o[a].nodeName]=o[a].nodeValue;return u}if(I(e,"string")){if(!(arguments.length>1))return t("snap.util.getattr."+e,r).firstDefined();var l={};l[e]=n,e=l}for(var c in e)e[i](c)&&t("snap.util.attr."+c,r,e[c]);return r},n.parse=function(e){var t=r.doc.createDocumentFragment(),n=!0,i=r.doc.createElement("div");e=s(e),e.match(/^\s*<\s*svg(?:\s|>)/)||(e="<svg>"+e+"</svg>",n=!1),i.innerHTML=e,e=i.getElementsByTagName("svg")[0];if(e)if(n)t=e;else while(e.firstChild)t.appendChild(e.firstChild);return new ft(t)},n.fragment=function(){var e=Array.prototype.slice.call(arguments,0),t=r.doc.createDocumentFragment();for(var i=0,s=e.length;i<s;i++){var o=e[i];o.node&&o.node.nodeType&&t.appendChild(o.node),o.nodeType&&t.appendChild(o),typeof o=="string"&&t.appendChild(n.parse(o).node)}return new ft(t)},n._.make=lt,n._.wrap=ht,ct.prototype.el=function(e,t){var n=lt(e,this.node);return t&&n.attr(t),n},at.prototype.children=function(){var e=[],t=this.node.childNodes;for(var r=0,i=t.length;r<i;r++)e[r]=n(t[r]);return e},at.prototype.toJSON=function(){var e=[];return pt([this],e),e[0]},t.on("snap.util.getattr",function(){var e=t.nt();e=e.substring(e.lastIndexOf(".")+1);var n=e.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()});return dt[i](n)?this.node.ownerDocument.defaultView.getComputedStyle(this.node,null).getPropertyValue(n):j(this.node,e)});var dt={"alignment-baseline":0,"baseline-shift":0,clip:0,"clip-path":0,"clip-rule":0,color:0,"color-interpolation":0,"color-interpolation-filters":0,"color-profile":0,"color-rendering":0,cursor:0,direction:0,display:0,"dominant-baseline":0,"enable-background":0,fill:0,"fill-opacity":0,"fill-rule":0,filter:0,"flood-color":0,"flood-opacity":0,font:0,"font-family":0,"font-size":0,"font-size-adjust":0,"font-stretch":0,"font-style":0,"font-variant":0,"font-weight":0,"glyph-orientation-horizontal":0,"glyph-orientation-vertical":0,"image-rendering":0,kerning:0,"letter-spacing":0,"lighting-color":0,marker:0,"marker-end":0,"marker-mid":0,"marker-start":0,mask:0,opacity:0,overflow:0,"pointer-events":0,"shape-rendering":0,"stop-color":0,"stop-opacity":0,stroke:0,"stroke-dasharray":0,"stroke-dashoffset":0,"stroke-linecap":0,"stroke-linejoin":0,"stroke-miterlimit":0,"stroke-opacity":0,"stroke-width":0,"text-anchor":0,"text-decoration":0,"text-rendering":0,"unicode-bidi":0,visibility:0,"word-spacing":0,"writing-mode":0};t.on("snap.util.attr",function(e){var n=t.nt(),r={};n=n.substring(n.lastIndexOf(".")+1),r[n]=e;var s=n.replace(/-(\w)/gi,function(e,t){return t.toUpperCase()}),o=n.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()});dt[i](o)?this.node.style[s]=e==null?v:e:j(this.node,r)}),function(e){}(ct.prototype),n.ajax=function(e,n,r,i){var s=new XMLHttpRequest,o=_();if(s){if(I(n,"function"))i=r,r=n,n=null;else if(I(n,"object")){var u=[];for(var a in n)n.hasOwnProperty(a)&&u.push(encodeURIComponent(a)+"="+encodeURIComponent(n[a]));n=u.join("&")}return s.open(n?"POST":"GET",e,!0),n&&(s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.setRequestHeader("Content-type","application/x-www-form-urlencoded")),r&&(t.once("snap.ajax."+o+".0",r),t.once("snap.ajax."+o+".200",r),t.once("snap.ajax."+o+".304",r)),s.onreadystatechange=function(){if(s.readyState!=4)return;t("snap.ajax."+o+"."+s.status,i,s)},s.readyState==4?s:(s.send(n),s)}},n.load=function(e,t,r){n.ajax(e,function(e){var i=n.parse(e.responseText);r?t.call(r,i):t(i)})};var vt=function(e){var t=e.getBoundingClientRect(),n=e.ownerDocument,r=n.body,i=n.documentElement,s=i.clientTop||r.clientTop||0,o=i.clientLeft||r.clientLeft||0,u=t.top+(g.win.pageYOffset||i.scrollTop||r.scrollTop)-s,a=t.left+(g.win.pageXOffset||i.scrollLeft||r.scrollLeft)-o;return{y:u,x:a}};return n.getElementByPoint=function(e,t){var n=this,i=n.canvas,s=r.doc.elementFromPoint(e,t);if(r.win.opera&&s.tagName=="svg"){var o=vt(s),u=s.createSVGRect();u.x=e-o.x,u.y=t-o.y,u.width=u.height=1;var a=s.getIntersectionList(u,null);a.length&&(s=a[a.length-1])}return s?ht(s):null},n.plugin=function(e){e(n,at,ct,r,ft)},r.win.Snap=n,n}(e||this);return r.plugin(function(r,i,s,o,u){function y(e,t){if(t==null){var n=!0;e.type=="linearGradient"||e.type=="radialGradient"?t=e.node.getAttribute("gradientTransform"):e.type=="pattern"?t=e.node.getAttribute("patternTransform"):t=e.node.getAttribute("transform");if(!t)return new r.Matrix;t=r._.svgTransform2string(t)}else r._.rgTransform.test(t)?t=l(t).replace(/\.{3}|\u2026/g,e._.transform||""):t=r._.svgTransform2string(t),f(t,"array")&&(t=r.path?r.path.toString.call(t):l(t)),e._.transform=t;var i=r._.transform2matrix(t,e.getBBox(1));if(n)return i;e.matrix=i}function b(e){function o(e,t){var n=h(e.node,t);n=n&&n.match(r),n=n&&n[2];if(!n||n.charAt()!="#")return;n=n.substring(1),n&&(s[n]=(s[n]||[]).concat(function(n){var r={};r[t]=URL(n),h(e.node,r)}))}function u(e){var t=h(e.node,"xlink:href");if(!t||t.charAt()!="#")return;t=t.substring(1),t&&(s[t]=(s[t]||[]).concat(function(t){e.attr("xlink:href","#"+t)}))}var t=e.selectAll("*"),n,r=/^\s*url\(("|'|)(.*)\1\)\s*$/,i=[],s={};for(var a=0,f=t.length;a<f;a++){n=t[a],o(n,"fill"),o(n,"stroke"),o(n,"filter"),o(n,"mask"),o(n,"clip-path"),u(n);var l=h(n.node,"id");l&&(h(n.node,{id:n.id}),i.push({old:l,id:n.id}))}for(a=0,f=i.length;a<f;a++){var c=s[i[a].old];if(c)for(var p=0,d=c.length;p<d;p++)c[p](i[a].id)}}function w(e,t,n){return function(r){var i=r.slice(e,t);return i.length==1&&(i=i[0]),n?n(i):i}}function x(e){return function(){var t=e?"<"+this.type:"",n=this.node.attributes,r=this.node.childNodes;if(e)for(var i=0,s=n.length;i<s;i++)t+=" "+n[i].name+'="'+n[i].value.replace(/"/g,'\\"')+'"';if(r.length){e&&(t+=">");for(i=0,s=r.length;i<s;i++)r[i].nodeType==3?t+=r[i].nodeValue:r[i].nodeType==1&&(t+=m(r[i]).toString());e&&(t+="</"+this.type+">")}else e&&(t+="/>");return t}}var a=i.prototype,f=r.is,l=String,c=r._unit2px,h=r._.$,p=r._.make,d=r._.getSomeDefs,v="hasOwnProperty",m=r._.wrap;a.getBBox=function(e){if(!r.Matrix||!r.path)return this.node.getBBox();var t=this,n=new r.Matrix;if(t.removed)return r._.box();while(t.type=="use"){e||(n=n.add(t.transform().localMatrix.translate(t.attr("x")||0,t.attr("y")||0)));if(t.original)t=t.original;else{var i=t.attr("xlink:href");t=t.original=t.node.ownerDocument.getElementById(i.substring(i.indexOf("#")+1))}}var s=t._,o=r.path.get[t.type]||r.path.get.deflt;try{return e?(s.bboxwt=o?r.path.getBBox(t.realPath=o(t)):r._.box(t.node.getBBox()),r._.box(s.bboxwt)):(t.realPath=o(t),t.matrix=t.transform().localMatrix,s.bbox=r.path.getBBox(r.path.map(t.realPath,n.add(t.matrix))),r._.box(s.bbox))}catch(u){return r._.box()}};var g=function(){return this.string};a.transform=function(e){var t=this._;if(e==null){var n=this,i=new r.Matrix(this.node.getCTM()),s=y(this),o=[s],u=new r.Matrix,a,f=s.toTransformString(),c=l(s)==l(this.matrix)?l(t.transform):f;while(n.type!="svg"&&(n=n.parent()))o.push(y(n));a=o.length;while(a--)u.add(o[a]);return{string:c,globalMatrix:i,totalMatrix:u,localMatrix:s,diffMatrix:i.clone().add(s.invert()),global:i.toTransformString(),total:u.toTransformString(),local:f,toString:g}}return e instanceof r.Matrix?(this.matrix=e,this._.transform=e.toTransformString()):y(this,e),this.node&&(this.type=="linearGradient"||this.type=="radialGradient"?h(this.node,{gradientTransform:this.matrix}):this.type=="pattern"?h(this.node,{patternTransform:this.matrix}):h(this.node,{transform:this.matrix})),this},a.parent=function(){return m(this.node.parentNode)},a.append=a.add=function(e){if(e){if(e.type=="set"){var t=this;return e.forEach(function(e){t.add(e)}),this}e=m(e),this.node.appendChild(e.node),e.paper=this.paper}return this},a.appendTo=function(e){return e&&(e=m(e),e.append(this)),this},a.prepend=function(e){if(e){if(e.type=="set"){var t=this,n;return e.forEach(function(e){n?n.after(e):t.prepend(e),n=e}),this}e=m(e);var r=e.parent();this.node.insertBefore(e.node,this.node.firstChild),this.add&&this.add(),e.paper=this.paper,this.parent()&&this.parent().add(),r&&r.add()}return this},a.prependTo=function(e){return e=m(e),e.prepend(this),this},a.before=function(e){if(e.type=="set"){var t=this;return e.forEach(function(e){var n=e.parent();t.node.parentNode.insertBefore(e.node,t.node),n&&n.add()}),this.parent().add(),this}e=m(e);var n=e.parent();return this.node.parentNode.insertBefore(e.node,this.node),this.parent()&&this.parent().add(),n&&n.add(),e.paper=this.paper,this},a.after=function(e){e=m(e);var t=e.parent();return this.node.nextSibling?this.node.parentNode.insertBefore(e.node,this.node.nextSibling):this.node.parentNode.appendChild(e.node),this.parent()&&this.parent().add(),t&&t.add(),e.paper=this.paper,this},a.insertBefore=function(e){e=m(e);var t=this.parent();return e.node.parentNode.insertBefore(this.node,e.node),this.paper=e.paper,t&&t.add(),e.parent()&&e.parent().add(),this},a.insertAfter=function(e){e=m(e);var t=this.parent();return e.node.parentNode.insertBefore(this.node,e.node.nextSibling),this.paper=e.paper,t&&t.add(),e.parent()&&e.parent().add(),this},a.remove=function(){var e=this.parent();return this.node.parentNode&&this.node.parentNode.removeChild(this.node),delete this.paper,this.removed=!0,e&&e.add(),this},a.select=function(e){return m(this.node.querySelector(e))},a.selectAll=function(e){var t=this.node.querySelectorAll(e),n=(r.set||Array)();for(var i=0;i<t.length;i++)n.push(m(t[i]));return n},a.asPX=function(e,t){return t==null&&(t=this.attr(e)),+c(this,e,t)},a.use=function(){var e,t=this.node.id;return t||(t=this.id,h(this.node,{id:t})),this.type=="linearGradient"||this.type=="radialGradient"||this.type=="pattern"?e=p(this.type,this.node.parentNode):e=p("use",this.node.parentNode),h(e.node,{"xlink:href":"#"+t}),e.original=this,e},a.clone=function(){var e=m(this.node.cloneNode(!0));return h(e.node,"id")&&h(e.node,{id:e.id}),b(e),e.insertAfter(this),e},a.toDefs=function(){var e=d(this);return e.appendChild(this.node),this},a.pattern=a.toPattern=function(e,t,n,r){var i=p("pattern",d(this));return e==null&&(e=this.getBBox()),f(e,"object")&&"x"in e&&(t=e.y,n=e.width,r=e.height,e=e.x),h(i.node,{x:e,y:t,width:n,height:r,patternUnits:"userSpaceOnUse",id:i.id,viewBox:[e,t,n,r].join(" ")}),i.node.appendChild(this.node),i},a.marker=function(e,t,n,r,i,s){var o=p("marker",d(this));return e==null&&(e=this.getBBox()),f(e,"object")&&"x"in e&&(t=e.y,n=e.width,r=e.height,i=e.refX||e.cx,s=e.refY||e.cy,e=e.x),h(o.node,{viewBox:[e,t,n,r].join(" "),markerWidth:n,markerHeight:r,orient:"auto",refX:i||0,refY:s||0,id:o.id}),o.node.appendChild(this.node),o};var E=function(e,t,r,i){typeof r=="function"&&!r.length&&(i=r,r=n.linear),this.attr=e,this.dur=t,r&&(this.easing=r),i&&(this.callback=i)};r._.Animation=E,r.animation=function(e,t,n,r){return new E(e,t,n,r)},a.inAnim=function(){var e=this,t=[];for(var n in e.anims)e.anims[v](n)&&function(e){t.push({anim:new E(e._attrs,e.dur,e.easing,e._callback),mina:e,curStatus:e.status(),status:function(t){return e.status(t)},stop:function(){e.stop()}})}(e.anims[n]);return t},r.animate=function(e,r,i,s,o,u){typeof o=="function"&&!o.length&&(u=o,o=n.linear);var a=n.time(),f=n(e,r,a,a+s,n.time,i,o);return u&&t.once("mina.finish."+f.id,u),f},a.stop=function(){var e=this.inAnim();for(var t=0,n=e.length;t<n;t++)e[t].stop();return this},a.animate=function(e,r,i,s){typeof i=="function"&&!i.length&&(s=i,i=n.linear),e instanceof E&&(s=e.callback,i=e.easing,r=e.dur,e=e.attr);var o=[],u=[],a={},c,h,p,d,m=this;for(var g in e)if(e[v](g)){m.equal?(d=m.equal(g,l(e[g])),c=d.from,h=d.to,p=d.f):(c=+m.attr(g),h=+e[g]);var y=f(c,"array")?c.length:1;a[g]=w(o.length,o.length+y,p),o=o.concat(c),u=u.concat(h)}var b=n.time(),S=n(o,u,b,b+r,n.time,function(e){var t={};for(var n in a)a[v](n)&&(t[n]=a[n](e));m.attr(t)},i);return m.anims[S.id]=S,S._attrs=e,S._callback=s,t("snap.animcreated."+m.id,S),t.once("mina.finish."+S.id,function(){delete m.anims[S.id],s&&s.call(m)}),t.once("mina.stop."+S.id,function(){delete m.anims[S.id]}),m};var S={};a.data=function(e,n){var i=S[this.id]=S[this.id]||{};if(arguments.length==0)return t("snap.data.get."+this.id,this,i,null),i;if(arguments.length==1){if(r.is(e,"object")){for(var s in e)e[v](s)&&this.data(s,e[s]);return this}return t("snap.data.get."+this.id,this,i[e],e),i[e]}return i[e]=n,t("snap.data.set."+this.id,this,n,e),this},a.removeData=function(e){return e==null?S[this.id]={}:S[this.id]&&delete S[this.id][e],this},a.outerSVG=a.toString=x(1),a.innerSVG=x(),a.toDataURL=function(){if(e&&e.btoa){var t=this.getBBox(),n=r.format('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="{width}" height="{height}" viewBox="{x} {y} {width} {height}">{contents}</svg>',{x:+t.x.toFixed(3),y:+t.y.toFixed(3),width:+t.width.toFixed(3),height:+t.height.toFixed(3),contents:this.outerSVG()});return"data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(n)))}},u.prototype.select=a.select,u.prototype.selectAll=a.selectAll}),r.plugin(function(e,t,n,r,i){function f(e,t,n,r,i,o){if(t==null&&s.call(e)=="[object SVGMatrix]"){this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.e=e.e,this.f=e.f;return}e!=null?(this.a=+e,this.b=+t,this.c=+n,this.d=+r,this.e=+i,this.f=+o):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}var s=Object.prototype.toString,o=String,u=Math,a="";(function(t){function n(e){return e[0]*e[0]+e[1]*e[1]}function r(e){var t=u.sqrt(n(e));e[0]&&(e[0]/=t),e[1]&&(e[1]/=t)}t.add=function(e,t,n,r,i,s){var o=[[],[],[]],u=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],a=[[e,n,i],[t,r,s],[0,0,1]],l,c,h,p;e&&e instanceof f&&(a=[[e.a,e.c,e.e],[e.b,e.d,e.f],[0,0,1]]);for(l=0;l<3;l++)for(c=0;c<3;c++){p=0;for(h=0;h<3;h++)p+=u[l][h]*a[h][c];o[l][c]=p}return this.a=o[0][0],this.b=o[1][0],this.c=o[0][1],this.d=o[1][1],this.e=o[0][2],this.f=o[1][2],this},t.invert=function(){var e=this,t=e.a*e.d-e.b*e.c;return new f(e.d/t,-e.b/t,-e.c/t,e.a/t,(e.c*e.f-e.d*e.e)/t,(e.b*e.e-e.a*e.f)/t)},t.clone=function(){return new f(this.a,this.b,this.c,this.d,this.e,this.f)},t.translate=function(e,t){return this.add(1,0,0,1,e,t)},t.scale=function(e,t,n,r){return t==null&&(t=e),(n||r)&&this.add(1,0,0,1,n,r),this.add(e,0,0,t,0,0),(n||r)&&this.add(1,0,0,1,-n,-r),this},t.rotate=function(t,n,r){t=e.rad(t),n=n||0,r=r||0;var i=+u.cos(t).toFixed(9),s=+u.sin(t).toFixed(9);return this.add(i,s,-s,i,n,r),this.add(1,0,0,1,-n,-r)},t.x=function(e,t){return e*this.a+t*this.c+this.e},t.y=function(e,t){return e*this.b+t*this.d+this.f},t.get=function(e){return+this[o.fromCharCode(97+e)].toFixed(4)},t.toString=function(){return"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")"},t.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},t.determinant=function(){return this.a*this.d-this.b*this.c},t.split=function(){var t={};t.dx=this.e,t.dy=this.f;var i=[[this.a,this.c],[this.b,this.d]];t.scalex=u.sqrt(n(i[0])),r(i[0]),t.shear=i[0][0]*i[1][0]+i[0][1]*i[1][1],i[1]=[i[1][0]-i[0][0]*t.shear,i[1][1]-i[0][1]*t.shear],t.scaley=u.sqrt(n(i[1])),r(i[1]),t.shear/=t.scaley,this.determinant()<0&&(t.scalex=-t.scalex);var s=-i[0][1],o=i[1][1];return o<0?(t.rotate=e.deg(u.acos(o)),s<0&&(t.rotate=360-t.rotate)):t.rotate=e.deg(u.asin(s)),t.isSimple=!+t.shear.toFixed(9)&&(t.scalex.toFixed(9)==t.scaley.toFixed(9)||!t.rotate),t.isSuperSimple=!+t.shear.toFixed(9)&&t.scalex.toFixed(9)==t.scaley.toFixed(9)&&!t.rotate,t.noRotation=!+t.shear.toFixed(9)&&!t.rotate,t},t.toTransformString=function(e){var t=e||this.split();return+t.shear.toFixed(9)?"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]:(t.scalex=+t.scalex.toFixed(4),t.scaley=+t.scaley.toFixed(4),t.rotate=+t.rotate.toFixed(4),(t.dx||t.dy?"t"+[+t.dx.toFixed(4),+t.dy.toFixed(4)]:a)+(t.scalex!=1||t.scaley!=1?"s"+[t.scalex,t.scaley,0,0]:a)+(t.rotate?"r"+[+t.rotate.toFixed(4),0,0]:a))}})(f.prototype),e.Matrix=f,e.matrix=function(e,t,n,r,i,s){return new f(e,t,n,r,i,s)}}),r.plugin(function(e,n,r,i,s){function g(r){return function(i){t.stop(),i instanceof s&&i.node.childNodes.length==1&&(i.node.firstChild.tagName=="radialGradient"||i.node.firstChild.tagName=="linearGradient"||i.node.firstChild.tagName=="pattern")&&(i=i.node.firstChild,l(this).appendChild(i),i=a(i));if(i instanceof n)if(i.type=="radialGradient"||i.type=="linearGradient"||i.type=="pattern"){i.node.id||h(i.node,{id:i.id});var o=p(i.node.id)}else o=i.attr(r);else{o=e.color(i);if(o.error){var u=e(l(this).ownerSVGElement).gradient(i);u?(u.node.id||h(u.node,{id:u.id}),o=p(u.node.id)):o=i}else o=d(o)}var f={};f[r]=o,h(this.node,f),this.node.style[r]=m}}function b(e){t.stop(),e==+e&&(e+="px"),this.node.style.fontSize=e}function w(e){var t=[],n=e.childNodes;for(var r=0,i=n.length;r<i;r++){var s=n[r];s.nodeType==3&&t.push(s.nodeValue),s.tagName=="tspan"&&(s.childNodes.length==1&&s.firstChild.nodeType==3?t.push(s.firstChild.nodeValue):t.push(w(s)))}return t}function E(){return t.stop(),this.node.style.fontSize}var o="hasOwnProperty",u=e._.make,a=e._.wrap,f=e.is,l=e._.getSomeDefs,c=/^url\(#?([^)]+)\)$/,h=e._.$,p=e.url,d=String,v=e._.separator,m="";t.on("snap.util.attr.mask",function(e){if(e instanceof n||e instanceof s){t.stop(),e instanceof s&&e.node.childNodes.length==1&&(e=e.node.firstChild,l(this).appendChild(e),e=a(e));if(e.type=="mask")var r=e;else r=u("mask",l(this)),r.node.appendChild(e.node);!r.node.id&&h(r.node,{id:r.id}),h(this.node,{mask:p(r.id)})}}),function(e){t.on("snap.util.attr.clip",e),t.on("snap.util.attr.clip-path",e),t.on("snap.util.attr.clipPath",e)}(function(e){if(e instanceof n||e instanceof s){t.stop();if(e.type=="clipPath")var r=e;else r=u("clipPath",l(this)),r.node.appendChild(e.node),!r.node.id&&h(r.node,{id:r.id});h(this.node,{"clip-path":p(r.node.id||r.id)})}}),t.on("snap.util.attr.fill",g("fill")),t.on("snap.util.attr.stroke",g("stroke"));var y=/^([lr])(?:\(([^)]*)\))?(.*)$/i;t.on("snap.util.grad.parse",function(t){t=d(t);var n=t.match(y);if(!n)return null;var r=n[1],i=n[2],s=n[3];return i=i.split(/\s*,\s*/).map(function(e){return+e==e?+e:e}),i.length==1&&i[0]==0&&(i=[]),s=s.split("-"),s=s.map(function(e){e=e.split(":");var t={color:e[0]};return e[1]&&(t.offset=parseFloat(e[1])),t}),{type:r,params:i,stops:s}}),t.on("snap.util.attr.d",function(n){t.stop(),f(n,"array")&&f(n[0],"array")&&(n=e.path.toString.call(n)),n=d(n),n.match(/[ruo]/i)&&(n=e.path.toAbsolute(n)),h(this.node,{d:n})})(-1),t.on("snap.util.attr.#text",function(e){t.stop(),e=d(e);var n=i.doc.createTextNode(e);while(this.node.firstChild)this.node.removeChild(this.node.firstChild);this.node.appendChild(n)})(-1),t.on("snap.util.attr.path",function(e){t.stop(),this.attr({d:e})})(-1),t.on("snap.util.attr.class",function(e){t.stop(),this.node.className.baseVal=e})(-1),t.on("snap.util.attr.viewBox",function(e){var n;f(e,"object")&&"x"in e?n=[e.x,e.y,e.width,e.height].join(" "):f(e,"array")?n=e.join(" "):n=e,h(this.node,{viewBox:n}),t.stop()})(-1),t.on("snap.util.attr.transform",function(e){this.transform(e),t.stop()})(-1),t.on("snap.util.attr.r",function(e){this.type=="rect"&&(t.stop(),h(this.node,{rx:e,ry:e}))})(-1),t.on("snap.util.attr.textpath",function(e){t.stop();if(this.type=="text"){var r,i,s;if(!e&&this.textPath){i=this.textPath;while(i.node.firstChild)this.node.appendChild(i.node.firstChild);i.remove(),delete this.textPath;return}if(f(e,"string")){var o=l(this),u=a(o.parentNode).path(e);o.appendChild(u.node),r=u.id,u.attr({id:r})}else e=a(e),e instanceof n&&(r=e.attr("id"),r||(r=e.id,e.attr({id:r})));if(r){i=this.textPath,s=this.node;if(i)i.attr({"xlink:href":"#"+r});else{i=h("textPath",{"xlink:href":"#"+r});while(s.firstChild)i.appendChild(s.firstChild);s.appendChild(i),this.textPath=a(i)}}}})(-1),t.on("snap.util.attr.text",function(e){if(this.type=="text"){var n=0,r=this.node,s=function(e){var t=h("tspan");if(f(e,"array"))for(var n=0;n<e.length;n++)t.appendChild(s(e[n]));else t.appendChild(i.doc.createTextNode(e));return t.normalize&&t.normalize(),t};while(r.firstChild)r.removeChild(r.firstChild);var o=s(e);while(o.firstChild)r.appendChild(o.firstChild)}t.stop()})(-1),t.on("snap.util.attr.fontSize",b)(-1),t.on("snap.util.attr.font-size",b)(-1),t.on("snap.util.getattr.transform",function(){return t.stop(),this.transform()})(-1),t.on("snap.util.getattr.textpath",function(){return t.stop(),this.textPath})(-1),function(){function n(n){return function(){t.stop();var r=i.doc.defaultView.getComputedStyle(this.node,null).getPropertyValue("marker-"+n);return r=="none"?r:e(i.doc.getElementById(r.match(c)[1]))}}function r(e){return function(n){t.stop();var r="marker"+e.charAt(0).toUpperCase()+e.substring(1);if(n==""||!n){this.node.style[r]="none";return}if(n.type=="marker"){var i=n.node.id;i||h(n.node,{id:n.id}),this.node.style[r]=p(i);return}}}t.on("snap.util.getattr.marker-end",n("end"))(-1),t.on("snap.util.getattr.markerEnd",n("end"))(-1),t.on("snap.util.getattr.marker-start",n("start"))(-1),t.on("snap.util.getattr.markerStart",n("start"))(-1),t.on("snap.util.getattr.marker-mid",n("mid"))(-1),t.on("snap.util.getattr.markerMid",n("mid"))(-1),t.on("snap.util.attr.marker-end",r("end"))(-1),t.on("snap.util.attr.markerEnd",r("end"))(-1),t.on("snap.util.attr.marker-start",r("start"))(-1),t.on("snap.util.attr.markerStart",r("start"))(-1),t.on("snap.util.attr.marker-mid",r("mid"))(-1),t.on("snap.util.attr.markerMid",r("mid"))(-1)}(),t.on("snap.util.getattr.r",function(){if(this.type=="rect"&&h(this.node,"rx")==h(this.node,"ry"))return t.stop(),h(this.node,"rx")})(-1),t.on("snap.util.getattr.text",function(){if(this.type=="text"||this.type=="tspan"){t.stop();var e=w(this.node);return e.length==1?e[0]:e}})(-1),t.on("snap.util.getattr.#text",function(){return this.node.textContent})(-1),t.on("snap.util.getattr.viewBox",function(){t.stop();var n=h(this.node,"viewBox");if(n)return n=n.split(v),e._.box(+n[0],+n[1],+n[2],+n[3]);return})(-1),t.on("snap.util.getattr.points",function(){var e=h(this.node,"points");t.stop();if(e)return e.split(v);return})(-1),t.on("snap.util.getattr.path",function(){var e=h(this.node,"d");return t.stop(),e})(-1),t.on("snap.util.getattr.class",function(){return this.node.className.baseVal})(-1),t.on("snap.util.getattr.fontSize",E)(-1),t.on("snap.util.getattr.font-size",E)(-1)}),r.plugin(function(e,t,n,r,i){var s=/\S+/g,o=/[\t\r\n\f]/g,u=/(^\s+|\s+$)/g,a=String,f=t.prototype;f.addClass=function(e){var t=a(e||"").match(s)||[],n=this.node,r=n.className.baseVal,i=r.match(s)||[],o,u,f,l;if(t.length){o=0;while(f=t[o++])u=i.indexOf(f),~u||i.push(f);l=i.join(" "),r!=l&&(n.className.baseVal=l)}return this},f.removeClass=function(e){var t=a(e||"").match(s)||[],n=this.node,r=n.className.baseVal,i=r.match(s)||[],o,u,f,l;if(i.length){o=0;while(f=t[o++])u=i.indexOf(f),~u&&i.splice(u,1);l=i.join(" "),r!=l&&(n.className.baseVal=l)}return this},f.hasClass=function(e){var t=this.node,n=t.className.baseVal,r=n.match(s)||[];return!!~r.indexOf(e)},f.toggleClass=function(e,t){if(t!=null)return t?this.addClass(e):this.removeClass(e);var n=(e||"").match(s)||[],r=this.node,i=r.className.baseVal,o=i.match(s)||[],u,a,f,l;u=0;while(f=n[u++])a=o.indexOf(f),~a?o.splice(a,1):o.push(f);return l=o.join(" "),i!=l&&(r.className.baseVal=l),this}}),r.plugin(function(e,n,r,i,s){function l(e){return e}function c(e){return function(t){return+t.toFixed(3)+e}}var o={"+":function(e,t){return e+t},"-":function(e,t){return e-t},"/":function(e,t){return e/t},"*":function(e,t){return e*t}},u=String,a=/[a-z]+$/i,f=/^\s*([+\-\/*])\s*=\s*([\d.eE+\-]+)\s*([^\d\s]+)?\s*$/;t.on("snap.util.attr",function(e){var n=u(e).match(f);if(n){var r=t.nt(),i=r.substring(r.lastIndexOf(".")+1),s=this.attr(i),l={};t.stop();var c=n[3]||"",h=s.match(a),p=o[n[1]];h&&h==c?e=p(parseFloat(s),+n[2]):(s=this.asPX(i),e=p(this.asPX(i),this.asPX(i,n[2]+c)));if(isNaN(s)||isNaN(e))return;l[i]=e,this.attr(l)}})(-10),t.on("snap.util.equal",function(e,n){var r,i,s=u(this.attr(e)||""),h=this,p=u(n).match(f);if(p){t.stop();var d=p[3]||"",v=s.match(a),m=o[p[1]];return v&&v==d?{from:parseFloat(s),to:m(parseFloat(s),+p[2]),f:c(v)}:(s=this.asPX(e),{from:s,to:m(s,this.asPX(e,p[2]+d)),f:l})}})(-10)}),r.plugin(function(n,r,i,s,o){var u=i.prototype,a=n.is;u.rect=function(e,t,n,r,i,s){var o;return s==null&&(s=i),a(e,"object")&&e=="[object Object]"?o=e:e!=null&&(o={x:e,y:t,width:n,height:r},i!=null&&(o.rx=i,o.ry=s)),this.el("rect",o)},u.circle=function(e,t,n){var r;return a(e,"object")&&e=="[object Object]"?r=e:e!=null&&(r={cx:e,cy:t,r:n}),this.el("circle",r)};var f=function(){function e(){this.parentNode.removeChild(this)}return function(t,n){var r=s.doc.createElement("img"),i=s.doc.body;r.style.cssText="position:absolute;left:-9999em;top:-9999em",r.onload=function(){n.call(r),r.onload=r.onerror=null,i.removeChild(r)},r.onerror=e,i.appendChild(r),r.src=t}}();u.image=function(e,t,r,i,s){var o=this.el("image");if(a(e,"object")&&"src"in e)o.attr(e);else if(e!=null){var u={"xlink:href":e,preserveAspectRatio:"none"};t!=null&&r!=null&&(u.x=t,u.y=r),i!=null&&s!=null?(u.width=i,u.height=s):f(e,function(){n._.$(o.node,{width:this.offsetWidth,height:this.offsetHeight})}),n._.$(o.node,u)}return o},u.ellipse=function(e,t,n,r){var i;return a(e,"object")&&e=="[object Object]"?i=e:e!=null&&(i={cx:e,cy:t,rx:n,ry:r}),this.el("ellipse",i)},u.path=function(e){var t;return a(e,"object")&&!a(e,"array")?t=e:e&&(t={d:e}),this.el("path",t)},u.group=u.g=function(e){var t,n=this.el("g");return arguments.length==1&&e&&!e.type?n.attr(e):arguments.length&&n.add(Array.prototype.slice.call(arguments,0)),n},u.svg=function(e,t,n,r,i,s,o,u){var f={};return a(e,"object")&&t==null?f=e:(e!=null&&(f.x=e),t!=null&&(f.y=t),n!=null&&(f.width=n),r!=null&&(f.height=r),i!=null&&s!=null&&o!=null&&u!=null&&(f.viewBox=[i,s,o,u])),this.el("svg",f)},u.mask=function(e){var t,n=this.el("mask");return arguments.length==1&&e&&!e.type?n.attr(e):arguments.length&&n.add(Array.prototype.slice.call(arguments,0)),n},u.ptrn=function(e,t,n,r,i,s,o,u){if(a(e,"object"))var f=e;else f={patternUnits:"userSpaceOnUse"},e&&(f.x=e),t&&(f.y=t),n!=null&&(f.width=n),r!=null&&(f.height=r),i!=null&&s!=null&&o!=null&&u!=null?f.viewBox=[i,s,o,u]:f.viewBox=[e||0,t||0,n||0,r||0];return this.el("pattern",f)},u.use=function(e){return e!=null?(e instanceof r&&(e.attr("id")||e.attr({id:n._.id(e)}),e=e.attr("id")),String(e).charAt()=="#"&&(e=e.substring(1)),this.el("use",{"xlink:href":"#"+e})):r.prototype.use.call(this)},u.symbol=function(e,t,n,r){var i={};return e!=null&&t!=null&&n!=null&&r!=null&&(i.viewBox=[e,t,n,r]),this.el("symbol",i)},u.text=function(e,t,n){var r={};return a(e,"object")?r=e:e!=null&&(r={x:e,y:t,text:n||""}),this.el("text",r)},u.line=function(e,t,n,r){var i={};return a(e,"object")?i=e:e!=null&&(i={x1:e,x2:n,y1:t,y2:r}),this.el("line",i)},u.polyline=function(e){arguments.length>1&&(e=Array.prototype.slice.call(arguments,0));var t={};return a(e,"object")&&!a(e,"array")?t=e:e!=null&&(t={points:e}),this.el("polyline",t)},u.polygon=function(e){arguments.length>1&&(e=Array.prototype.slice.call(arguments,0));var t={};return a(e,"object")&&!a(e,"array")?t=e:e!=null&&(t={points:e}),this.el("polygon",t)},function(){function i(){return this.selectAll("stop")}function s(e,t){var i=r("stop"),s={offset:+t+"%"};return e=n.color(e),s["stop-color"]=e.hex,e.opacity<1&&(s["stop-opacity"]=e.opacity),r(i,s),this.node.appendChild(i),this}function o(){if(this.type=="linearGradient"){var e=r(this.node,"x1")||0,t=r(this.node,"x2")||1,i=r(this.node,"y1")||0,s=r(this.node,"y2")||0;return n._.box(e,i,math.abs(t-e),math.abs(s-i))}var o=this.node.cx||.5,u=this.node.cy||.5,a=this.node.r||0;return n._.box(o-a,u-a,a*2,a*2)}function a(e,n){function h(e,t){var n=(t-a)/(e-c);for(var r=c;r<e;r++)o[r].offset=+(+a+n*(r-c)).toFixed(2);c=e,a=t}var i=t("snap.util.grad.parse",null,n).firstDefined(),s;if(!i)return null;i.params.unshift(e),i.type.toLowerCase()=="l"?s=f.apply(0,i.params):s=l.apply(0,i.params),i.type!=i.type.toLowerCase()&&r(s.node,{gradientUnits:"userSpaceOnUse"});var o=i.stops,u=o.length,a=0,c=0;u--;for(var p=0;p<u;p++)"offset"in o[p]&&h(p,o[p].offset);o[u].offset=o[u].offset||100,h(u,o[u].offset);for(p=0;p<=u;p++){var d=o[p];s.addStop(d.color,d.offset)}return s}function f(e,t,u,a,f){var l=n._.make("linearGradient",e);return l.stops=i,l.addStop=s,l.getBBox=o,t!=null&&r(l.node,{x1:t,y1:u,x2:a,y2:f}),l}function l(e,t,u,a,f,l){var c=n._.make("radialGradient",e);return c.stops=i,c.addStop=s,c.getBBox=o,t!=null&&r(c.node,{cx:t,cy:u,r:a}),f!=null&&l!=null&&r(c.node,{fx:f,fy:l}),c}var r=n._.$;u.gradient=function(e){return a(this.defs,e)},u.gradientLinear=function(e,t,n,r){return f(this.defs,e,t,n,r)},u.gradientRadial=function(e,t,n,r,i){return l(this.defs,e,t,n,r,i)},u.toString=function(){var e=this.node.ownerDocument,t=e.createDocumentFragment(),r=e.createElement("div"),i=this.node.cloneNode(!0),s;return t.appendChild(r),r.appendChild(i),n._.$(i,{xmlns:"http://www.w3.org/2000/svg"}),s=r.innerHTML,t.removeChild(t.firstChild),s},u.toDataURL=function(){if(e&&e.btoa)return"data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(this)))},u.clear=function(){var e=this.node.firstChild,t;while(e)t=e.nextSibling,e.tagName!="defs"?e.parentNode.removeChild(e):u.clear.call({node:e}),e=t}}()}),r.plugin(function(e,t,n,r){function m(e){var t=m.ps=m.ps||{};return t[e]?t[e].sleep=100:t[e]={sleep:100},setTimeout(function(){for(var n in t)t[u](n)&&n!=e&&(t[n].sleep--,!t[n].sleep&&delete t[n])}),t[e]}function g(e,t,n,r){return e==null&&(e=t=n=r=0),t==null&&(t=e.y,n=e.width,r=e.height,e=e.x),{x:e,y:t,width:n,w:n,height:r,h:r,x2:e+n,y2:t+r,cx:e+n/2,cy:t+r/2,r1:l.min(n,r)/2,r2:l.max(n,r)/2,r0:l.sqrt(n*n+r*r)/2,path:R(e,t,n,r),vb:[e,t,n,r].join(" ")}}function y(){return this.join(",").replace(a,"$1")}function b(e){var t=o(e);return t.toString=y,t}function w(e,t,n,r,i,s,o,u,a){return a==null?O(e,t,n,r,i,s,o,u):N(e,t,n,r,i,s,o,u,M(e,t,n,r,i,s,o,u,a))}function E(n,r){function i(e){return+(+e).toFixed(3)}return e._.cacher(function(e,s,o){e instanceof t&&(e=e.attr("d")),e=Y(e);var u,a,f,l,c="",h={},p,d=0;for(var v=0,m=e.length;v<m;v++){f=e[v];if(f[0]=="M")u=+f[1],a=+f[2];else{l=w(u,a,f[1],f[2],f[3],f[4],f[5],f[6]);if(d+l>s){if(r&&!h.start){p=w(u,a,f[1],f[2],f[3],f[4],f[5],f[6],s-d),c+=["C"+i(p.start.x),i(p.start.y),i(p.m.x),i(p.m.y),i(p.x),i(p.y)];if(o)return c;h.start=c,c=["M"+i(p.x),i(p.y)+"C"+i(p.n.x),i(p.n.y),i(p.end.x),i(p.end.y),i(f[5]),i(f[6])].join(),d+=l,u=+f[5],a=+f[6];continue}if(!n&&!r)return p=w(u,a,f[1],f[2],f[3],f[4],f[5],f[6],s-d),p}d+=l,u=+f[5],a=+f[6]}c+=f.shift()+f}return h.end=c,p=n?d:r?h:N(u,a,f[0],f[1],f[2],f[3],f[4],f[5],1),p},null,e._.clone)}function N(e,t,n,r,i,s,o,u,a){var f=1-a,h=d(f,3),p=d(f,2),v=a*a,m=v*a,g=h*e+p*3*a*n+f*3*a*a*i+m*o,y=h*t+p*3*a*r+f*3*a*a*s+m*u,b=e+2*a*(n-e)+v*(i-2*n+e),w=t+2*a*(r-t)+v*(s-2*r+t),E=n+2*a*(i-n)+v*(o-2*i+n),S=r+2*a*(s-r)+v*(u-2*s+r),x=f*e+a*n,T=f*t+a*r,N=f*i+a*o,C=f*s+a*u,k=90-l.atan2(b-E,w-S)*180/c;return{x:g,y:y,m:{x:b,y:w},n:{x:E,y:S},start:{x:x,y:T},end:{x:N,y:C},alpha:k}}function C(t,n,r,i,s,o,u,a){e.is(t,"array")||(t=[t,n,r,i,s,o,u,a]);var f=G.apply(null,t);return g(f.min.x,f.min.y,f.max.x-f.min.x,f.max.y-f.min.y)}function k(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function L(e,t){return e=g(e),t=g(t),k(t,e.x,e.y)||k(t,e.x2,e.y)||k(t,e.x,e.y2)||k(t,e.x2,e.y2)||k(e,t.x,t.y)||k(e,t.x2,t.y)||k(e,t.x,t.y2)||k(e,t.x2,t.y2)||(e.x<t.x2&&e.x>t.x||t.x<e.x2&&t.x>e.x)&&(e.y<t.y2&&e.y>t.y||t.y<e.y2&&t.y>e.y)}function A(e,t,n,r,i){var s=-3*t+9*n-9*r+3*i,o=e*s+6*t-12*n+6*r;return e*o-3*t+3*n}function O(e,t,n,r,i,s,o,u,a){a==null&&(a=1),a=a>1?1:a<0?0:a;var f=a/2,c=12,h=[-0.1252,.1252,-0.3678,.3678,-0.5873,.5873,-0.7699,.7699,-0.9041,.9041,-0.9816,.9816],p=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],d=0;for(var v=0;v<c;v++){var m=f*h[v]+f,g=A(m,e,n,i,o),y=A(m,t,r,s,u),b=g*g+y*y;d+=p[v]*l.sqrt(b)}return f*d}function M(e,t,n,r,i,s,o,u,a){if(a<0||O(e,t,n,r,i,s,o,u)<a)return;var f=1,l=f/2,c=f-l,h,p=.01;h=O(e,t,n,r,i,s,o,u,c);while(v(h-a)>p)l/=2,c+=(h<a?1:-1)*l,h=O(e,t,n,r,i,s,o,u,c);return c}function _(e,t,n,r,i,s,o,u){if(p(e,n)<h(i,o)||h(e,n)>p(i,o)||p(t,r)<h(s,u)||h(t,r)>p(s,u))return;var a=(e*r-t*n)*(i-o)-(e-n)*(i*u-s*o),f=(e*r-t*n)*(s-u)-(t-r)*(i*u-s*o),l=(e-n)*(s-u)-(t-r)*(i-o);if(!l)return;var c=a/l,d=f/l,v=+c.toFixed(2),m=+d.toFixed(2);if(v<+h(e,n).toFixed(2)||v>+p(e,n).toFixed(2)||v<+h(i,o).toFixed(2)||v>+p(i,o).toFixed(2)||m<+h(t,r).toFixed(2)||m>+p(t,r).toFixed(2)||m<+h(s,u).toFixed(2)||m>+p(s,u).toFixed(2))return;return{x:c,y:d}}function D(e,t){return H(e,t)}function P(e,t){return H(e,t,1)}function H(e,t,n){var r=C(e),i=C(t);if(!L(r,i))return n?0:[];var s=O.apply(0,e),o=O.apply(0,t),u=~~(s/8),a=~~(o/8),f=[],l=[],c={},h=n?0:[];for(var p=0;p<u+1;p++){var d=N.apply(0,e.concat(p/u));f.push({x:d.x,y:d.y,t:p/u})}for(p=0;p<a+1;p++)d=N.apply(0,t.concat(p/a)),l.push({x:d.x,y:d.y,t:p/a});for(p=0;p<u;p++)for(var m=0;m<a;m++){var g=f[p],y=f[p+1],b=l[m],w=l[m+1],E=v(y.x-g.x)<.001?"y":"x",S=v(w.x-b.x)<.001?"y":"x",x=_(g.x,g.y,y.x,y.y,b.x,b.y,w.x,w.y);if(x){if(c[x.x.toFixed(4)]==x.y.toFixed(4))continue;c[x.x.toFixed(4)]=x.y.toFixed(4);var T=g.t+v((x[E]-g[E])/(y[E]-g[E]))*(y.t-g.t),k=b.t+v((x[S]-b[S])/(w[S]-b[S]))*(w.t-b.t);T>=0&&T<=1&&k>=0&&k<=1&&(n?h++:h.push({x:x.x,y:x.y,t1:T,t2:k}))}}return h}function B(e,t){return F(e,t)}function j(e,t){return F(e,t,1)}function F(e,t,n){e=Y(e),t=Y(t);var r,i,s,o,u,a,f,l,c,h,p=n?0:[];for(var d=0,v=e.length;d<v;d++){var m=e[d];if(m[0]=="M")r=u=m[1],i=a=m[2];else{m[0]=="C"?(c=[r,i].concat(m.slice(1)),r=c[6],i=c[7]):(c=[r,i,r,i,u,a,u,a],r=u,i=a);for(var g=0,y=t.length;g<y;g++){var b=t[g];if(b[0]=="M")s=f=b[1],o=l=b[2];else{b[0]=="C"?(h=[s,o].concat(b.slice(1)),s=h[6],o=h[7]):(h=[s,o,s,o,f,l,f,l],s=f,o=l);var w=H(c,h,n);if(n)p+=w;else{for(var E=0,S=w.length;E<S;E++)w[E].segment1=d,w[E].segment2=g,w[E].bez1=c,w[E].bez2=h;p=p.concat(w)}}}}}return p}function I(e,t,n){var r=q(e);return k(r,t,n)&&F(e,[["M",t,n],["H",r.x2+10]],1)%2==1}function q(e){var t=m(e);if(t.bbox)return o(t.bbox);if(!e)return g();e=Y(e);var n=0,r=0,i=[],s=[],u;for(var a=0,f=e.length;a<f;a++){u=e[a];if(u[0]=="M")n=u[1],r=u[2],i.push(n),s.push(r);else{var l=G(n,r,u[1],u[2],u[3],u[4],u[5],u[6]);i=i.concat(l.min.x,l.max.x),s=s.concat(l.min.y,l.max.y),n=u[5],r=u[6]}}var c=h.apply(0,i),d=h.apply(0,s),v=p.apply(0,i),y=p.apply(0,s),b=g(c,d,v-c,y-d);return t.bbox=o(b),b}function R(e,t,n,r,i){if(i)return[["M",+e+ +i,t],["l",n-i*2,0],["a",i,i,0,0,1,i,i],["l",0,r-i*2],["a",i,i,0,0,1,-i,i],["l",i*2-n,0],["a",i,i,0,0,1,-i,-i],["l",0,i*2-r],["a",i,i,0,0,1,i,-i],["z"]];var s=[["M",e,t],["l",n,0],["l",0,r],["l",-n,0],["z"]];return s.toString=y,s}function U(e,t,n,r,i){i==null&&r==null&&(r=n),e=+e,t=+t,n=+n,r=+r;if(i!=null)var s=Math.PI/180,o=e+n*Math.cos(-r*s),u=e+n*Math.cos(-i*s),a=t+n*Math.sin(-r*s),f=t+n*Math.sin(-i*s),l=[["M",o,a],["A",n,n,0,+(i-r>180),0,u,f]];else l=[["M",e,t],["m",0,-r],["a",n,r,0,1,1,0,2*r],["a",n,r,0,1,1,0,-2*r],["z"]];return l.toString=y,l}function X(t){var n=m(t),r=String.prototype.toLowerCase;if(n.rel)return b(n.rel);if(!e.is(t,"array")||!e.is(t&&t[0],"array"))t=e.parsePathString(t);var i=[],s=0,o=0,u=0,a=0,f=0;t[0][0]=="M"&&(s=t[0][1],o=t[0][2],u=s,a=o,f++,i.push(["M",s,o]));for(var l=f,c=t.length;l<c;l++){var h=i[l]=[],p=t[l];if(p[0]!=r.call(p[0])){h[0]=r.call(p[0]);switch(h[0]){case"a":h[1]=p[1],h[2]=p[2],h[3]=p[3],h[4]=p[4],h[5]=p[5],h[6]=+(p[6]-s).toFixed(3),h[7]=+(p[7]-o).toFixed(3);break;case"v":h[1]=+(p[1]-o).toFixed(3);break;case"m":u=p[1],a=p[2];default:for(var d=1,v=p.length;d<v;d++)h[d]=+(p[d]-(d%2?s:o)).toFixed(3)}}else{h=i[l]=[],p[0]=="m"&&(u=p[1]+s,a=p[2]+o);for(var g=0,w=p.length;g<w;g++)i[l][g]=p[g]}var E=i[l].length;switch(i[l][0]){case"z":s=u,o=a;break;case"h":s+=+i[l][E-1];break;case"v":o+=+i[l][E-1];break;default:s+=+i[l][E-2],o+=+i[l][E-1]}}return i.toString=y,n.rel=b(i),i}function V(t){var n=m(t);if(n.abs)return b(n.abs);if(!s(t,"array")||!s(t&&t[0],"array"))t=e.parsePathString(t);if(!t||!t.length)return[["M",0,0]];var r=[],i=0,o=0,u=0,a=0,f=0,l;t[0][0]=="M"&&(i=+t[0][1],o=+t[0][2],u=i,a=o,f++,r[0]=["M",i,o]);var c=t.length==3&&t[0][0]=="M"&&t[1][0].toUpperCase()=="R"&&t[2][0].toUpperCase()=="Z";for(var h,p,d=f,v=t.length;d<v;d++){r.push(h=[]),p=t[d],l=p[0];if(l!=l.toUpperCase()){h[0]=l.toUpperCase();switch(h[0]){case"A":h[1]=p[1],h[2]=p[2],h[3]=p[3],h[4]=p[4],h[5]=p[5],h[6]=+p[6]+i,h[7]=+p[7]+o;break;case"V":h[1]=+p[1]+o;break;case"H":h[1]=+p[1]+i;break;case"R":var g=[i,o].concat(p.slice(1));for(var w=2,E=g.length;w<E;w++)g[w]=+g[w]+i,g[++w]=+g[w]+o;r.pop(),r=r.concat(et(g,c));break;case"O":r.pop(),g=U(i,o,p[1],p[2]),g.push(g[0]),r=r.concat(g);break;case"U":r.pop(),r=r.concat(U(i,o,p[1],p[2],p[3])),h=["U"].concat(r[r.length-1].slice(-2));break;case"M":u=+p[1]+i,a=+p[2]+o;default:for(w=1,E=p.length;w<E;w++)h[w]=+p[w]+(w%2?i:o)}}else if(l=="R")g=[i,o].concat(p.slice(1)),r.pop(),r=r.concat(et(g,c)),h=["R"].concat(p.slice(-2));else if(l=="O")r.pop(),g=U(i,o,p[1],p[2]),g.push(g[0]),r=r.concat(g);else if(l=="U")r.pop(),r=r.concat(U(i,o,p[1],p[2],p[3])),h=["U"].concat(r[r.length-1].slice(-2));else for(var S=0,x=p.length;S<x;S++)h[S]=p[S];l=l.toUpperCase();if(l!="O")switch(h[0]){case"Z":i=+u,o=+a;break;case"H":i=h[1];break;case"V":o=h[1];break;case"M":u=h[h.length-2],a=h[h.length-1];default:i=h[h.length-2],o=h[h.length-1]}}return r.toString=y,n.abs=b(r),r}function $(e,t,n,r){return[e,t,n,r,n,r]}function J(e,t,n,r,i,s){var o=1/3,u=2/3;return[o*e+u*n,o*t+u*r,o*i+u*n,o*s+u*r,i,s]}function K(t,n,r,i,s,o,u,a,f,h){var p=c*120/180,d=c/180*(+s||0),m=[],g,y=e._.cacher(function(e,t,n){var r=e*l.cos(n)-t*l.sin(n),i=e*l.sin(n)+t*l.cos(n);return{x:r,y:i}});if(!h){g=y(t,n,-d),t=g.x,n=g.y,g=y(a,f,-d),a=g.x,f=g.y;var b=l.cos(c/180*s),w=l.sin(c/180*s),E=(t-a)/2,S=(n-f)/2,x=E*E/(r*r)+S*S/(i*i);x>1&&(x=l.sqrt(x),r=x*r,i=x*i);var T=r*r,N=i*i,C=(o==u?-1:1)*l.sqrt(v((T*N-T*S*S-N*E*E)/(T*S*S+N*E*E))),k=C*r*S/i+(t+a)/2,L=C*-i*E/r+(n+f)/2,A=l.asin(((n-L)/i).toFixed(9)),O=l.asin(((f-L)/i).toFixed(9));A=t<k?c-A:A,O=a<k?c-O:O,A<0&&(A=c*2+A),O<0&&(O=c*2+O),u&&A>O&&(A-=c*2),!u&&O>A&&(O-=c*2)}else A=h[0],O=h[1],k=h[2],L=h[3];var M=O-A;if(v(M)>p){var _=O,D=a,P=f;O=A+p*(u&&O>A?1:-1),a=k+r*l.cos(O),f=L+i*l.sin(O),m=K(a,f,r,i,s,0,u,D,P,[O,_,k,L])}M=O-A;var H=l.cos(A),B=l.sin(A),j=l.cos(O),F=l.sin(O),I=l.tan(M/4),q=4/3*r*I,R=4/3*i*I,U=[t,n],z=[t+q*B,n-R*H],W=[a+q*F,f-R*j],X=[a,f];z[0]=2*U[0]-z[0],z[1]=2*U[1]-z[1];if(h)return[z,W,X].concat(m);m=[z,W,X].concat(m).join().split(",");var V=[];for(var $=0,J=m.length;$<J;$++)V[$]=$%2?y(m[$-1],m[$],d).y:y(m[$],m[$+1],d).x;return V}function Q(e,t,n,r,i,s,o,u,a){var f=1-a;return{x:d(f,3)*e+d(f,2)*3*a*n+f*3*a*a*i+d(a,3)*o,y:d(f,3)*t+d(f,2)*3*a*r+f*3*a*a*s+d(a,3)*u}}function G(e,t,n,r,i,s,o,u){var a=[],f=[[],[]],c,d,m,g,y,b,w,E;for(var S=0;S<2;++S){S==0?(d=6*e-12*n+6*i,c=-3*e+9*n-9*i+3*o,m=3*n-3*e):(d=6*t-12*r+6*s,c=-3*t+9*r-9*s+3*u,m=3*r-3*t);if(v(c)<1e-12){if(v(d)<1e-12)continue;g=-m/d,0<g&&g<1&&a.push(g);continue}w=d*d-4*m*c,E=l.sqrt(w);if(w<0)continue;y=(-d+E)/(2*c),0<y&&y<1&&a.push(y),b=(-d-E)/(2*c),0<b&&b<1&&a.push(b)}var x,T,N=a.length,C=N,k;while(N--)g=a[N],k=1-g,f[0][N]=k*k*k*e+3*k*k*g*n+3*k*g*g*i+g*g*g*o,f[1][N]=k*k*k*t+3*k*k*g*r+3*k*g*g*s+g*g*g*u;return f[0][C]=e,f[1][C]=t,f[0][C+1]=o,f[1][C+1]=u,f[0].length=f[1].length=C+2,{min:{x:h.apply(0,f[0]),y:h.apply(0,f[1])},max:{x:p.apply(0,f[0]),y:p.apply(0,f[1])}}}function Y(e,t){var n=!t&&m(e);if(!t&&n.curve)return b(n.curve);var r=V(e),i=t&&V(t),s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},o={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},u=function(e,t,n){var r,i;if(!e)return["C",t.x,t.y,t.x,t.y,t.x,t.y];!(e[0]in{T:1,Q:1})&&(t.qx=t.qy=null);switch(e[0]){case"M":t.X=e[1],t.Y=e[2];break;case"A":e=["C"].concat(K.apply(0,[t.x,t.y].concat(e.slice(1))));break;case"S":n=="C"||n=="S"?(r=t.x*2-t.bx,i=t.y*2-t.by):(r=t.x,i=t.y),e=["C",r,i].concat(e.slice(1));break;case"T":n=="Q"||n=="T"?(t.qx=t.x*2-t.qx,t.qy=t.y*2-t.qy):(t.qx=t.x,t.qy=t.y),e=["C"].concat(J(t.x,t.y,t.qx,t.qy,e[1],e[2]));break;case"Q":t.qx=e[1],t.qy=e[2],e=["C"].concat(J(t.x,t.y,e[1],e[2],e[3],e[4]));break;case"L":e=["C"].concat($(t.x,t.y,e[1],e[2]));break;case"H":e=["C"].concat($(t.x,t.y,e[1],t.y));break;case"V":e=["C"].concat($(t.x,t.y,t.x,e[1]));break;case"Z":e=["C"].concat($(t.x,t.y,t.X,t.Y))}return e},a=function(e,t){if(e[t].length>7){e[t].shift();var n=e[t];while(n.length)c[t]="A",i&&(h[t]="A"),e.splice(t++,0,["C"].concat(n.splice(0,6)));e.splice(t,1),y=p(r.length,i&&i.length||0)}},l=function(e,t,n,s,o){e&&t&&e[o][0]=="M"&&t[o][0]!="M"&&(t.splice(o,0,["M",s.x,s.y]),n.bx=0,n.by=0,n.x=e[o][1],n.y=e[o][2],y=p(r.length,i&&i.length||0))},c=[],h=[],d="",v="";for(var g=0,y=p(r.length,i&&i.length||0);g<y;g++){r[g]&&(d=r[g][0]),d!="C"&&(c[g]=d,g&&(v=c[g-1])),r[g]=u(r[g],s,v),c[g]!="A"&&d=="C"&&(c[g]="C"),a(r,g),i&&(i[g]&&(d=i[g][0]),d!="C"&&(h[g]=d,g&&(v=h[g-1])),i[g]=u(i[g],o,v),h[g]!="A"&&d=="C"&&(h[g]="C"),a(i,g)),l(r,i,s,o,g),l(i,r,o,s,g);var w=r[g],E=i&&i[g],S=w.length,x=i&&E.length;s.x=w[S-2],s.y=w[S-1],s.bx=f(w[S-4])||s.x,s.by=f(w[S-3])||s.y,o.bx=i&&(f(E[x-4])||o.x),o.by=i&&(f(E[x-3])||o.y),o.x=i&&E[x-2],o.y=i&&E[x-1]}return i||(n.curve=b(r)),i?[r,i]:r}function Z(e,t){if(!t)return e;var n,r,i,s,o,u,a;e=Y(e);for(i=0,o=e.length;i<o;i++){a=e[i];for(s=1,u=a.length;s<u;s+=2)n=t.x(a[s],a[s+1]),r=t.y(a[s],a[s+1]),a[s]=n,a[s+1]=r}return e}function et(e,t){var n=[];for(var r=0,i=e.length;i-2*!t>r;r+=2){var s=[{x:+e[r-2],y:+e[r-1]},{x:+e[r],y:+e[r+1]},{x:+e[r+2],y:+e[r+3]},{x:+e[r+4],y:+e[r+5]}];t?r?i-4==r?s[3]={x:+e[0],y:+e[1]}:i-2==r&&(s[2]={x:+e[0],y:+e[1]},s[3]={x:+e[2],y:+e[3]}):s[0]={x:+e[i-2],y:+e[i-1]}:i-4==r?s[3]=s[2]:r||(s[0]={x:+e[r],y:+e[r+1]}),n.push(["C",(-s[0].x+6*s[1].x+s[2].x)/6,(-s[0].y+6*s[1].y+s[2].y)/6,(s[1].x+6*s[2].x-s[3].x)/6,(s[1].y+6*s[2].y-s[3].y)/6,s[2].x,s[2].y])}return n}var i=t.prototype,s=e.is,o=e._.clone,u="hasOwnProperty",a=/,?([a-z]),?/gi,f=parseFloat,l=Math,c=l.PI,h=l.min,p=l.max,d=l.pow,v=l.abs,S=E(1),x=E(),T=E(0,1),z=e._unit2px,W={path:function(e){return e.attr("path")},circle:function(e){var t=z(e);return U(t.cx,t.cy,t.r)},ellipse:function(e){var t=z(e);return U(t.cx||0,t.cy||0,t.rx,t.ry)},rect:function(e){var t=z(e);return R(t.x||0,t.y||0,t.width,t.height,t.rx,t.ry)},image:function(e){var t=z(e);return R(t.x||0,t.y||0,t.width,t.height)},line:function(e){return"M"+[e.attr("x1")||0,e.attr("y1")||0,e.attr("x2"),e.attr("y2")]},polyline:function(e){return"M"+e.attr("points")},polygon:function(e){return"M"+e.attr("points")+"z"},deflt:function(e){var t=e.node.getBBox();return R(t.x,t.y,t.width,t.height)}};e.path=m,e.path.getTotalLength=S,e.path.getPointAtLength=x,e.path.getSubpath=function(e,t,n){if(this.getTotalLength(e)-n<1e-6)return T(e,t).end;var r=T(e,n,1);return t?T(r,t).end:r},i.getTotalLength=function(){if(this.node.getTotalLength)return this.node.getTotalLength()},i.getPointAtLength=function(e){return x(this.attr("d"),e)},i.getSubpath=function(t,n){return e.path.getSubpath(this.attr("d"),t,n)},e._.box=g,e.path.findDotsAtSegment=N,e.path.bezierBBox=C,e.path.isPointInsideBBox=k,e.closest=function(t,n,r,i){var s=100,o=g(t-s/2,n-s/2,s,s),u=[],a=r[0].hasOwnProperty("x")?function(e){return{x:r[e].x,y:r[e].y}}:function(e){return{x:r[e],y:i[e]}},f=0;while(s<=1e6&&!f){for(var l=0,c=r.length;l<c;l++){var h=a(l);if(k(o,h.x,h.y)){f++,u.push(h);break}}f||(s*=2,o=g(t-s/2,n-s/2,s,s))}if(s==1e6)return;var p=Infinity,d;for(l=0,c=u.length;l<c;l++){var v=e.len(t,n,u[l].x,u[l].y);p>v&&(p=v,u[l].len=v,d=u[l])}return d},e.path.isBBoxIntersect=L,e.path.intersection=B,e.path.intersectionNumber=j,e.path.isPointInside=I,e.path.getBBox=q,e.path.get=W,e.path.toRelative=X,e.path.toAbsolute=V,e.path.toCubic=Y,e.path.map=Z,e.path.toString=y,e.path.clone=b}),r.plugin(function(e,r,i,s){var o=Math.max,u=Math.min,a=function(e){this.items=[],this.bindings={},this.length=0,this.type="set";if(e)for(var t=0,n=e.length;t<n;t++)e[t]&&(this[this.items.length]=this.items[this.items.length]=e[t],this.length++)},f=a.prototype;f.push=function(){var e,t;for(var n=0,r=arguments.length;n<r;n++)e=arguments[n],e&&(t=this.items.length,this[t]=this.items[t]=e,this.length++);return this},f.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},f.forEach=function(e,t){for(var n=0,r=this.items.length;n<r;n++)if(e.call(t,this.items[n],n)===!1)return this;return this},f.animate=function(r,i,s,o){typeof s=="function"&&!s.length&&(o=s,s=n.linear),r instanceof e._.Animation&&(o=r.callback,s=r.easing,i=s.dur,r=r.attr);var u=arguments;if(e.is(r,"array")&&e.is(u[u.length-1],"array"))var a=!0;var f,l=function(){f?this.b=f:f=this.b},c=0,h=this,p=o&&function(){++c==h.length&&o.call(this)};return this.forEach(function(e,n){t.once("snap.animcreated."+e.id,l),a?u[n]&&e.animate.apply(e,u[n]):e.animate(r,i,s,p)})},f.remove=function(){while(this.length)this.pop().remove();return this},f.bind=function(e,t,n){var r={};if(typeof t=="function")this.bindings[e]=t;else{var i=n||e;this.bindings[e]=function(e){r[i]=e,t.attr(r)}}return this},f.attr=function(e){var t={};for(var n in e)this.bindings[n]?this.bindings[n](e[n]):t[n]=e[n];for(var r=0,i=this.items.length;r<i;r++)this.items[r].attr(t);return this},f.clear=function(){while(this.length)this.pop()},f.splice=function(e,t,n){e=e<0?o(this.length+e,0):e,t=o(0,u(this.length-e,t));var r=[],i=[],s=[],f;for(f=2;f<arguments.length;f++)s.push(arguments[f]);for(f=0;f<t;f++)i.push(this[e+f]);for(;f<this.length-e;f++)r.push(this[e+f]);var l=s.length;for(f=0;f<l+r.length;f++)this.items[e+f]=this[e+f]=f<l?s[f]:r[f-l];f=this.items.length=this.length-=t-l;while(this[f])delete this[f++];return new a(i)},f.exclude=function(e){for(var t=0,n=this.length;t<n;t++)if(this[t]==e)return this.splice(t,1),!0;return!1},f.insertAfter=function(e){var t=this.items.length;while(t--)this.items[t].insertAfter(e);return this},f.getBBox=function(){var e=[],t=[],n=[],r=[];for(var i=this.items.length;i--;)if(!this.items[i].removed){var s=this.items[i].getBBox();e.push(s.x),t.push(s.y),n.push(s.x+s.width),r.push(s.y+s.height)}return e=u.apply(0,e),t=u.apply(0,t),n=o.apply(0,n),r=o.apply(0,r),{x:e,y:t,x2:n,y2:r,width:n-e,height:r-t,cx:e+(n-e)/2,cy:t+(r-t)/2}},f.clone=function(e){e=new a;for(var t=0,n=this.items.length;t<n;t++)e.push(this.items[t].clone());return e},f.toString=function(){return"Snap‘s set"},f.type="set",e.Set=a,e.set=function(){var e=new a;return arguments.length&&e.push.apply(e,Array.prototype.slice.call(arguments,0)),e}}),r.plugin(function(e,n,r,i){function a(e){var t=e[0];switch(t.toLowerCase()){case"t":return[t,0,0];case"m":return[t,1,0,0,1,0,0];case"r":return e.length==4?[t,0,e[2],e[3]]:[t,0];case"s":return e.length==5?[t,1,1,e[3],e[4]]:e.length==3?[t,1,1]:[t,1]}}function f(t,n,r){n=u(n).replace(/\.{3}|\u2026/g,t),t=e.parseTransformString(t)||[],n=e.parseTransformString(n)||[];var i=Math.max(t.length,n.length),s=[],o=[],f=0,l,c,h,p;for(;f<i;f++){h=t[f]||a(n[f]),p=n[f]||a(h);if(h[0]!=p[0]||h[0].toLowerCase()=="r"&&(h[2]!=p[2]||h[3]!=p[3])||h[0].toLowerCase()=="s"&&(h[3]!=p[3]||h[4]!=p[4])){t=e._.transform2matrix(t,r()),n=e._.transform2matrix(n,r()),s=[["m",t.a,t.b,t.c,t.d,t.e,t.f]],o=[["m",n.a,n.b,n.c,n.d,n.e,n.f]];break}s[f]=[],o[f]=[];for(l=0,c=Math.max(h.length,p.length);l<c;l++)l in h&&(s[f][l]=h[l]),l in p&&(o[f][l]=p[l])}return{from:v(s),to:v(o),f:d(s)}}function l(e){return e}function c(e){return function(t){return+t.toFixed(3)+e}}function h(e){return e.join(" ")}function p(t){return e.rgb(t[0],t[1],t[2])}function d(e){var t=0,n,r,i,s,o,u,a=[];for(n=0,r=e.length;n<r;n++){o="[",u=['"'+e[n][0]+'"'];for(i=1,s=e[n].length;i<s;i++)u[i]="val["+t++ +"]";o+=u+"]",a[n]=o}return Function("val","return Snap.path.toString.call(["+a+"])")}function v(e){var t=[];for(var n=0,r=e.length;n<r;n++)for(var i=1,s=e[n].length;i<s;i++)t.push(e[n][i]);return t}function m(e){return isFinite(parseFloat(e))}function g(t,n){return!e.is(t,"array")||!e.is(n,"array")?!1:t.toString()==n.toString()}var s={},o=/[a-z]+$/i,u=String;s.stroke=s.fill="colour",n.prototype.equal=function(e,n){return t("snap.util.equal",this,e,n).firstDefined()},t.on("snap.util.equal",function(t,n){var r,i,a=u(this.attr(t)||""),y=this;if(m(a)&&m(n))return{from:parseFloat(a),to:parseFloat(n),f:l};if(s[t]=="colour")return r=e.color(a),i=e.color(n),{from:[r.r,r.g,r.b,r.opacity],to:[i.r,i.g,i.b,i.opacity],f:p};if(t=="viewBox")return r=this.attr(t).vb.split(" ").map(Number),i=n.split(" ").map(Number),{from:r,to:i,f:h};if(t=="transform"||t=="gradientTransform"||t=="patternTransform")return n instanceof e.Matrix&&(n=n.toTransformString()),e._.rgTransform.test(n)||(n=e._.svgTransform2string(n)),f(a,n,function(){return y.getBBox(1)});if(t=="d"||t=="path")return r=e.path.toCubic(a,n),{from:v(r[0]),to:v(r[1]),f:d(r[0])};if(t=="points")return r=u(a).split(e._.separator),i=u(n).split(e._.separator),{from:r,to:i,f:function(e){return e}};var b=a.match(o),w=u(n).match(o);return b&&g(b,w)?{from:parseFloat(a),to:parseFloat(n),f:c(b)}:{from:this.asPX(t),to:this.asPX(t,n),f:l}})}),r.plugin(function(e,n,r,i){var s=n.prototype,o="hasOwnProperty",u="createTouch"in i.doc,a=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","touchstart","touchmove","touchend","touchcancel"],f={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},l=function(e,t){var n=e=="y"?"scrollTop":"scrollLeft",r=t&&t.node?t.node.ownerDocument:i.doc;return r[n in r.documentElement?"documentElement":"body"][n]},c=function(){this.returnValue=!1},h=function(){return this.originalEvent.preventDefault()},p=function(){this.cancelBubble=!0},d=function(){return this.originalEvent.stopPropagation()},v=function(e,t,n,r){var i=u&&f[t]?f[t]:t,s=function(i){var s=l("y",r),a=l("x",r);if(u&&f[o](t))for(var c=0,p=i.targetTouches&&i.targetTouches.length;c<p;c++)if(i.targetTouches[c].target==e||e.contains(i.targetTouches[c].target)){var v=i;i=i.targetTouches[c],i.originalEvent=v,i.preventDefault=h,i.stopPropagation=d;break}var m=i.clientX+a,g=i.clientY+s;return n.call(r,i,m,g)};return t!==i&&e.addEventListener(t,s,!1),e.addEventListener(i,s,!1),function(){return t!==i&&e.removeEventListener(t,s,!1),e.removeEventListener(i,s,!1),!0}},m=[],g=function(e){var n=e.clientX,r=e.clientY,i=l("y"),s=l("x"),o,a=m.length;while(a--){o=m[a];if(u){var f=e.touches&&e.touches.length,c;while(f--){c=e.touches[f];if(c.identifier==o.el._drag.id||o.el.node.contains(c.target)){n=c.clientX,r=c.clientY,(e.originalEvent?e.originalEvent:e).preventDefault();break}}}else e.preventDefault();var h=o.el.node,p,d=h.nextSibling,v=h.parentNode,g=h.style.display;n+=s,r+=i,t("snap.drag.move."+o.el.id,o.move_scope||o.el,n-o.el._drag.x,r-o.el._drag.y,n,r,e)}},y=function(n){e.unmousemove(g).unmouseup(y);var r=m.length,i;while(r--)i=m[r],i.el._drag={},t("snap.drag.end."+i.el.id,i.end_scope||i.start_scope||i.move_scope||i.el,n),t.off("snap.drag.*."+i.el.id);m=[]};for(var b=a.length;b--;)(function(t){e[t]=s[t]=function(n,r){if(e.is(n,"function"))this.events=this.events||[],this.events.push({name:t,f:n,unbind:v(this.node||document,t,n,r||this)});else for(var i=0,s=this.events.length;i<s;i++)if(this.events[i].name==t)try{this.events[i].f.call(this)}catch(o){}return this},e["un"+t]=s["un"+t]=function(e){var n=this.events||[],r=n.length;while(r--)if(n[r].name==t&&(n[r].f==e||!e))return n[r].unbind(),n.splice(r,1),!n.length&&delete this.events,this;return this}})(a[b]);s.hover=function(e,t,n,r){return this.mouseover(e,n).mouseout(t,r||n)},s.unhover=function(e,t){return this.unmouseover(e).unmouseout(t)};var w=[];s.drag=function(n,r,i,s,o,u){function l(f,l,c){(f.originalEvent||f).preventDefault(),a._drag.x=l,a._drag.y=c,a._drag.id=f.identifier,!m.length&&e.mousemove(g).mouseup(y),m.push({el:a,move_scope:s,start_scope:o,end_scope:u}),r&&t.on("snap.drag.start."+a.id,r),n&&t.on("snap.drag.move."+a.id,n),i&&t.on("snap.drag.end."+a.id,i),t("snap.drag.start."+a.id,o||s||a,l,c,f)}function c(e,n,r){t("snap.draginit."+a.id,a,e,n,r)}var a=this;if(!arguments.length){var f;return a.drag(function(e,t){this.attr({transform:f+(f?"T":"t")+[e,t]})},function(){f=this.transform().local})}return t.on("snap.draginit."+a.id,l),a._drag={},w.push({el:a,start:l,init:c}),a.mousedown(c),a},s.undrag=function(){var n=w.length;while(n--)w[n].el==this&&(this.unmousedown(w[n].init),w.splice(n,1),t.unbind("snap.drag.*."+this.id),t.unbind("snap.draginit."+this.id));return!w.length&&e.unmousemove(g).unmouseup(y),this}}),r.plugin(function(e,n,r,i){var s=n.prototype,o=r.prototype,u=/^\s*url\((.+)\)/,a=String,f=e._.$;e.filter={},o.filter=function(t){var r=this;r.type!="svg"&&(r=r.paper);var i=e.parse(a(t)),s=e._.id(),o=r.node.offsetWidth,u=r.node.offsetHeight,l=f("filter");return f(l,{id:s,filterUnits:"userSpaceOnUse"}),l.appendChild(i.node),r.defs.appendChild(l),new n(l)},t.on("snap.util.getattr.filter",function(){t.stop();var n=f(this.node,"filter");if(n){var r=a(n).match(u);return r&&e.select(r[1])}}),t.on("snap.util.attr.filter",function(r){if(r instanceof n&&r.type=="filter"){t.stop();var i=r.node.id;i||(f(r.node,{id:r.id}),i=r.id),f(this.node,{filter:e.url(i)})}if(!r||r=="none")t.stop(),this.node.removeAttribute("filter")}),e.filter.blur=function(t,n){t==null&&(t=2);var r=n==null?t:[t,n];return e.format('<feGaussianBlur stdDeviation="{def}"/>',{def:r})},e.filter.blur.toString=function(){return this()},e.filter.shadow=function(t,n,r,i,s){return typeof r=="string"&&(i=r,s=i,r=4),typeof i!="string"&&(s=i,i="#000"),i=i||"#000",r==null&&(r=4),s==null&&(s=1),t==null&&(t=0,n=2),n==null&&(n=t),i=e.color(i),e.format('<feGaussianBlur in="SourceAlpha" stdDeviation="{blur}"/><feOffset dx="{dx}" dy="{dy}" result="offsetblur"/><feFlood flood-color="{color}"/><feComposite in2="offsetblur" operator="in"/><feComponentTransfer><feFuncA type="linear" slope="{opacity}"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>',{color:i,dx:t,dy:n,blur:r,opacity:s})},e.filter.shadow.toString=function(){return this()},e.filter.grayscale=function(t){return t==null&&(t=1),e.format('<feColorMatrix type="matrix" values="{a} {b} {c} 0 0 {d} {e} {f} 0 0 {g} {b} {h} 0 0 0 0 0 1 0"/>',{a:.2126+.7874*(1-t),b:.7152-.7152*(1-t),c:.0722-.0722*(1-t),d:.2126-.2126*(1-t),e:.7152+.2848*(1-t),f:.0722-.0722*(1-t),g:.2126-.2126*(1-t),h:.0722+.9278*(1-t)})},e.filter.grayscale.toString=function(){return this()},e.filter.sepia=function(t){return t==null&&(t=1),e.format('<feColorMatrix type="matrix" values="{a} {b} {c} 0 0 {d} {e} {f} 0 0 {g} {h} {i} 0 0 0 0 0 1 0"/>',{a:.393+.607*(1-t),b:.769-.769*(1-t),c:.189-.189*(1-t),d:.349-.349*(1-t),e:.686+.314*(1-t),f:.168-.168*(1-t),g:.272-.272*(1-t),h:.534-.534*(1-t),i:.131+.869*(1-t)})},e.filter.sepia.toString=function(){return this()},e.filter.saturate=function(t){return t==null&&(t=1),e.format('<feColorMatrix type="saturate" values="{amount}"/>',{amount:1-t})},e.filter.saturate.toString=function(){return this()},e.filter.hueRotate=function(t){return t=t||0,e.format('<feColorMatrix type="hueRotate" values="{angle}"/>',{angle:t})},e.filter.hueRotate.toString=function(){return this()},e.filter.invert=function(t){return t==null&&(t=1),e.format('<feComponentTransfer><feFuncR type="table" tableValues="{amount} {amount2}"/><feFuncG type="table" tableValues="{amount} {amount2}"/><feFuncB type="table" tableValues="{amount} {amount2}"/></feComponentTransfer>',{amount:t,amount2:1-t})},e.filter.invert.toString=function(){return this()},e.filter.brightness=function(t){return t==null&&(t=1),e.format('<feComponentTransfer><feFuncR type="linear" slope="{amount}"/><feFuncG type="linear" slope="{amount}"/><feFuncB type="linear" slope="{amount}"/></feComponentTransfer>',{amount:t})},e.filter.brightness.toString=function(){return this()},e.filter.contrast=function(t){return t==null&&(t=1),e.format('<feComponentTransfer><feFuncR type="linear" slope="{amount}" intercept="{amount2}"/><feFuncG type="linear" slope="{amount}" intercept="{amount2}"/><feFuncB type="linear" slope="{amount}" intercept="{amount2}"/></feComponentTransfer>',{amount:t,amount2:.5-t/2})},e.filter.contrast.toString=function(){return this()}}),r.plugin(function(e,t,n,r,i){var s=e._.box,o=e.is,u=/^[^a-z]*([tbmlrc])/i,a=function(){return"T"+this.dx+","+this.dy};t.prototype.getAlign=function(e,t){t==null&&o(e,"string")&&(t=e,e=null),e=e||this.paper;var n=e.getBBox?e.getBBox():s(e),r=this.getBBox(),i={};t=t&&t.match(u),t=t?t[1].toLowerCase():"c";switch(t){case"t":i.dx=0,i.dy=n.y-r.y;break;case"b":i.dx=0,i.dy=n.y2-r.y2;break;case"m":i.dx=0,i.dy=n.cy-r.cy;break;case"l":i.dx=n.x-r.x,i.dy=0;break;case"r":i.dx=n.x2-r.x2,i.dy=0;break;default:i.dx=n.cx-r.cx,i.dy=0}return i.toString=a,i},t.prototype.align=function(e,t){return this.transform("..."+this.getAlign(e,t))}}),r}),n("draw",["require","exports","Hammer","./runtime","./util","../bower_components/hammerjs/hammer","../bower_components/Snap.svg/dist/snap.svg"],function(e,t,n,r,i){function A(e,t){"use strict";var n=e.getAttribute("class");n?e.setAttribute("class",n+" "+t):e.setAttribute("class",t)}function O(e,t){"use strict";return t===void 0&&(t=1e-7),Math.abs(e)<t}function M(e,t,n){"use strict";return n===void 0&&(n=1e-7),O(e-t,n)}function _(e){"use strict";return!isFinite(e)||e>2e14}function D(e){"use strict";return Math.pow(e,2)}function P(e,t){"use strict";return{x:e,y:t}}function B(e,t){"use strict";t===void 0&&(t="bottom");if(e.labelSide){var n=e.labelSide;return n==="center"?t:n}if(e.hasOwnProperty("labelAngle")){var r=(e.labelAngle+45)%360,i=r/90|0;return H[i]}return t}function j(e,t,n){"use strict";var r=h*2/m,i="matrix("+r+", 0, 0, "+r+", "+(t-h)+", "+(n-h)+")";return e.path(v).attr({fill:"#ffffff",stroke:"#6388dc","stroke-width":2,"stroke-linejoin":"round","stroke-miterlimit":4}).transform(i)}function F(e,t,n){"use strict";var r=D(t.x)+D(t.y),i=(D(e.x)+D(e.y)-r)/2,s=(r-D(n.x)-D(n.y))/2,o=(e.x-t.x)*(t.y-n.y)-(t.x-n.x)*(e.y-t.y);if(O(o)){console.log("blerg");return}var u=1/o,a=(i*(t.y-n.y)-s*(e.y-t.y))*u,f=(s*(e.x-t.x)-i*(t.x-n.x))*u;return{x:a,y:f,r:l(D(t.x-a)+D(t.y-f))}}function I(e,t,n,r,i,s,o){"use strict";s===void 0&&(s=h),o===void 0&&(o=h);var u,a;switch(r){case"top":u=t,a=n-o-p;break;case"bottom":u=t,a=n+o+p;break;case"left":u=t-s-p,a=n;break;case"right":u=t+s+p,a=n;break;default:console.log("unknown case "+r)}var f=e.text(u,a,i.split("\n")).attr(E),l=f.attr("text"),c;typeof l=="string"?c=[l]:c=l;var d=f.node.getElementsByTagName("tspan"),v=Number.MIN_VALUE,m=Number.MIN_VALUE;if(L)for(var g=0;g<d.length;g++){var y=d[g],b=y.getBBox();b.height>v&&(v=b.height),b.width>m&&(m=b.width)}else for(var g=0;g<c.length;g++){var w=e.text(0,0,c[g]).attr(E),b=w.getBBox();b.height>v&&(v=b.height),b.width>m&&(m=b.width),w.remove()}for(var g=0;g<d.length;g++)r==="left"||r==="right",g>0&&(d[g].setAttribute("x",String(u)),d[g].setAttribute("dy",String(.9*v)));var S;switch(r){case"bottom":f.attr({y:a+p});break;case"top":f.attr({y:a-(d.length-1)*(v/2)-p*+(d.length>1)});break;case"left":d.length>1?S=(d.length-2)*(v/2):S=-v/4,A(f.node,"right-aligned"),f.node.setAttribute("style",f.node.getAttribute("style").replace("middle","right")),f.attr({y:a-S,x:u});break;case"right":A(f.node,"left-aligned"),f.node.setAttribute("style",f.node.getAttribute("style").replace("middle","left")),f.attr({y:a-(d.length-2)*(v/2)});break;default:console.log("unknown case "+r)}return f}function q(e){"use strict";var t=(360-e)%360;return t>180&&(t-=360),t}function R(e){"use strict";return e/180*s}function U(e){"use strict";return e*180/s}function z(e){"use strict";return e+=s,e>s&&(e-=2*s),e}function W(e){"use strict";return e[e.length-1]}function X(e,t,n,r){"use strict";var i="M"+t+","+n+"L"+(t-r)+","+(n+r/2)+"A"+r*3+","+r*3+" 0 0,1 "+(t-r)+","+(n-r/2)+"z";return e.path(i)}function V(e,t,n,r,s,o,u,a){"use strict";var f=t-r/2,l=n-s/2,c=o[0],h=W(o),p=h-c,d=Math.min(0,Math.min.apply(null,u)),v=Math.max.apply(null,u),m=v-d||1,g="";for(var y=0;y<u.length;y++)i.isNaN(u[y])&&console.log("NaN at "+o[y]),g+=(y===0?"M":"L")+(f+r*(o[y]-c)/p)+","+(l+s-s*(u[y]-d)/m);var b="M"+f+","+(l+s-s*(0-d)/m)+"L"+(f+r)+","+(l+s-s*(0-d)/m);if(!a)return e.group(e.path(b).attr({"class":"spark-axis","stroke-width":.125,"stroke-linecap":"round",stroke:"#999",fill:"none"}),e.path(g).attr({"class":"spark-line","stroke-width":.5,"stroke-linecap":"round",stroke:"#2299dd",fill:"none"}));var w=a.node.querySelector(".spark-line");return w.setAttribute("d",g),a}var s=Math.PI,o=Math.sin,u=Math.cos,a=Math.tan,f=Math.atan2,l=Math.sqrt,c=Math.abs,h=9,p=6,d=1,v="M 25.731189,3.8741489 C 21.525742,3.8741489 18.07553,7.4486396 17.497605,12.06118 C 16.385384,10.910965 14.996889,10.217536 13.45908,10.217535 C 9.8781481,10.217535 6.9473481,13.959873 6.9473482,18.560807 C 6.9473482,19.228828 7.0507906,19.875499 7.166493,20.498196 C 3.850265,21.890233 1.5000346,25.3185 1.5000346,29.310191 C 1.5000346,34.243794 5.1009986,38.27659 9.6710049,38.715902 C 9.6186538,39.029349 9.6083922,39.33212 9.6083922,39.653348 C 9.6083922,45.134228 17.378069,49.59028 26.983444,49.590279 C 36.58882,49.590279 44.389805,45.134229 44.389803,39.653348 C 44.389803,39.35324 44.341646,39.071755 44.295883,38.778399 C 44.369863,38.780301 44.440617,38.778399 44.515029,38.778399 C 49.470875,38.778399 53.499966,34.536825 53.499965,29.310191 C 53.499965,24.377592 49.928977,20.313927 45.360301,19.873232 C 45.432415,19.39158 45.485527,18.91118 45.485527,18.404567 C 45.485527,13.821862 42.394553,10.092543 38.598118,10.092543 C 36.825927,10.092543 35.215888,10.918252 33.996078,12.248669 C 33.491655,7.5434856 29.994502,3.8741489 25.731189,3.8741489 z",m=55,g=4,y=8,b=6,w=5,E={"font-size":"10px","font-family":'Roboto, "Open Sans", sans-serif',"font-weight":"300","text-anchor":"middle","white-space":"nowrap","vertical-align":"middle"},S="gray",x="black",T={flow:1,module:2,stock:3,aux:4,connector:5},N=.2,C=6,k=12,L=typeof navigator!="undefined"&&navigator.userAgent.match(/Chrome/)&&!navigator.userAgent.match(/Edge/),H={0:"right",1:"bottom",2:"left",3:"top"};t.xmileToCanvasAngle=q;var $=function(){function e(e,t){this.drawing=e,this.e=t,this.ident=t.ident,this.dName=i.dName(t.name),this.cx=t.x,this.cy=t.y,t.width?(e.stocksXYCenter||(this.cx+=.5*t.width),this.w=t.width):this.w=45,t.height?(e.stocksXYCenter||(this.cy+=.5*t.height),this.h=t.height):this.h=35,this.color=this.drawing.colorOverride?x:t.color||x,this.labelSide=B(t,"top")}return e.prototype.init=function(){var e=this.drawing.model.vars[this.ident];for(var t=0;t<e.inflows.length;t++){var n=e.inflows[t],r=this.drawing.namedEnts[n];if(!r){console.log("failed connecting "+this.ident+" .to "+n);continue}r.to=this.ident}for(var t=0;t<e.outflows.length;t++){var n=e.outflows[t],r=this.drawing.namedEnts[n];if(!r){console.log("failed connecting "+this.ident+" .from "+n);continue}this.drawing.namedEnts[n].from=this.ident}},e.prototype.draw=function(){var e=this.drawing.paper,t=this.w,n=this.h;this.set=this.drawing.group(e.rect(Math.ceil(this.cx-t/2),Math.ceil(this.cy-n/2),t,n).attr({fill:"white","stroke-width":d,stroke:this.color}))},e.prototype.drawLabel=function(){var e=this.drawing.paper,t=this.w,n=this.h;this.set.add(I(e,this.cx,this.cy,this.labelSide,this.dName,t/2,n/2))},e.prototype.visualize=function(e,t){var n=!!this.graph;this.graph=V(this.drawing.paper,this.cx,this.cy,this.w-4,this.h-4,e,t,this.graph),n||this.set.add(this.graph)},e}(),J=function(){function e(e,t){this.drawing=e,this.e=t,this.ident=t.ident,this.dName=i.dName(t.name),this.cx=t.x,this.cy=t.y,this.w=55,this.h=45,this.color=this.drawing.colorOverride?x:t.color||x,this.labelSide=B(t)}return e.prototype.init=function(){},e.prototype.draw=function(){var e=this.drawing.paper,t=this.w,n=this.h;this.set=this.drawing.group(e.rect(Math.ceil(this.cx-t/2),Math.ceil(this.cy-n/2),t,n,w,w).attr({fill:"white","stroke-width":d,stroke:this.color}))},e.prototype.drawLabel=function(){var e=this.drawing.paper,t=this.w,n=this.h;this.set.add(I(e,this.cx,this.cy,this.labelSide,this.dName,t/2,n/2))},e.prototype.visualize=function(e,t){var n=!!this.graph;this.graph=V(this.drawing.paper,this.cx,this.cy,this.w-6,this.h-6,e,t,this.graph),n||this.set.add(this.graph)},e}(),K=function(){function e(e,t){this.drawing=e,this.e=t,this.ident=t.ident,this.dName=i.dName(t.name),this.cx=t.x,this.cy=t.y,t.width?this.r=t.width/2:this.r=h,t.height?this.r=t.height/2:this.r=h,this.color=this.drawing.colorOverride?x:t.color||x,this.labelSide=B(t)}return e.prototype.init=function(){},e.prototype.draw=function(){var e=this.drawing.paper;this.set=this.drawing.group(e.circle(this.cx,this.cy,this.r).attr({fill:"white","stroke-width":d,stroke:this.color}))},e.prototype.drawLabel=function(){var e=this.drawing.paper;this.set.add(I(e,this.cx,this.cy,this.labelSide,this.dName))},e.prototype.visualize=function(e,t){var n=!!this.graph;this.graph=V(this.drawing.paper,this.cx,this.cy,h,h,e,t,this.graph),n||this.set.add(this.graph)},e}(),Q=function(){function e(e,t){this.drawing=e,this.e=t,this.ident=t.ident,this.dName=i.dName(t.name),this.cx=t.x,this.cy=t.y,this.to=null,this.from=null,this.color=this.drawing.colorOverride?x:t.color||x,this.labelSide=B(t)}return e.prototype.init=function(){},e.prototype.draw=function(){var e=this.drawing.paper,t=this.cx,n=this.cy,r=this.e.pts;if(r.length<2){console.log("ERROR: too few points for flow: "+JSON.stringify(this));return}var i="";for(var o=0;o<r.length;o++){var u=r[o];i+=(o===0?"M":"L")+u.x+","+u.y}var a,l;this.set=this.drawing.group(),this.from||(l=j(e,r[0].x,r[0].y),a=l);if(!this.to){var c,p,v,m;c=r[r.length-1].x,p=r[r.length-1].y,v=r[r.length-2].x,m=r[r.length-2].y,l=j(e,c,p),this.set.add(l),v<c&&(r[r.length-1].x=c-y),v>c&&(r[r.length-1].x=c+y),m<p&&(r[r.length-1].y=p-y),m>p&&(r[r.length-1].y=p+y)}i="";var b;for(var o=0;o<r.length;o++){var c=r[o].x,p=r[o].y;if(o===r.length-1){var w=c-r[o-1].x,E=p-r[o-1].y,S=f(E,w)*180/s;S<0&&(S+=360),S>=315||S<45?(c-=4,b=0):S>=45&&S<135?(p-=4,b=90):S>=135&&S<225?(c+=4,b=180):(p+=4,b=270)}i+=(o===0?"M":"L")+c+","+p}this.set.add(e.path(i).attr({"stroke-width":d*4,stroke:this.color,fill:"none"}));var x=W(r);this.set.add(X(e,x.x,x.y,g*2).attr({transform:"rotate("+b+","+x.x+","+x.y+")",stroke:this.color,"stroke-width":1,fill:"white","stroke-linejoin":"round"})),this.set.add(e.path(i).attr({stroke:"white","stroke-width":d*2,fill:"none"})),this.set.add(e.circle(t,n,h).attr({fill:"white","stroke-width":d,stroke:this.color})),a&&this.set.append(a)},e.prototype.drawLabel=function(){var e=this.drawing.paper;this.set.add(I(e,this.cx,this.cy,this.labelSide,this.dName))},e.prototype.visualize=function(e,t){var n=!!this.graph;this.graph=V(this.drawing.paper,this.cx,this.cy,h,h,e,t,this.graph),n||this.set.add(this.graph)},e}(),G=function(){function e(e,t){this.drawing=e,this.e=t,this.color=this.drawing.colorOverride?S:t.color||S}return e.prototype.init=function(){},e.prototype.takeoffθ=function(){var e=this.drawing.namedEnts[this.e.from];return e?this.e.hasOwnProperty("angle")?R(q(this.e.angle)):this.e.hasOwnProperty("x")&&this.e.hasOwnProperty("y")?f(this.e.y-e.cy,this.e.x-e.cx):(console.log('connector from "'+this.e.from+"\" doesn't have x, y, or angle"),NaN):(console.log("connector with unknown origin: "+this.e.from),NaN)},e.prototype.isStraight=function(){var e=this.drawing.namedEnts[this.e.from];if(!e)return!1;var t=this.drawing.namedEnts[this.e.to];if(!t)return!1;var n=this.takeoffθ(),r=f(t.cy-e.cy,t.cx-e.cx);return Math.abs(r-n)<R(k)},e.prototype.draw=function(){this.isStraight()?this.drawStraight():this.drawArc()},e.prototype.drawLabel=function(){},e.prototype.visualize=function(){},e.prototype.arcCircle=function(){var e=this.drawing.namedEnts[this.e.from],t=this.drawing.namedEnts[this.e.to];if(!e||!t)return;if(!this.e.hasOwnProperty("angle"))return F({x:e.cx,y:e.cy},{x:t.cx,y:t.cy},{x:this.e.x,y:this.e.y});var n=a(this.takeoffθ()),r=-1/n;O(r)&&(r=0);var i=Math.atan(r),s=e.cy-r*e.cx,o;if(e.cy===t.cy)o=(e.cx+t.cx)/2;else{var u=(e.cy-t.cy)/(e.cx-t.cx),f=-1/u,c=(e.cx+t.cx)/2,h=(e.cy+t.cy)/2,p=h-f*c;o=(s-p)/(f-r)}var d=r*o+s,v=l(D(e.cx-o)+D(e.cy-d));return{r:v,x:o,y:d}},e.prototype.intersectEntStraight=function(e,t){var n=h;return e instanceof J?n=25:e instanceof $&&(n=20),{x:e.cx+n*u(t),y:e.cy+n*o(t)}},e.prototype.intersectEntArc=function(e,t,n){var r=h;e instanceof J?r=25:e instanceof $&&(r=20);var i=a(r/t.r),s=f(e.cy-t.y,e.cx-t.x);return{x:t.x+t.r*u(s+(n?1:-1)*i),y:t.y+t.r*o(s+(n?1:-1)*i)}},e.prototype.drawStraight=function(){var e=this.drawing.paper,t=this.drawing.namedEnts[this.e.from],n=this.drawing.namedEnts[this.e.to];if(!t||!n)return;var r=f(n.cy-t.cy,n.cx-t.cx),i=this.intersectEntStraight(t,r),s=this.intersectEntStraight(n,z(r)),o=U(r),u="M"+i.x+","+i.y+"L"+s.x+","+s.y;this.set=this.drawing.group(e.path(u).attr({"stroke-width":d/2,stroke:this.color,fill:"none"}),X(e,s.x,s.y,g).attr({transform:"rotate("+o+","+s.x+","+s.y+")",stroke:this.color,"stroke-width":1,fill:this.color,"stroke-linejoin":"round"}))},e.prototype.drawArc=function(){var e=this.drawing.paper,t=this.drawing.namedEnts[this.e.from],n=this.drawing.namedEnts[this.e.to];if(!t||!n)return;var r=this.takeoffθ(),i=this.arcCircle(),s=f(t.cy-i.y,t.cx-i.x),a=f(n.cy-i.y,n.cx-i.x),c=a-s,h=c>0||c<=R(-180),p=this.intersectEntArc(t,i,h),v=this.intersectEntArc(n,i,!h),m=l(D(p.x-t.cx)+D(p.y-t.cy)),y=t.cx+m*u(r),b=t.cy+m*o(r),w=!M(y,p.x,5)||!M(b,p.y,5);w&&(h=!h,p=this.intersectEntArc(t,i,h),v=this.intersectEntArc(n,i,!h));var E="M"+p.x+","+p.y+"A"+i.r+","+i.r+" 0 "+ +w+","+ +h+" "+v.x+","+v.y,S=U(f(v.y-i.y,v.x-i.x))-90;h&&(S+=180),this.set=this.drawing.group(e.path(E).attr({"stroke-width":d/2,stroke:this.color,fill:"none"}),X(e,v.x,v.y,g).attr({transform:"rotate("+S+","+v.x+","+v.y+")",stroke:this.color,"stroke-width":1,fill:this.color,"stroke-linejoin":"round"}))},e}(),Y={stock:$,flow:Q,aux:K,connector:G,module:J},Z=function(){function e(e,t,i,s,o,u){this._inPan=!1,this.model=e,this.xmile=t;var a,f;if(typeof i=="string"){var l=i;l.length>0&&l[0]==="#"&&(l=l.substr(1)),a=document.getElementById(l)}else a=i;f=a,a.innerHTML="",this.paper=Snap(f);var c=f.getElementsByTagName("defs")[0];c?c.outerHTML=r.drawCSS:a.innerHTML+=r.drawCSS,this._g=this.paper.g(),this._g.node.id="viewport",this.colorOverride=s,this.stocksXYCenter=u,a.setAttribute("preserveAspectRatio","xMinYMin");var h="translateZ(0px)",p=a.style;p["-webkit-transform"]=h,p["-moz-transform"]=h,p["-ms-transform"]=h,p["-o-transform"]=h,p.transform=h,this.dEnts=[],this.zEnts=new Array(C);for(var d=0;d<C;d++)this.zEnts[d]=[];this.namedEnts={};for(var d=0;d<t.elements.length;d++){var v=t.elements[d];if(v.type==="style")continue;if(!Y.hasOwnProperty(v.type)){console.log("unknown draw ent type "+v.type);continue}var m=new Y[v.type](this,v);this.dEnts.push(m),this.zEnts[T[v.type]].push(m),m.ident&&(this.namedEnts[m.ident]=m)}for(var d=0;d<this.dEnts.length;d++)this.dEnts[d].init();for(var d=0;d<C;d++)for(var g=0;g<this.zEnts[d].length;g++)this.zEnts[d][g].draw();for(var d=0;d<C;d++)for(var g=0;g<this.zEnts[d].length;g++)this.zEnts[d][g].drawLabel();this._t={scale:1,dscale:0,x:0,y:0,dx:0,dy:0};var y=this,b=new n(a);b.on("panstart",function(){var e=y;if(Date.now()-e._pinchFinished<10)return;e._inPan=!0,e.normalizeTransform()}),b.on("pan",function(e){var t=y;if(Date.now()-t._pinchFinished<10)return;if(!t._inPan)return;t._t.dx=e.deltaX,t._t.dy=e.deltaY,t.transform()}),b.on("panend",function(e){var t=y;if(Date.now()-t._pinchFinished<10)return;if(!t._inPan)return;t._inPan=!1,t.normalizeTransform(),t.transform()}),b.get("pinch").set({enable:!0}),b.on("pinchstart",function(e){var t=y;t._pinchStart=e.center,t.normalizeTransform(),t._pinchFinished=null}),b.on("pinch",function(e){var t=y,n={x:t._pinchStart.x+(t._pinchStart.x-e.center.x),y:t._pinchStart.y+(t._pinchStart.y-e.center.y)};t.applyDScaleAt(e.scale-1,n),t.transform()}),b.on("pinchend",function(e){var t=y;t.normalizeTransform(),t.transform(),t._pinchFinished=Date.now()}),b.on("pinchcancel",function(e){console.log("TODO: pinch cancel")}),b.on("pinchmove",function(e){});if(!o)return;f.onwheel=function(e){var t=y,n=-e.deltaY/20;t.applyDScaleAt(n,{x:e.pageX,y:e.pageY}),t.normalizeTransform(),t.transform()}}return e.prototype.applyDScaleAt=function(e,t){this._t.dscale=e,this._t.scale+this._t.dscale<N&&(this._t.dscale=N-this._t.scale),this._t.dx=-(t.x-this._t.x)*this._t.dscale/this._t.scale,this._t.dy=-(t.y-this._t.y)*this._t.dscale/this._t.scale},e.prototype.transform=function(e,t,n){arguments.length===3&&(this._t.scale=e,this._t.x=t,this._t.y=n),t=this._t.x+this._t.dx,n=this._t.y+this._t.dy,e=this._t.scale+this._t.dscale;var r="translateZ(0px) matrix("+e+",0,0,"+e+","+t+","+n+")";this._g.node.style["-webkit-transform"]=r,this._g.node.style["-moz-transform"]=r,this._g.node.style["-ms-transform"]=r,this._g.node.style.transform=r},e.prototype.normalizeTransform=function(){this._t.x+=this._t.dx,this._t.y+=this._t.dy,this._t.scale+=this._t.dscale,this._t.scale<N&&(this._t.scale=N),this._t.dx=0,this._t.dy=0,this._t.dscale=0},e.prototype.visualize=function(e){if(e.project){var t=e,n=this;t.series.apply(t,Object.keys(this.namedEnts)).then(function(t){for(var r in t){if(!t.hasOwnProperty(r))continue;e=t[r];var i=n.namedEnts[r];if(!i){console.log("sim data for non-drawn "+r);continue}i.visualize(e.time,e.values)}}).done()}else{var r=e;for(var i in r){if(!r.hasOwnProperty(i))continue;e=r[i];var s=this.namedEnts[i];if(!s){console.log("sim data for non-drawn "+i);continue}s.visualize(e.time,e.values)}}},e.prototype.group=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t-0]=arguments[t];var n=this.paper.g.apply(this.paper,e);return this._g.append(n),n},e}();t.Drawing=Z}),function(e){"use strict";if(typeof bootstrap=="function")bootstrap("promise",e);else if(typeof exports=="object"&&typeof module=="object")module.exports=e();else if(typeof n=="function"&&n.amd)n("q",e);else if(typeof ses!="undefined"){if(!ses.ok())return;ses.makeQ=e}else{if(typeof window=="undefined"&&typeof self=="undefined")throw new Error("This environment was not anticipated by Q. Please file a bug.");var t=typeof window!="undefined"?window:self,r=t.Q;t.Q=e(),t.Q.noConflict=function(){return t.Q=r,this}}}(function(){"use strict";function u(e){return function(){return o.apply(e,arguments)}}function m(e){return e===Object(e)}function g(e){return v(e)==="[object StopIteration]"||e instanceof y}function w(t,n){if(e&&n.stack&&typeof t=="object"&&t!==null&&t.stack&&t.stack.indexOf(b)===-1){var r=[];for(var i=n;!!i;i=i.source)i.stack&&r.unshift(i.stack);r.unshift(t.stack);var s=r.join("\n"+b+"\n");t.stack=E(s)}}function E(e){var t=e.split("\n"),n=[];for(var r=0;r<t.length;++r){var i=t[r];!T(i)&&!S(i)&&i&&n.push(i)}return n.join("\n")}function S(e){return e.indexOf("(module.js:")!==-1||e.indexOf("(node.js:")!==-1}function x(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],Number(t[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(e);if(r)return[r[1],Number(r[2])]}function T(e){var t=x(e);if(!t)return!1;var i=t[0],s=t[1];return i===r&&s>=n&&s<=at}function N(){if(!e)return;try{throw new Error}catch(t){var n=t.stack.split("\n"),i=n[0].indexOf("@")>0?n[1]:n[2],s=x(i);if(!s)return;return r=s[0],s[1]}}function C(e,t,n){return function(){return typeof console!="undefined"&&typeof console.warn=="function"&&console.warn(t+" is deprecated, use "+n+" instead.",(new Error("")).stack),e.apply(e,arguments)}}function k(e){return e instanceof M?e:H(e)?J(e):$(e)}function L(){function u(e){r=e,s.source=e,f(t,function(t,n){k.nextTick(function(){e.promiseDispatch.apply(e,n)})},void 0),t=void 0,n=void 0}var t=[],n=[],r,i=h(L.prototype),s=h(M.prototype);s.promiseDispatch=function(e,i,s){var o=a(arguments);t?(t.push(o),i==="when"&&s[1]&&n.push(s[1])):k.nextTick(function(){r.promiseDispatch.apply(r,o)})},s.valueOf=function(){if(t)return s;var e=D(r);return P(e)&&(r=e),e},s.inspect=function(){return r?r.inspect():{state:"pending"}};if(k.longStackSupport&&e)try{throw new Error}catch(o){s.stack=o.stack.substring(o.stack.indexOf("\n")+1)}return i.promise=s,i.resolve=function(e){if(r)return;u(k(e))},i.fulfill=function(e){if(r)return;u($(e))},i.reject=function(e){if(r)return;u(V(e))},i.notify=function(e){if(r)return;f(n,function(t,n){k.nextTick(function(){n(e)})},void 0)},i}function A(e){if(typeof e!="function")throw new TypeError("resolver must be a function.");var t=L();try{e(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}return t.promise}function O(e){return A(function(t,n){for(var r=0,i=e.length;r<i;r++)k(e[r]).then(t,n)})}function M(e,t,n){t===void 0&&(t=function(e){return V(new Error("Promise does not support operation: "+e))}),n===void 0&&(n=function(){return{state:"unknown"}});var r=h(M.prototype);r.promiseDispatch=function(n,i,s){var o;try{e[i]?o=e[i].apply(r,s):o=t.call(r,i,s)}catch(u){o=V(u)}n&&n(o)},r.inspect=n;if(n){var i=n();i.state==="rejected"&&(r.exception=i.reason),r.valueOf=function(){var e=n();return e.state==="pending"||e.state==="rejected"?r:e.value}}return r}function _(e,t,n,r){return k(e).then(t,n,r)}function D(e){if(P(e)){var t=e.inspect();if(t.state==="fulfilled")return t.value}return e}function P(e){return e instanceof M}function H(e){return m(e)&&typeof e.then=="function"}function B(e){return P(e)&&e.inspect().state==="pending"}function j(e){return!P(e)||e.inspect().state==="fulfilled"}function F(e){return P(e)&&e.inspect().state==="rejected"}function z(){I.length=0,q.length=0,U||(U=!0)}function W(e,t){if(!U)return;typeof process=="object"&&typeof process.emit=="function"&&k.nextTick.runAfter(function(){l(q,e)!==-1&&(process.emit("unhandledRejection",t,e),R.push(e))}),q.push(e),t&&typeof t.stack!="undefined"?I.push(t.stack):I.push("(no stack) "+t)}function X(e){if(!U)return;var t=l(q,e);t!==-1&&(typeof process=="object"&&typeof process.emit=="function"&&k.nextTick.runAfter(function(){var n=l(R,e);n!==-1&&(process.emit("rejectionHandled",I[t],e),R.splice(n,1))}),q.splice(t,1),I.splice(t,1))}function V(e){var t=M({when:function(t){return t&&X(this),t?t(e):this}},function(){return this},function(){return{state:"rejected",reason:e}});return W(t,e),t}function $(e){return M({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},"delete":function(t){delete e[t]},post:function(t,n){return t===null||t===void 0?e.apply(void 0,n):e[t].apply(e,n)},apply:function(t,n){return e.apply(t,n)},keys:function(){return d(e)}},void 0,function(){return{state:"fulfilled",value:e}})}function J(e){var t=L();return k.nextTick(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}}),t.promise}function K(e){return M({isDef:function(){}},function(n,r){return tt(e,n,r)},function(){return k(e).inspect()})}function Q(e,t,n){return k(e).spread(t,n)}function G(e){return function(){function t(e,t){var s;if(typeof StopIteration=="undefined"){try{s=n[e](t)}catch(o){return V(o)}return s.done?k(s.value):_(s.value,r,i)}try{s=n[e](t)}catch(o){return g(o)?k(o.value):V(o)}return _(s,r,i)}var n=e.apply(this,arguments),r=t.bind(t,"next"),i=t.bind(t,"throw");return r()}}function Y(e){k.done(k.async(e)())}function Z(e){throw new y(e)}function et(e){return function(){return Q([this,nt(arguments)],function(t,n){return e.apply(t,n)})}}function tt(e,t,n){return k(e).dispatch(t,n)}function nt(e){return _(e,function(e){var t=0,n=L();return f(e,function(r,i,s){var o;P(i)&&(o=i.inspect()).state==="fulfilled"?e[s]=o.value:(++t,_(i,function(r){e[s]=r,--t===0&&n.resolve(e)},n.reject,function(e){n.notify({index:s,value:e})}))},void 0),t===0&&n.resolve(e),n.promise})}function rt(e){if(e.length===0)return k.resolve();var t=k.defer(),n=0;return f(e,function(r,i,s){function u(e){t.resolve(e)}function a(){n--,n===0&&t.reject(new Error("Can't get fulfillment value from any promise, all promises were rejected."))}function f(e){t.notify({index:s,value:e})}var o=e[s];n++,_(o,u,a,f)},undefined),t.promise}function it(e){return _(e,function(e){return e=c(e,k),_(nt(c(e,function(e){return _(e,i,i)})),function(){return e})})}function st(e){return k(e).allSettled()}function ot(e,t){return k(e).then(void 0,void 0,t)}function ut(e,t){return k(e).nodeify(t)}var e=!1;try{throw new Error}catch(t){e=!!t.stack}var n=N(),r,i=function(){},s=function(){function u(){var t,r;while(e.next)e=e.next,t=e.task,e.task=void 0,r=e.domain,r&&(e.domain=void 0,r.enter()),a(t,r);while(o.length)t=o.pop(),a(t);n=!1}function a(e,t){try{e()}catch(n){if(i)throw t&&t.exit(),setTimeout(u,0),t&&t.enter(),n;setTimeout(function(){throw n},0)}t&&t.exit()}var e={task:void 0,next:null},t=e,n=!1,r=void 0,i=!1,o=[];s=function(e){t=t.next={task:e,domain:i&&process.domain,next:null},n||(n=!0,r())};if(typeof process=="object"&&process.toString()==="[object process]"&&process.nextTick)i=!0,r=function(){process.nextTick(u)};else if(typeof setImmediate=="function")typeof window!="undefined"?r=setImmediate.bind(window,u):r=function(){setImmediate(u)};else if(typeof MessageChannel!="undefined"){var f=new MessageChannel;f.port1.onmessage=function(){r=l,f.port1.onmessage=u,u()};var l=function(){f.port2.postMessage(0)};r=function(){setTimeout(u,0),l()}}else r=function(){setTimeout(u,0)};return s.runAfter=function(e){o.push(e),n||(n=!0,r())},s}(),o=Function.call,a=u(Array.prototype.slice),f=u(Array.prototype.reduce||function(e,t){var n=0,r=this.length;if(arguments.length===1)do{if(n in this){t=this[n++];break}if(++n>=r)throw new TypeError}while(1);for(;n<r;n++)n in this&&(t=e(t,this[n],n));return t}),l=u(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),c=u(Array.prototype.map||function(e,t){var n=this,r=[];return f(n,function(i,s,o){r.push(e.call(t,s,o,n))},void 0),r}),h=Object.create||function(e){function t(){}return t.prototype=e,new t},p=u(Object.prototype.hasOwnProperty),d=Object.keys||function(e){var t=[];for(var n in e)p(e,n)&&t.push(n);return t},v=u(Object.prototype.toString),y;typeof ReturnValue!="undefined"?y=ReturnValue:y=function(e){this.value=e};var b="From previous event:";k.resolve=k,k.nextTick=s,k.longStackSupport=!1,typeof process=="object"&&process&&process.env&&process.env.Q_DEBUG&&(k.longStackSupport=!0),k.defer=L,L.prototype.makeNodeResolver=function(){var e=this;return function(t,n){t?e.reject(t):arguments.length>2?e.resolve(a(arguments,1)):e.resolve(n)}},k.Promise=A,k.promise=A,A.race=O,A.all=nt,A.reject=V,A.resolve=k,k.passByCopy=function(e){return e},M.prototype.passByCopy=function(){return this},k.join=function(e,t){return k(e).join(t)},M.prototype.join=function(e){return k([this,e]).spread(function(e,t){if(e===t)return e;throw new Error("Can't join: not the same: "+e+" "+t)})},k.race=O,M.prototype.race=function(){return this.then(k.race)},k.makePromise=M,M.prototype.toString=function(){return"[object Promise]"},M.prototype.then=function(e,t,n){function o(t){try{return typeof e=="function"?e(t):t}catch(n){return V(n)}}function u(e){if(typeof t=="function"){w(e,r);try{return t(e)}catch(n){return V(n)}}return V(e)}function a(e){return typeof n=="function"?n(e):e}var r=this,i=L(),s=!1;return k.nextTick(function(){r.promiseDispatch(function(e){if(s)return;s=!0,i.resolve(o(e))},"when",[function(e){if(s)return;s=!0,i.resolve(u(e))}])}),r.promiseDispatch(void 0,"when",[void 0,function(e){var t,n=!1;try{t=a(e)}catch(r){n=!0;if(!k.onerror)throw r;k.onerror(r)}n||i.notify(t)}]),i.promise},k.tap=function(e,t){return k(e).tap(t)},M.prototype.tap=function(e){return e=k(e),this.then(function(t){return e.fcall(t).thenResolve(t)})},k.when=_,M.prototype.thenResolve=function(e){return this.then(function(){return e})},k.thenResolve=function(e,t){return k(e).thenResolve(t)},M.prototype.thenReject=function(e){return this.then(function(){throw e})},k.thenReject=function(e,t){return k(e).thenReject(t)},k.nearer=D,k.isPromise=P,k.isPromiseAlike=H,k.isPending=B,M.prototype.isPending=function(){return this.inspect().state==="pending"},k.isFulfilled=j,M.prototype.isFulfilled=function(){return this.inspect().state==="fulfilled"},k.isRejected=F,M.prototype.isRejected=function(){return this.inspect().state==="rejected"};var I=[],q=[],R=[],U=!0;k.resetUnhandledRejections=z,k.getUnhandledReasons=function(){return I.slice()},k.stopUnhandledRejectionTracking=function(){z(),U=!1},z(),k.reject=V,k.fulfill=$,k.master=K,k.spread=Q,M.prototype.spread=function(e,t){return this.all().then(function(t){return e.apply(void 0,t)},t)},k.async=G,k.spawn=Y,k["return"]=Z,k.promised=et,k.dispatch=tt,M.prototype.dispatch=function(e,t){var n=this,r=L();return k.nextTick(function(){n.promiseDispatch(r.resolve,e,t)}),r.promise},k.get=function(e,t){return k(e).dispatch("get",[t])},M.prototype.get=function(e){return this.dispatch("get",[e])},k.set=function(e,t,n){return k(e).dispatch("set",[t,n])},M.prototype.set=function(e,t){return this.dispatch("set",[e,t])},k.del=k["delete"]=function(e,t){return k(e).dispatch("delete",[t])},M.prototype.del=M.prototype["delete"]=function(e){return this.dispatch("delete",[e])},k.mapply=k.post=function(e,t,n){return k(e).dispatch("post",[t,n])},M.prototype.mapply=M.prototype.post=function(e,t){return this.dispatch("post",[e,t])},k.send=k.mcall=k.invoke=function(e,t){return k(e).dispatch("post",[t,a(arguments,2)])},M.prototype.send=M.prototype.mcall=M.prototype.invoke=function(e){return this.dispatch("post",[e,a(arguments,1)])},k.fapply=function(e,t){return k(e).dispatch("apply",[void 0,t])},M.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])},k["try"]=k.fcall=function(e){return k(e).dispatch("apply",[void 0,a(arguments,1)])},M.prototype.fcall=function(){return this.dispatch("apply",[void 0,a(arguments)])},k.fbind=function(e){var t=k(e),n=a(arguments,1);return function(){return t.dispatch("apply",[this,n.concat(a(arguments))])}},M.prototype.fbind=function(){var e=this,t=a(arguments);return function(){return e.dispatch("apply",[this,t.concat(a(arguments))])}},k.keys=function(e){return k(e).dispatch("keys",[])},M.prototype.keys=function(){return this.dispatch("keys",[])},k.all=nt,M.prototype.all=function(){return nt(this)},k.any=rt,M.prototype.any=function(){return rt(this)},k.allResolved=C(it,"allResolved","allSettled"),M.prototype.allResolved=function(){return it(this)},k.allSettled=st,M.prototype.allSettled=function(){return this.then(function(e){return nt(c(e,function(e){function t(){return e.inspect()}return e=k(e),e.then(t,t)}))})},k.fail=k["catch"]=function(e,t){return k(e).then(void 0,t)},M.prototype.fail=M.prototype["catch"]=function(e){return this.then(void 0,e)},k.progress=ot,M.prototype.progress=function(e){return this.then(void 0,void 0,e)},k.fin=k["finally"]=function(e,t){return k(e)["finally"](t)},M.prototype.fin=M.prototype["finally"]=function(e){return e=k(e),this.then(function(t){return e.fcall().then(function(){return t})},function(t){return e.fcall().then(function(){throw t})})},k.done=function(e,t,n,r){return k(e).done(t,n,r)},M.prototype.done=function(e,t,n){var r=function(e){k.nextTick(function(){w(e,i);if(!k.onerror)throw e;k.onerror(e)})},i=e||t||n?this.then(e,t,n):this;typeof process=="object"&&process&&process.domain&&(r=process.domain.bind(r)),i.then(void 0,r)},k.timeout=function(e,t,n){return k(e).timeout(t,n)},M.prototype.timeout=function(e,t){var n=L(),r=setTimeout(function(){if(!t||"string"==typeof t)t=new Error(t||"Timed out after "+e+" ms"),t.code="ETIMEDOUT";n.reject(t)},e);return this.then(function(e){clearTimeout(r),n.resolve(e)},function(e){clearTimeout(r),n.reject(e)},n.notify),n.promise},k.delay=function(e,t){return t===void 0&&(t=e,e=void 0),k(e).delay(t)},M.prototype.delay=function(e){return this.then(function(t){var n=L();return setTimeout(function(){n.resolve(t)},e),n.promise})},k.nfapply=function(e,t){return k(e).nfapply(t)},M.prototype.nfapply=function(e){var t=L(),n=a(e);return n.push(t.makeNodeResolver()),this.fapply(n).fail(t.reject),t.promise},k.nfcall=function(e){var t=a(arguments,1);return k(e).nfapply(t)},M.prototype.nfcall=function(){var e=a(arguments),t=L();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},k.nfbind=k.denodeify=function(e){var t=a(arguments,1);return function(){var n=t.concat(a(arguments)),r=L();return n.push(r.makeNodeResolver()),k(e).fapply(n).fail(r.reject),r.promise}},M.prototype.nfbind=M.prototype.denodeify=function(){var e=a(arguments);return e.unshift(this),k.denodeify.apply(void 0,e)},k.nbind=function(e,t){var n=a(arguments,2);return function(){function s(){return e.apply(t,arguments)}var r=n.concat(a(arguments)),i=L();return r.push(i.makeNodeResolver()),k(s).fapply(r).fail(i.reject),i.promise}},M.prototype.nbind=function(){var e=a(arguments,0);return e.unshift(this),k.nbind.apply(void 0,e)},k.nmapply=k.npost=function(e,t,n){return k(e).npost(t,n)},M.prototype.nmapply=M.prototype.npost=function(e,t){var n=a(t||[]),r=L();return n.push(r.makeNodeResolver()),this.dispatch("post",[e,n]).fail(r.reject),r.promise},k.nsend=k.nmcall=k.ninvoke=function(e,t){var n=a(arguments,2),r=L();return n.push(r.makeNodeResolver()),k(e).dispatch("post",[t,n]).fail(r.reject),r.promise},M.prototype.nsend=M.prototype.nmcall=M.prototype.ninvoke=function(e){var t=a(arguments,1),n=L();return t.push(n.makeNodeResolver()),this.dispatch("post",[e,t]).fail(n.reject),n.promise},k.nodeify=ut,M.prototype.nodeify=function(e){if(!e)return this;this.then(function(t){k.nextTick(function(){e(null,t)})},function(t){k.nextTick(function(){e(t)})})},k.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var at=N();return k}),function(t,r){typeof exports=="object"&&exports&&typeof exports.nodeName!="string"?r(exports):typeof n=="function"&&n.amd?n("mustache",["exports"],r):(t.Mustache={},r(Mustache))}(this,function(t){function i(e){return typeof e=="function"}function s(e){return r(e)?"array":typeof e}function o(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function u(e,t){return e!=null&&typeof e=="object"&&t in e}function f(e,t){return a.call(e,t)}function c(e){return!f(l,e)}function p(e){return String(e).replace(/[&<>"'\/]/g,function(t){return h[t]})}function b(e,n){function l(){if(a&&!f)while(u.length)delete s[u.pop()];else u=[];a=!1,f=!1}function x(e){typeof e=="string"&&(e=e.split(v,2));if(!r(e)||e.length!==2)throw new Error("Invalid tags: "+e);h=new RegExp(o(e[0])+"\\s*"),p=new RegExp("\\s*"+o(e[1])),b=new RegExp("\\s*"+o("}"+e[1]))}if(!e)return[];var i=[],s=[],u=[],a=!1,f=!1,h,p,b;x(n||t.tags);var T=new S(e),N,C,k,L,A,O;while(!T.eos()){N=T.pos,k=T.scanUntil(h);if(k)for(var M=0,_=k.length;M<_;++M)L=k.charAt(M),c(L)?u.push(s.length):f=!0,s.push(["text",L,N,N+1]),N+=1,L==="\n"&&l();if(!T.scan(h))break;a=!0,C=T.scan(y)||"name",T.scan(d),C==="="?(k=T.scanUntil(m),T.scan(m),T.scanUntil(p)):C==="{"?(k=T.scanUntil(b),T.scan(g),T.scanUntil(p),C="&"):k=T.scanUntil(p);if(!T.scan(p))throw new Error("Unclosed tag at "+T.pos);A=[C,k,N,T.pos],s.push(A);if(C==="#"||C==="^")i.push(A);else if(C==="/"){O=i.pop();if(!O)throw new Error('Unopened section "'+k+'" at '+N);if(O[1]!==k)throw new Error('Unclosed section "'+O[1]+'" at '+N)}else C==="name"||C==="{"||C==="&"?f=!0:C==="="&&x(k)}O=i.pop();if(O)throw new Error('Unclosed section "'+O[1]+'" at '+T.pos);return E(w(s))}function w(e){var t=[],n,r;for(var i=0,s=e.length;i<s;++i)n=e[i],n&&(n[0]==="text"&&r&&r[0]==="text"?(r[1]+=n[1],r[3]=n[3]):(t.push(n),r=n));return t}function E(e){var t=[],n=t,r=[],i,s;for(var o=0,u=e.length;o<u;++o){i=e[o];switch(i[0]){case"#":case"^":n.push(i),r.push(i),n=i[4]=[];break;case"/":s=r.pop(),s[5]=i[2],n=r.length>0?r[r.length-1][4]:t;break;default:n.push(i)}}return t}function S(e){this.string=e,this.tail=e,this.pos=0}function x(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function T(){this.cache={}}var n=Object.prototype.toString,r=Array.isArray||function(t){return n.call(t)==="[object Array]"},a=RegExp.prototype.test,l=/\S/,h={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},d=/\s*/,v=/\s+/,m=/\s*=/,g=/\s*\}/,y=/#|\^|\/|>|\{|&|=|!/;S.prototype.eos=function(){return this.tail===""},S.prototype.scan=function(t){var n=this.tail.match(t);if(!n||n.index!==0)return"";var r=n[0];return this.tail=this.tail.substring(r.length),this.pos+=r.length,r},S.prototype.scanUntil=function(t){var n=this.tail.search(t),r;switch(n){case-1:r=this.tail,this.tail="";break;case 0:r="";break;default:r=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=r.length,r},x.prototype.push=function(t){return new x(t,this)},x.prototype.lookup=function(t){var n=this.cache,r;if(n.hasOwnProperty(t))r=n[t];else{var s=this,o,a,f=!1;while(s){if(t.indexOf(".")>0){r=s.view,o=t.split("."),a=0;while(r!=null&&a<o.length)a===o.length-1&&(f=u(r,o[a])),r=r[o[a++]]}else r=s.view[t],f=u(s.view,t);if(f)break;s=s.parent}n[t]=r}return i(r)&&(r=r.call(this.view)),r},T.prototype.clearCache=function(){this.cache={}},T.prototype.parse=function(t,n){var r=this.cache,i=r[t];return i==null&&(i=r[t]=b(t,n)),i},T.prototype.render=function(t,n,r){var i=this.parse(t),s=n instanceof x?n:new x(n);return this.renderTokens(i,s,r,t)},T.prototype.renderTokens=function(t,n,r,i){var s="",o,u,a;for(var f=0,l=t.length;f<l;++f)a=undefined,o=t[f],u=o[0],u==="#"?a=this.renderSection(o,n,r,i):u==="^"?a=this.renderInverted(o,n,r,i):u===">"?a=this.renderPartial(o,n,r,i):u==="&"?a=this.unescapedValue(o,n):u==="name"?a=this.escapedValue(o,n):u==="text"&&(a=this.rawValue(o)),a!==undefined&&(s+=a);return s},T.prototype.renderSection=function(t,n,s,o){function l(e){return u.render(e,n,s)}var u=this,a="",f=n.lookup(t[1]);if(!f)return;if(r(f))for(var c=0,h=f.length;c<h;++c)a+=this.renderTokens(t[4],n.push(f[c]),s,o);else if(typeof f=="object"||typeof f=="string"||typeof f=="number")a+=this.renderTokens(t[4],n.push(f),s,o);else if(i(f)){if(typeof o!="string")throw new Error("Cannot use higher-order sections without the original template");f=f.call(n.view,o.slice(t[3],t[5]),l),f!=null&&(a+=f)}else a+=this.renderTokens(t[4],n,s,o);return a},T.prototype.renderInverted=function(t,n,i,s){var o=n.lookup(t[1]);if(!o||r(o)&&o.length===0)return this.renderTokens(t[4],n,i,s)},T.prototype.renderPartial=function(t,n,r){if(!r)return;var s=i(r)?r(t[1]):r[t[1]];if(s!=null)return this.renderTokens(this.parse(s),n,r,s)},T.prototype.unescapedValue=function(t,n){var r=n.lookup(t[1]);if(r!=null)return r},T.prototype.escapedValue=function(n,r){var i=r.lookup(n[1]);if(i!=null)return t.escape(i)},T.prototype.rawValue=function(t){return t[1]},t.name="mustache.js",t.version="2.1.3",t.tags=["{{","}}"];var N=new T;t.clearCache=function(){return N.clearCache()},t.parse=function(t,n){return N.parse(t,n)},t.render=function(t,n,r){if(typeof t!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+s(t)+'" was given as the first '+"argument for mustache#render(template, view, partials)");return N.render(t,n,r)},t.to_html=function(n,r,s,o){var u=t.render(n,r,s);if(!i(o))return u;o(u)},t.escape=p,t.Scanner=S,t.Context=x,t.Writer=T}),n("sim",["require","exports","./util","./vars","./runtime","q","mustache"],function(e,t,n,r,i,s,o){var u=!0,a=u?"	":"",f=u?"\n	":"",l="{{&preamble}}\n\n{{#models}}\nvar {{&className}} = function {{&className}}(name, parent, offset, symRefs) {\n	this.name = name;\n	this.parent = parent;\n	// if we are a module, record the offset in the curr & next\n	// arrays we should be writing at\n	this._shift = i32(offset);\n	{{&init}}\n	this.modules = {{&modules}};\n	// symbolic references, which will get resolved into integer\n	// offsets in the ref map after all Simulation objects have\n	// been initialized.\n	this.symRefs = symRefs || {};\n	this.ref = {};\n	this.nVars = this.getNVars();\n	if (name === 'main')\n		this.reset();\n};\n\n{{&className}}.prototype = new Simulation();\n{{&className}}.prototype.initials = {{&initialVals}};\n{{&className}}.prototype.simSpec = {{&simSpecVals}};\n{{&className}}.prototype.offsets = {{&offsets}};\n{{&className}}.prototype.tables = {{&tableVals}};\n{{&className}}.prototype.calcInitial = function(dt, curr) {\n	dt = +dt;\n{{#isModule}}\n	var globalCurr = curr;\n	curr = curr.subarray(this._shift, this._shift + this.nVars);\n{{/isModule}}\n	{{&calcI}}\n};\n{{&className}}.prototype.calcFlows = function(dt, curr) {\n	dt = +dt;\n{{#isModule}}\n	var globalCurr = curr;\n	curr = curr.subarray(this._shift, this._shift + this.nVars);\n{{/isModule}}\n	{{&calcF}}\n};\n{{&className}}.prototype.calcStocks = function(dt, curr, next) {\n	dt = +dt;\n{{#isModule}}\n	var globalCurr = curr;\n	curr = curr.subarray(this._shift, this._shift + this.nVars);\n	next = next.subarray(this._shift, this._shift + this.nVars);\n{{/isModule}}\n	{{&calcS}}\n};\n\n{{/models}}\nvar main = new {{&mainClassName}}('main');\n\nmain.resolveAllSymbolicRefs();\n\nvar cmds = initCmds(main);\n\n{{&epilogue}}",c=function(){function e(e,t,r,i,s,o,u,l,c){this.name=e.name,this.className=n.titleCase(e.name),this.isModule=e.name!=="main",this.modules=t.join(f),this.init=r.join(f),this.initialVals=JSON.stringify(i,null,a),this.simSpecVals=JSON.stringify(e.simSpec,null,a),this.tableVals=JSON.stringify(s,null,a),this.calcI=u.join(f),this.calcF=l.join(f),this.calcS=c.join(f),this.offsets=JSON.stringify(o,null,a)}return e}();t.TemplateContext=c;var h=function(){function e(e,t){this.root=e,this.project=e.project,this.seq=1,this.promised={},this.idSeq={};var r=e.referencedModels(),s=[];for(var u in r){if(!r.hasOwnProperty(u))continue;u==="main"?this.idSeq[u]=1:this.idSeq[u]=0,s.push(this._process(r[u].model,r[u].modules))}var a=o.render(l,{preamble:i.preamble,epilogue:t?i.epilogue:"onmessage = handleMessage;",mainClassName:n.titleCase(e.modelName),models:s});if(t){console.log(a);return}var f=new Blob([a],{type:"text/javascript"});this.worker=new Worker(window.URL.createObjectURL(f)),f=null,a=null;var c=this;this.worker.addEventListener("message",function(e){var t=e.data[0],n=e.data[1],r=c.promised[t];delete c.promised[t],r&&(n[1]?r.reject(n[1]):r.resolve(n[0]))})}return e.prototype._process=function(e,t){function a(e){for(var n=0;n<t.length;n++)if(e in t[n].refs)return!0;return!1}var i=[],s=[],o=[],f={},l={};for(var h in e.vars){if(!e.vars.hasOwnProperty(h))continue;var p=e.vars[h];p instanceof r.Module?(i.push(p),s.push(p),o.push(p)):p instanceof r.Stock?(i.push(p),o.push(p)):p instanceof r.Table?s.push(p):p.isConst()?(i.push(p),o.push(p)):s.push(p);if(!(p instanceof r.Module)&&!a(h)){var d=this.nextID(e.name);l[h]=d,u?f[h]=d+"/*"+h+"*/":f[h]=d}}n.sort(i),n.sort(s);var v={},m={},g=[],y=[],b=[];for(var w=0;w<i.length;w++){var E=void 0,p=i[w];if(p instanceof r.Module)E='this.modules["'+p.ident+'"].calcInitial(dt, curr);';else{if(a(p.ident))continue;p.isConst()&&(v[p.ident]=parseFloat(p.eqn)),E="curr["+f[p.ident]+"] = "+r.Variable.prototype.code.apply(p,[f])+";"}g.push(E)}for(var w=0;w<s.length;w++){var E=void 0,p=s[w];E=null,p instanceof r.Module?E='this.modules["'+p.ident+'"].calcFlows(dt, curr);':a(p.ident)||(E="curr["+f[p.ident]+"] = "+p.code(f)+";");if(!E)continue;y.push(E)}for(var w=0;w<o.length;w++){var E,p=o[w];p instanceof r.Module?b.push('this.modules["'+p.ident+'"].calcStocks(dt, curr, next);'):p.hasOwnProperty("initial")?b.push("next["+f[p.ident]+"] = "+p.code(f)+";"):b.push("next["+f[p.ident]+"] = curr["+f[p.ident]+"];")}for(var h in e.tables){if(!e.tables.hasOwnProperty(h))continue;m[h]={x:e.tables[h].x,y:e.tables[h].y}}var S="",x=[];Object.keys(e.modules).length&&(e.ident==="main"&&(S=" + 1"),x.push("var off = Object.keys(this.offsets).length"+S+";"));var T=[];T.push("{");for(var h in e.modules){if(!e.modules.hasOwnProperty(h))continue;x.push("var "+h+"Refs = {");for(var N in e.modules[h].refs){if(!e.modules[h].refs.hasOwnProperty(N))continue;x.push('    "'+N+'": "'+e.modules[h].refs[N].ptr+'",')}x.push("};"),x.push("var "+h+" = new "+n.titleCase(e.modules[h].modelName)+'("'+h+'", this, off, '+h+"Refs);"),x.push("off += "+h+".nVars;"),T.push('    "'+h+'": '+h+",")}return T.push("}"),new c(e,T,x,v,m,l,g,y,b)},e.prototype.nextID=function(e){return this.idSeq[e]++},e.prototype._post=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t-0]=arguments[t];var n=this.seq++,r=s.defer();return this.promised[n]=r,this.worker.postMessage([n].concat(e)),r.promise},e.prototype.close=function(){this.worker.terminate(),this.worker=null},e.prototype.reset=function(){return this._post("reset")},e.prototype.setValue=function(e,t){return this._post("set_val",e,t)},e.prototype.value=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t-0]=arguments[t];var n=["get_val"].concat(e);return this._post.apply(this,n)},e.prototype.series=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t-0]=arguments[t];var n=["get_series"].concat(e);return this._post.apply(this,n)},e.prototype.runTo=function(e){return this._post("run_to",e)},e.prototype.runToEnd=function(){return this._post("run_to_end")},e.prototype.setDesiredSeries=function(e){return this._post("set_desired_series",e)},e.prototype.varNames=function(){return this._post("var_names")},e.prototype.csv=function(e){function r(e){return n=e,this.series.apply(this,e)}function i(r){var i="",s={},o,u="time"+e;for(var a=0;a<n.length;a++){var f=n[a];if(f==="time"){o=r[f];continue}u+=f+e,s[f]=r[f]}i+=u.substr(0,u.length-1),i+="\n";var l=o.values.length;for(var a=0;a<l;a++){var c="";for(var f in s){if(!s.hasOwnProperty(f))continue;c===""&&(c+=s[f].time[a]+e),c+=s[f].values[a]+e}i+=c.substr(0,c.length-1),i+="\n"}t.resolve(i)}e===void 0&&(e=",");var t=s.defer(),n;return this.varNames().then(r.bind(this)).then(i.bind(this)),t.promise},e}();t.Sim=h}),n("model",["require","exports","./util","./vars","./draw","./sim","./xmile"],function(e,t,n,r,i,s,o){var u=n.set("module","stock","aux","flow"),a=function(){function e(e,t,n){this.modules={},this.tables={},this.vars={},this.project=e,this.xModel=n,this.name=t,this.vars={},this.tables={},this.modules={},this.parseVars(n.variables),this.spec=n.simSpec||null,this.valid=!0;return}return Object.defineProperty(e.prototype,"ident",{get:function(){return o.canonicalize(this.name)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"simSpec",{get:function(){return this.spec||this.project.simSpec},enumerable:!0,configurable:!0}),e.prototype.lookup=function(e){e[0]==="."&&(e=e.substr(1));if(e in this.vars)return this.vars[e];var t=e.split("."),n=this.modules[t[0]],r=this.project.model(n.modelName);return r.lookup(t.slice(1).join("."))},e.prototype.sim=function(e){var t;return this.name==="main"?t=this.project.main:(t=null,console.log("FIXME: sim of non-main model")),new s.Sim(t,e)},e.prototype.drawing=function(e,t,n,r){return r===void 0&&(r=!1),new i.Drawing(this,this.xModel.views[0],e,t,n,r)},e.prototype.parseVars=function(e){for(var t in e){if(!e.hasOwnProperty(t))continue;var n=e[t],i=n.ident;if(i in this.vars)return new o.Error("duplicate var "+i);switch(n.type){case"module":var s=new r.Module(this.project,this,n);this.modules[i]=s,this.vars[i]=s;break;case"stock":var u=new r.Stock(this,n);this.vars[i]=u;break;case"aux":var a=null;if(n.gf){var f=new r.Table(this,n);f.ok&&(this.tables[i]=f,a=f)}a||(a=new r.Variable(this,n)),this.vars[i]=a;break;case"flow":var l=null;if(n.gf){var f=new r.Table(this,n);f.ok&&(this.tables[i]=f,l=f)}l||(l=new r.Variable(this,n)),this.vars[i]=l}}return null},e}();t.Model=a}),n("project",["require","exports","./common","./xmile","./model","./vars"],function(e,t,n,r,i,s){function o(e){"use strict";var t;for(t=0;t<e.childNodes.length;t++){var n=e.childNodes.item(t);if(n.tagName==="xmile")return n}return null}var u=function(){function e(e){n.err=null,this.files=[],this.models={},this.valid=!1,this.addDocument(e,!0)}return e.prototype.model=function(e){return e||(e="main"),this.models[e]},e.prototype.addDocument=function(e,t){t===void 0&&(t=!1);if(!e||e.getElementsByTagName("parsererror").length!==0)return n.err=n.Errors.ERR_VERSION,this.valid=!1,!1;var u=o(e);if(!u)return this.valid=!1,!1;var a=r.File.Build(u),f=a[0],l=a[1];if(l)return console.log("File.Build: "+l.error),this.valid=!1,!1;this.files.push(f);if(t){this.name=f.header.name||"sd project",this.simSpec=f.simSpec;if(!f.simSpec)return this.valid=!1,!1}for(var c in f.models){if(!f.models.hasOwnProperty(c))continue;var h=f.models[c],p=h.ident;p===""&&!("main"in this.models)&&(p="main"),this.models[p]=new i.Model(this,p,h)}var d=new r.Variable;return d.name="main",this.main=new s.Module(this,null,d),this.valid=!0,!0},e}();t.Project=u}),n("sd",["require","exports","./common","./project","./project","./model"],function(e,t,n,r,i,s){function o(e){"use strict";var t=new r.Project(e);return t.valid?t.model():null}function u(e,t,n){"use strict";var r=new XMLHttpRequest;r.onreadystatechange=function(){if(r.readyState!==4)return;if(r.status>=200&&r.status<300){var e=r.responseXML;e||(e=(new DOMParser).parseFromString(r.responseText,"application/xml"));var i=o(e);t(i)}else n&&n(r)},r.open("GET",e,!0),r.send()}function a(){"use strict";return n.err}t.Project=i.Project,t.Model=s.Model,t.Errors=n.Errors,t.newModel=o,t.load=u,Object.defineProperty(t,"__esModule",{value:!0}),t.default=a}),t("sd")});